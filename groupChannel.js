import{_ as e,e as r,u as s,g as i,M as a,X as o,Q as u,U as c,a0 as h,aF as d,t as f,S as _,r as v,s as m,b as g,c as y,K as C,m as E,a as b,i as M,a7 as N,J as S,aE as U,aG as T,ax as A,aH as I,ak as w,aj as L,A as D,d as k,f as F,h as R,aI as x,ah as O,aJ as H,aa as V,W as q,a3 as B,B as W,w as z,V as j,R as Q,aD as K,z as Y,ai as J,ad as X,aK as Z,E as $,x as ee,y as te,ag as ne,ab as re,aL as se,aM as ie,aN as ae,p as oe,a5 as ue,aO as ce,am as le,a4 as he,aC as de,ae as pe,N as fe,n as _e,an as ve}from"./lib/__bundle-087816c3.js";export{ai as MessageEventSource}from"./lib/__bundle-087816c3.js";import{g as me,N as ge,p as ye,q as Ce,r as Ee,t as be,u as Me,w as Ne,x as Se,y as Ue,P as Te,z as Ae,A as Ie,C as we,E as Le,D as De,G as ke,H as Pe,I as Fe,J as Re,f as xe,K as Oe,L as He}from"./lib/__bundle-50274a15.js";import{G as Ge,g as Ve,D as qe,l as Be,m as We,n as ze,j as je,i as Qe,o as Ke,R as Ye,p as Je,k as Xe,U as Ze,e as $e,f as et,s as tt,d as nt,S as rt,v as st,q as it,r as at,P as ot,t as ut}from"./lib/__bundle-1ef675e5.js";export{n as GroupChannelEventSource,G as GroupChannelListOrder,p as MessageFilter,P as PublicGroupChannelListOrder,t as ScheduledMessageListOrder}from"./lib/__bundle-1ef675e5.js";import{C as ct,a as lt,O as ht,P as dt,M as pt,T as ft,R as _t,U as vt,A as mt,B as gt}from"./lib/__bundle-dddddac5.js";import{l as yt,S as Ct,I as Et,p as bt,U as Mt,F as Nt,m as St,c as Ut,T as Tt,d as At,A as It,n as wt,g as Lt,h as Dt,o as kt,q as Pt}from"./lib/__bundle-80fd264e.js";export{l as ScheduledStatus}from"./lib/__bundle-80fd264e.js";import{b as Ft}from"./lib/__bundle-8f39cad4.js";var Rt;!function(e){e.NONE="none",e.JOINED="joined",e.INVITED="invited",e.LEFT="left"}(Rt||(Rt={}));var xt,Ot,Ht,Gt,Vt,qt,Bt,Wt,zt=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.state=null,r.role=null,r.isMuted=!1,r.isBlockedByMe=!1,r.isBlockingMe=!1,r.state=a(Rt,n.state)?n.state:null,r.role=a(o,n.role)?n.role:null,"boolean"==typeof n.is_muted&&(r.isMuted=n.is_muted),"boolean"==typeof n.is_blocked_by_me&&(r.isBlockedByMe=n.is_blocked_by_me),"boolean"==typeof n.is_blocking_me&&(r.isBlockingMe=n.is_blocking_me),r}return e(n,t),n.payloadify=function(e){return r(s(i(i({},t.payloadify.call(this,e)),{state:e.state,role:e.role,is_muted:e.isMuted,is_blocked_by_me:e.isBlockedByMe,is_blocking_me:e.isBlockingMe})))},n}(me),jt=function(t){function n(e,n){var r,s,i=this;return(i=t.call(this,e)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",i.channelType=null!==(s=n.channel_type)&&void 0!==s?s:u.GROUP,i.reader=new c(i._iid,n.user),i.readAt=n.ts,i}return e(n,t),n}(h);!function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(xt||(xt={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Ot||(Ot={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only"}(Ht||(Ht={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(Gt||(Gt={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Vt||(Vt={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator"}(qt||(qt={})),function(e){e.AND="AND",e.OR="OR"}(Bt||(Bt={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(Wt||(Wt={}));var Qt,Kt=function(){function e(){this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=!1,this.nicknameContainsFilter=null,this.nicknameStartsWithFilter=null,this.nicknameExactMatchFilter=null,this.channelNameContainsFilter="",this.myMemberStateFilter=Ot.ALL,this.customTypesFilter=null,this.channelUrlsFilter=null,this.superChannelFilter=Ht.ALL,this.publicChannelFilter=xt.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Gt.ALL,this.hiddenChannelFilter=Vt.UNHIDDEN,this.includeFrozen=!0}return e.prototype._isFriend=function(e){return!(!e||!e.friendDiscoveryKey&&!e.friendName)},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={query:t,fields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=Bt.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t,n=new e;this.searchFilter&&n.setSearchFilter(this.searchFilter.fields,null!==(t=this.searchFilter.query)&&void 0!==t?t:void 0),this.userIdsFilter&&n.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach((function(e){n[e]=r[e]})),n},e.prototype.match=function(e,t){if(this._searchFilter){var n=this._searchFilter,r=n.query,s=n.fields;if(r&&s&&s.length>0&&!s.some((function(t){switch(t){case Wt.CHANNEL_NAME:return e.name.toLowerCase().includes(r.toLowerCase());case Wt.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(r.toLowerCase())}));default:return!0}})))return!1}if(this._userIdsFilter){var i=this._userIdsFilter,a=i.userIds,o=i.includeMode,u=i.queryType,c=e.members.map((function(e){return e.userId}));if(o){if(a.length>0)switch(u){case Bt.AND:if(a.some((function(e){return!c.includes(e)})))return!1;break;case Bt.OR:if(a.every((function(e){return!c.includes(e)})))return!1}}else{if(a.includes(t)||a.push(t),e.members.length>a.length)return!1;if(!d(a,c))return!1}}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var l=this.nicknameContainsFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().includes(l)})))return!1}if(this.nicknameStartsWithFilter){var h=this.nicknameStartsWithFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().startsWith(h)})))return!1}if(this.nicknameExactMatchFilter){var p=this.nicknameExactMatchFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase()!=p})))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case Ot.JOINED:if("joined"!==e.myMemberState)return!1;break;case Ot.INVITED:if("invited"!==e.myMemberState)return!1;break;case Ot.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case Ot.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Vt.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case Vt.HIDDEN:if(!e.isHidden)return!1;break;case Vt.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case Vt.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Gt.UNREAD_MESSAGE)if(0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case xt.PUBLIC:if(!e.isPublic)return!1;break;case xt.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case Ht.SUPER:if(!e.isSuper)return!1;break;case Ht.NON_SUPER:if(e.isSuper)return!1}return!0},e}(),Yt=function(t){function n(e,n){var r=n.sdkState,s=n.cacheContext,i=t.call(this,e)||this;return i._channels=new Map,i._sdkState=r,i._cacheContext=s,i}return e(n,t),Object.defineProperty(n.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return f(!!e).throw(_.databaseError),e.collection(ge)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n.prototype._serialize=function(e,t){return void 0===t&&(t=0),i(i({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:t})},n.prototype._deserialize=function(e){return rr.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(n.prototype,"channels",{get:function(){return v([],m(this._channels.values()),!1)},enumerable:!1,configurable:!0}),n.prototype.isCachedInMemory=function(e){return this._channels.has(e)},n.prototype.filterOffsetChanged=function(e){var t=this;return e.filter((function(e){if(t._channels.has(e.url))return t._channels.get(e.url).messageOffsetTimestamp<e.messageOffsetTimestamp}))},n.prototype.get=function(e){return g(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._channels.set(e,n),[2,n];r.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}}))}))},n.prototype.fetch=function(e){var t=e.token,n=e.limit,r=void 0===n?ye:n,s=e.backward,i=void 0!==s&&s,a=e.filter,o=void 0===a?new Kt:a,u=e.order,c=void 0===u?Ge.LATEST_LAST_MESSAGE:u,l=e.borderlineChannelUrl;return g(this,void 0,void 0,(function(){var e,n,s,a,u=this;return y(this,(function(h){switch(h.label){case 0:return this.localCacheEnabled?(e=Ve(c),n={where:function(e){if(t)switch(c){case Ge.CHANNEL_NAME_ALPHABETICAL:if(!i&&e.name.localeCompare(t)<0||i&&e.name.localeCompare(t)>0)return!1;if(l&&l===e.url)return!1;break;case Ge.CHRONOLOGICAL:if(!i&&e.createdAt>t||i&&e.createdAt<t)return!1;if(l&&l===e.url)return!1;break;case Ge.LATEST_LAST_MESSAGE:if(!i&&e.lastMessageUpdatedAt>t||i&&e.lastMessageUpdatedAt<t)return!1;if(l&&l===e.url)return!1}return o.match(u._deserialize(e),u._sdkState.userId)},index:e,backward:i},[4,this.collection.query(n)]):[3,3];case 1:return[4,h.sent().fetch({limit:r})];case 2:return s=h.sent(),(a=s.map((function(e){return u._deserialize(e)}))).forEach((function(e){u._channels.has(e.url)||u._channels.set(e.url,e)})),[2,a];case 3:return[2,[]]}}))}))},n.prototype.upsert=function(e){return g(this,void 0,void 0,(function(){var t,n,s,i=this;return y(this,(function(a){switch(a.label){case 0:if(t=[],e.forEach((function(e){if(i._channels.has(e.url)){var n=i._channels.get(e.url);n._pinnedMessagesUpdatedAt<e._pinnedMessagesUpdatedAt&&(n._pinnedMessagesUpdatedAt=e._pinnedMessagesUpdatedAt);var s=r(e);Object.assign(n,s,{_iid:i._iid}),t.push(n)}else i._channels.set(e.url,e),t.push(e)})),!this.localCacheEnabled)return[3,2];for(s in n=[],t)n.push(this._serialize(t[s],parseInt(s)));return[4,this.collection.upsertMany(n)];case 1:a.sent(),a.label=2;case 2:return[2,t]}}))}))},n.prototype.remove=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a;return y(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=C(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,this._channels.delete(r),this.localCacheEnabled?[4,this.collection.remove(r)]:[3,3]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return s=o.sent(),i={error:s},[3,7];case 6:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))}))},n.prototype.clear=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},n.prototype.clearMemoryCache=function(){this._channels.clear()},n.prototype._setBlockStateOfAllChannels=function(e,t,n){return g(this,void 0,void 0,(function(){var r,s,i,a,o,u,c,l,h,d,p,f,_,v,m,g,E,b,M;return y(this,(function(y){switch(y.label){case 0:if(r=[],e===this._sdkState.userId)try{for(s=C(this._channels.values()),i=s.next();!i.done;i=s.next()){l=i.value;try{for(v=void 0,a=C(l.members),o=a.next();!o.done;o=a.next())if((p=o.value).userId===t){p.isBlockedByMe=n,r.push(l);break}}catch(e){v={error:e}}finally{try{o&&!o.done&&(m=a.return)&&m.call(a)}finally{if(v)throw v.error}}}}catch(e){f={error:e}}finally{try{i&&!i.done&&(_=s.return)&&_.call(s)}finally{if(f)throw f.error}}else if(t===this._sdkState.userId)try{for(u=C(this._channels.values()),c=u.next();!c.done;c=u.next()){l=c.value;try{for(b=void 0,h=C(l.members),d=h.next();!d.done;d=h.next())if((p=d.value).userId===e){p.isBlockingMe=n,r.push(l);break}}catch(e){b={error:e}}finally{try{d&&!d.done&&(M=h.return)&&M.call(h)}finally{if(b)throw b.error}}}}catch(e){g={error:e}}finally{try{c&&!c.done&&(E=u.return)&&E.call(u)}finally{if(g)throw g.error}}return r.length>0?[4,this.upsert(r)]:[3,2];case 1:y.sent(),y.label=2;case 2:return[2]}}))}))},n.prototype.block=function(e,t){return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!0)];case 1:return n.sent(),[2]}}))}))},n.prototype.unblock=function(e,t){return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!1)];case 1:return n.sent(),[2]}}))}))},n.prototype.markAsRead=function(e,t){return void 0===t&&(t=v([],m(this._channels.keys()),!1)),g(this,void 0,void 0,(function(){var n,r,s,i,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:n=[],l.label=1;case 1:l.trys.push([1,6,7,8]),r=C(t),s=r.next(),l.label=2;case 2:return s.done?[3,5]:(i=s.value,[4,this.get(i)]);case 3:(null==(a=l.sent())?void 0:a._updateUnreadMemberState(this._sdkState.userId,e))&&(a._updateUnreadCount(0,0),n.push(a)),l.label=4;case 4:return s=r.next(),[3,2];case 5:return[3,8];case 6:return o=l.sent(),u={error:o},[3,8];case 7:try{s&&!s.done&&(c=r.return)&&c.call(r)}finally{if(u)throw u.error}return[7];case 8:return n.length>0?[4,this.upsert(n)]:[3,10];case 9:l.sent(),l.label=10;case 10:return[2]}}))}))},n}(h),Jt={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Xt=function(e){return E("string",e.invitedUserIds,!0)&&b("string",e.channelUrl,!0)&&b("string",e.coverUrl,!0)&&(M(e.coverImage)||b("string",e.coverImage,!0))&&b("boolean",e.isDistinct,!0)&&b("boolean",e.isSuper,!0)&&b("boolean",e.isBroadcast,!0)&&b("boolean",e.isExclusive,!0)&&b("boolean",e.isPublic,!0)&&b("boolean",e.isStrict,!0)&&b("boolean",e.isDiscoverable,!0)&&b("boolean",e.isEphemeral,!0)&&b("string",e.accessCode,!0)&&b("string",e.name,!0)&&b("string",e.data,!0)&&b("string",e.customType,!0)&&E("string",e.operatorUserIds,!0)&&b("number",e.messageSurvivalSeconds,!0)},Zt={customTypes:void 0,includeEmpty:!1,includeFrozen:!0},$t=function(e){return E("string",e.customTypes,!0)&&b("boolean",e.includeEmpty)&&b("boolean",e.includeFrozen)},en={myMemberStateFilter:Ot.ALL},tn=function(e){return a(Ot,e.myMemberStateFilter)};!function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"}(Qt||(Qt={}));var nn={keys:[]},rn={channelCustomTypesFilter:void 0,superChannelFilter:Ht.ALL},sn={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:N.ALL},an=function(){function e(e){var t=e.groupChannelCache,n=e.messageCache,r=e.unsentMessageCache,s=e.dispatcher,i=this;this._observers=new Map,s.on((function(e){return g(i,void 0,void 0,(function(){var s,i,a,o,u,c,l,h,d,p,f,_,v,m,E=this;return y(this,(function(b){switch(b.label){case 0:if(!(e instanceof We))return[3,10];s=e.channels,f=e.source,_=e.isWebSocketEventComing,i=e.data,a=s.filter((function(e){return e instanceof cs})),o=t.filterOffsetChanged(a),b.label=1;case 1:b.trys.push([1,6,7,8]),u=C(o),c=u.next(),b.label=2;case 2:return c.done?[3,5]:(l=c.value,[4,n.removeUnderOffset(l.url,l.messageOffsetTimestamp)]);case 3:b.sent(),b.label=4;case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return h=b.sent(),v={error:h},[3,8];case 7:try{c&&!c.done&&(m=u.return)&&m.call(u)}finally{if(v)throw v.error}return[7];case 8:return[4,t.upsert(a)];case 9:return d=b.sent(),_||this._broadcastUpdateEvent(d,f,i),[3,15];case 10:return e instanceof Be?(p=e.channelUrls,f=e.source,_=e.isWebSocketEventComing,[4,t.remove(p)]):[3,13];case 11:return b.sent(),[4,S((function(){return g(E,void 0,void 0,(function(){var e,t,s,i,a,o;return y(this,(function(u){switch(u.label){case 0:u.trys.push([0,6,7,8]),e=C(p),t=e.next(),u.label=1;case 1:return t.done?[3,5]:(s=t.value,[4,n.removeMessagesOfChannel(s)]);case 2:return u.sent(),[4,r.removeMessagesOfChannel(s)];case 3:u.sent(),u.label=4;case 4:return t=e.next(),[3,1];case 5:return[3,8];case 6:return i=u.sent(),a={error:i},[3,8];case 7:try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))}))];case 12:return b.sent(),_||this._broadcastRemoveEvent(p,f),[3,15];case 13:return e instanceof qe?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,15];case 14:b.sent(),b.label=15;case 15:return[2]}}))}))}))}return e.prototype._broadcastUpdateEvent=function(e,t,n){var r,s;try{for(var i=C(this._observers.values()),a=i.next();!a.done;a=i.next()){var o=a.value;o.onUpdate&&o.onUpdate(e,t,n)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(r)throw r.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onRemove&&a.onRemove(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t)},e.prototype.unsubscribe=function(e){this._observers.delete(e)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),on=function(){function e(e){var t=e.cacheContext,n=e.messageCache,r=e.unsentMessageCache,s=e.dispatcher,i=e.logger,a=this;this._observers=new Map,this._cacheContext=t,this._logger=i,s.on((function(e){return g(a,void 0,void 0,(function(){var t,s,i,a,o,u,c,l,h,d,p,f,_,v,m=this;return y(this,(function(C){switch(C.label){case 0:return e instanceof L?(t=e.messages,_=e.source,o=e.isWebSocketEventComing,s=t.filter((function(e){return e.messageId>0})),i=t.filter((function(e){return 0===e.messageId})),s.length>0?[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.upsert(s)];case 1:return e.sent(),[4,r.remove(s.map((function(e){return e instanceof Ct?e.reqId:null})).filter((function(e){return null!==e})))];case 2:return e.sent(),[2]}}))}))}))]:[3,2]):[3,5];case 1:C.sent(),o||this._broadcastUpdateEvent(s,_),C.label=2;case 2:return i.length>0?[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,r.upsert(i)];case 1:return e.sent(),[2]}}))}))}))]:[3,4];case 3:C.sent(),o||this._broadcastUpdateEvent(i,_),C.label=4;case 4:return[3,21];case 5:return e instanceof w?(a=e.messageIds,_=e.source,o=e.isWebSocketEventComing,[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.remove(a)];case 1:return e.sent(),[2]}}))}))}))]):[3,7];case 6:return C.sent(),o||this._broadcastRemoveEvent(a,_),[3,21];case 7:return e instanceof I?(u=e.reqId,_=e.source,[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,r.remove([u])];case 1:return e.sent(),[2]}}))}))}))]):[3,9];case 8:return C.sent(),this._broadcastRemoveUnsentEvent(u,_),[3,21];case 9:return e instanceof A?(c=e.polls,_=e.source,this._cacheContext.localCacheEnabled?(l=c.map((function(e){return e.messageId})),[4,Promise.all(l.map((function(e){return n.get(e)})))]):[3,12]):[3,13];case 10:return(h=C.sent().filter((function(e){return e}))).length>0&&c.forEach((function(e){var t=h.find((function(t){return t.messageId===e.messageId}));t&&t.applyPoll(e)})),[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.upsert(h)];case 1:return[2,e.sent()]}}))}))}))];case 11:C.sent(),C.label=12;case 12:return this._broadcastPollChangeLogEvent(c,_),[3,21];case 13:return e instanceof T?(d=e.event,_=e.source,[4,n.get(d.messageId)]):[3,17];case 14:return(p=C.sent())&&p.isUserMessage()&&p.poll&&p.poll.applyPollUpdateEvent(d)?[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.upsert([p])];case 1:return[2,e.sent()]}}))}))}))]:[3,16];case 15:C.sent(),C.label=16;case 16:return this._broadcastPollUpdateEvent(d,_),[3,21];case 17:return e instanceof U?(f=e.event,_=e.source,[4,n.get(f.messageId)]):[3,21];case 18:return(v=C.sent())&&v.isUserMessage()&&v.poll&&v.poll.applyPollVoteEvent(f)?[4,S((function(){return g(m,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,n.upsert([v])];case 1:return[2,e.sent()]}}))}))}))]:[3,20];case 19:C.sent(),C.label=20;case 20:this._broadcastPollVoteEvent(f,_),C.label=21;case 21:return[2]}}))}))}))}return e.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onUpdate&&a.onUpdate(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype._broadcastPollChangeLogEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onPollChangeLogUpdate&&a.onPollChangeLogUpdate(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype._broadcastPollUpdateEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onPollUpdate&&a.onPollUpdate(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype._broadcastPollVoteEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onPollVote&&a.onPollVote(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onRemove&&a.onRemove(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var s=C(this._observers.values()),i=s.next();!i.done;i=s.next()){var a=i.value;a.onRemoveUnsent&&a.onRemoveUnsent(e,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t)},e.prototype.unsubscribe=function(e){this._observers.delete(e)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),un=function(t){function n(e){var n=e.userId,a=e.ts,o=e.token,u=e.filter,c=t.call(this)||this,l=i(i({},Zt),u),h=l.customTypes,d=l.includeEmpty,p=l.includeFrozen;return c.method=D.GET,c.path="".concat(k,"/").concat(encodeURIComponent(n),"/my_group_channels/changelogs"),c.params=r(s({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:a||null,token:o,custom_types:h,show_empty:d,show_frozen:p})),c}return e(n,t),n}(F),cn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.updatedChannels=n.updated.map((function(t){return new cs(e,t)})),r.deletedChannelUrls=n.deleted,r.hasMore=n.has_more,r.token=n.next,r}return e(n,t),n}(R),ln=function(t){function n(e){var n=e.channelUrl,r=e.isInternalCall,s=t.call(this)||this;return s.method=D.GET,s.path="".concat(r?x:O,"/").concat(encodeURIComponent(n)),s.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0},s}return e(n,t),n}(F),hn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r}return e(n,t),n}(R),dn={includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,channelUrlsFilter:void 0,customTypesFilter:void 0,customTypeStartsWithFilter:void 0,nicknameContainsFilter:void 0,nicknameStartsWithFilter:void 0,nicknameExactMatchFilter:void 0,channelNameContainsFilter:void 0,myMemberStateFilter:Ot.ALL,unreadChannelFilter:Gt.ALL,superChannelFilter:Ht.ALL,publicChannelFilter:xt.ALL,hiddenChannelFilter:Vt.ALL,userIdsFilter:{userIds:[],includeMode:!0,queryType:Bt.AND},searchFilter:{query:void 0,fields:[]},metadataKey:void 0,metadataValues:void 0,metadataOrderKeyFilter:void 0,metadataValueStartsWith:void 0,order:Ge.LATEST_LAST_MESSAGE},pn=function(t){function n(e){var n=this,s=e.userId,i=e.token,a=e.limit,o=e.order,u=e.includeEmpty,c=e.myMemberStateFilter,l=e.superChannelFilter,h=e.publicChannelFilter,d=e.unreadChannelFilter,p=e.nicknameContainsFilter,f=e.nicknameStartsWithFilter,_=e.nicknameExactMatchFilter,v=e.channelNameContainsFilter,m=e.channelUrlsFilter,g=e.customTypesFilter,y=e.customTypeStartsWithFilter,C=e.hiddenChannelFilter,E=e.metadataOrderKeyFilter,b=e.metadataKey,M=e.metadataValues,N=e.metadataValueStartsWith,S=e.includeFrozen,U=e.includeMetaData,T=e.searchFilter,A=e.userIdsFilter;return(n=t.call(this)||this).method=D.GET,n.path="".concat(k,"/").concat(encodeURIComponent(s),"/my_group_channels"),n.params=r({token:i,limit:a,order:null!=o?o:dn.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:null!=u?u:dn.includeEmpty,member_state_filter:null!=c?c:dn.myMemberStateFilter,super_mode:null!=l?l:dn.superChannelFilter,public_mode:null!=h?h:dn.publicChannelFilter,unread_filter:null!=d?d:dn.unreadChannelFilter,members_nickname_contains:p,members_nickname_startswith:f,members_nickname:_,name_contains:v,channel_urls:m,custom_types:g,custom_type_startswith:y,hidden_mode:C,metadata_order_key:E,metadata_key:b,metadata_values:M,metadata_value_startswith:N,show_frozen:S,show_metadata:U}),T&&T.query&&T.fields&&(n.params.search_query=T.query,n.params.search_fields=T.fields),A&&A.userIds&&A.userIds.length>0&&(A.includeMode?(n.params.members_include_in=A.userIds,n.params.query_type=A.queryType.toUpperCase()):n.params.members_exactly_in=A.userIds),n}return e(n,t),n}(F),fn=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.channels=[];var s=n.next,i=n.channels,a=n.ts;return r.token=s,i&&i.length>0&&(r.channels=i.map((function(t){return t.ts=a,new cs(e,t)}))),r.ts=null!=a?a:0,r}return e(n,t),n}(R),_n=function(t){function n(e){var n=e.userId,r=e.filter,s=t.call(this)||this,i=r.myMemberStateFilter;return s.method=D.GET,s.path="".concat(k,"/").concat(encodeURIComponent(n),"/group_channel_count"),s.params={state:null!=i?i:Ot.ALL},s}return e(n,t),n}(F),vn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.groupChannelCount=n.group_channel_count,r}return e(n,t),n}(R),mn=function(t){function n(e){var n=e.userId,s=e.filter,i=t.call(this)||this,a=s.keys;return i.method=D.GET,i.path="".concat(k,"/").concat(encodeURIComponent(n),"/unread_item_count"),i.params=r({item_keys:a}),i}return e(n,t),n}(F),gn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return"number"==typeof n[Qt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]&&(r.groupChannelUnreadMentionCount=n[Qt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),"number"==typeof n[Qt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]&&(r.groupChannelUnreadMessageCount=n[Qt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Qt.GROUP_CHANNEL_INVITATION_COUNT]&&(r.groupChannelInvitationCount=n[Qt.GROUP_CHANNEL_INVITATION_COUNT]),"number"==typeof n[Qt.SUPER_UNREAD_MENTION_COUNT]&&(r.superGroupChannelUnreadMentionCount=n[Qt.SUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Qt.SUPER_UNREAD_MESSAGE_COUNT]&&(r.superGroupChannelUnreadMessageCount=n[Qt.SUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Qt.SUPER_INVITATION_COUNT]&&(r.superGroupChannelInvitationCount=n[Qt.SUPER_INVITATION_COUNT]),"number"==typeof n[Qt.NONSUPER_UNREAD_MENTION_COUNT]&&(r.nonSuperGroupChannelUnreadMentionCount=n[Qt.NONSUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Qt.NONSUPER_UNREAD_MESSAGE_COUNT]&&(r.nonSuperGroupChannelUnreadMessageCount=n[Qt.NONSUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Qt.NONSUPER_INVITATION_COUNT]&&(r.nonSuperGroupChannelInvitationCount=n[Qt.NONSUPER_INVITATION_COUNT]),r}return e(n,t),n}(R),yn=function(t){function n(e){var n=e.userId,r=t.call(this)||this;return r.method=D.GET,r.path="".concat(k,"/").concat(encodeURIComponent(n),"/unread_channel_count"),r}return e(n,t),n}(F),Cn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.unreadCount=n.unread_count,r}return e(n,t),n}(R),En=function(t){function n(e){var n=e.userId,r=e.filter,s=t.call(this)||this,i=r.channelCustomTypesFilter,a=r.superChannelFilter;return s.method=D.GET,s.path="".concat(k,"/").concat(encodeURIComponent(n),"/unread_message_count"),s.params={super_mode:null!=a?a:Ht.ALL,custom_types:i},s}return e(n,t),n}(F),bn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.unreadCount=n.unread_count,r}return e(n,t),n}(R),Mn=function(t){function n(e){var n=e.channelUrl,r=e.scheduledStatus,s=e.messageTypeFilter,i=t.call(this)||this;return i.method=D.GET,i.path="".concat(H,"/count"),i.params={channel_url:n,status:Sn(r)},s&&(i.params.message_type=s),i}return e(n,t),n}(F),Nn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.count=n.count,r}return e(n,t),n}(R),Sn=function(e){if(!e)return[];var t=[];return e.forEach((function(e){switch(e){case yt.PENDING:t.push(Et.PENDING);break;case yt.SENT:t.push(Et.IN_QUEUE),t.push(Et.SENT);break;case yt.CANCELED:t.push(Et.CANCELED);break;case yt.FAILED:t.push(Et.FAILED)}})),t},Un=function(t){function n(e){var n=this,s=e.userId,i=e.channelUrl,a=e.coverUrl,o=e.coverImage,u=e.isDistinct,c=e.isSuper,l=e.isBroadcast,h=e.isPublic,d=e.isExclusive,p=e.isDiscoverable,f=e.isStrict,_=e.isEphemeral,g=e.accessCode,y=e.name,C=e.data,E=e.customType,b=e.messageSurvivalSeconds,M=e.invitedUserIds,N=e.operatorUserIds;return(n=t.call(this)||this).method=D.POST,n.path=O,n.params=r({user_ids:v([s],m(null!=M?M:[]),!1).filter((function(e,t,n){return t===n.indexOf(e)})),channel_url:i,cover_url:a,cover_file:o,is_distinct:u,is_super:c,is_broadcast:l,is_exclusive:d,is_public:h,is_discoverable:p,strict:f,is_ephemeral:_,access_code:g,name:y,data:C,custom_type:E,operator_ids:N,message_survival_seconds:b}),n}return e(n,t),n}(F),Tn=function(t){function n(e,n){var r,s=this;return(s=t.call(this,e,n)||this).channel=new cs(e,n),s.isCreated=null===(r=n.is_created)||void 0===r||r,s}return e(n,t),n}(R),An=function(t){function n(e){var n=e.userId,r=e.channelUrls,s=t.call(this)||this;return s.method=D.PUT,s.path="".concat(k,"/").concat(encodeURIComponent(n),"/mark_as_read_all"),s.params={channel_urls:r},s}return e(n,t),n}(F);!function(t){function n(){return null!==t&&t.apply(this,arguments)||this}e(n,t)}(R);var In=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.accessCode;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/join"),n.params={user_id:s,access_code:i},n}return e(n,t),n}(F),wn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r}return e(n,t),n}(R),Ln=function(t){function n(e,n,r){var s=t.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=void 0===a?0:a,u=i.joined_member_count,c=void 0===u?0:u,l=i.users,h=void 0===l?null:l;return s.memberCount=o,s.joinedMemberCount=c,s.members=Array.isArray(h)?h.map((function(t){return new zt(e,t)})):[new zt(e,r.data)],s}return e(n,t),n}(ct),Dn=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.shouldRemoveOperatorStatus;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/leave"),n.params={user_id:s,should_remove_operator_status:i},n}return e(n,t),n}(F);!function(t){function n(e,n){return t.call(this,e,n)||this}e(n,t)}(R);var kn=function(t){function n(e,n,r){var s=t.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=void 0===a?0:a,u=i.joined_member_count,c=void 0===u?0:u;return s.memberCount=o,s.joinedMemberCount=c,s.member=new zt(s._iid,r.data),s}return e(n,t),n}(ct),Pn=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userIds;return(n=t.call(this)||this).method=D.POST,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/invite"),n.params={user_ids:s},n}return e(n,t),n}(F),Fn=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r}return e(n,t),n}(R),Rn=function(t){function n(e,n,r){var s=t.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=void 0===a?0:a,u=i.joined_member_count,l=void 0===u?0:u,h=i.inviter,d=i.invitees,p=void 0===d?[]:d;return s.memberCount=o,s.joinedMemberCount=l,s.inviter=new c(e,h),s.invitees=p.map((function(t){return new zt(e,t)})),s}return e(n,t),n}(ct),xn=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userId;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/decline"),n.params={user_id:s},n}return e(n,t),n}(F);!function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r.channel.myMemberState=Rt.NONE,r}e(n,t)}(R);var On=function(t){function n(e,n,r){var s=t.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=i.joined_member_count,u=i.inviter,l=i.invitee;return s.memberCount=null!=a?a:0,s.joinedMemberCount=null!=o?o:0,s.inviter=new c(e,u),s.invitee=new zt(e,l),s}return e(n,t),n}(ct),Hn=function(t){function n(e){var n=e.channelUrl;return t.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n}})||this}return e(n,t),n}(V),Gn=function(t){function n(e,n,r){var s=t.call(this,e,"READ",r)||this;return s.readStatus=new jt(e,r),s}return e(n,t),n}(q),Vn=function(t){function n(e){var n=e.channelUrl,s=e.userId,i=t.call(this)||this;return(i=t.call(this)||this).method=D.PUT,i.path="".concat(O,"/").concat(encodeURIComponent(n),"/messages/mark_as_delivered"),i.params=r({userId:s}),i}return e(n,t),n}(F);!function(t){function n(){return null!==t&&t.apply(this,arguments)||this}e(n,t)}(R);var qn,Bn=function(t){function n(e,n,r){var s=t.call(this,e,"DLVR",r)||this;return s.channelUrl=r.channel_url,s.deliveredStateUpdate=r.updated,s}return e(n,t),n}(q),Wn={hidePreviousMessages:!1,allowAutoUnhide:!0},zn=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.hidePreviousMessages,a=e.allowAutoUnhide;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/hide"),n.params={user_id:s,hide_previous_messages:null!=i?i:Wn.hidePreviousMessages,allow_auto_unhide:null!=a?a:Wn.allowAutoUnhide},n}return e(n,t),n}(F),jn=function(t){function n(e,n){var r=t.call(this,e,n)||this,s=n.ts_message_offset;return r.messageOffsetTimestamp=s,r}return e(n,t),n}(R),Qn=function(t){function n(e,n,r){var s,i,a,o=this;return(o=t.call(this,e,"SYEV",r)||this).allowAutoUnhide=null,o.hidePreviousMessages=null,o.messageOffsetTimestamp=null,r.data&&(o.allowAutoUnhide=null!==(s=r.data.allow_auto_unhide)&&void 0!==s?s:null,o.hidePreviousMessages=null!==(i=r.data.hide_previous_messages)&&void 0!==i?i:null),o.messageOffsetTimestamp=null!==(a=r.ts_message_offset)&&void 0!==a?a:null,o}return e(n,t),n}(q),Kn=function(t){function n(e){var n=e.channelUrl,r=e.time;return t.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return e(n,t),n}(V),Yn=function(t){function n(e,n,r){var s=t.call(this,e,"SYEV",r)||this;return s.user=new c(e,r.data),s}return e(n,t),n}(q),Jn=function(t){function n(e){var n=e.channelUrl,r=e.time;return t.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return e(n,t),n}(V),Xn=function(t){function n(e,n,r){var s=t.call(this,e,"SYEV",r)||this;return s.user=new c(e,r.data),s}return e(n,t),n}(q),Zn=function(t){function n(e){var n=e.channelUrl,r=e.messageId;return t.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:n,msg_id:r}})||this}return e(n,t),n}(V),$n=function(t){function n(e,n){var r,s,i,a,o,u,c,l,h,d,p,f,_,v,m,g,y,C,E,b,M,N,S=this;return(S=t.call(this,e,n)||this).includeEmpty=!1,S.includeFrozen=!0,S.includeMetaData=!0,S.channelUrlsFilter=null,S.customTypesFilter=null,S.customTypeStartsWithFilter=null,S.nicknameContainsFilter=null,S.nicknameStartsWithFilter=null,S.nicknameExactMatchFilter=null,S.channelNameContainsFilter="",S.myMemberStateFilter=Ot.ALL,S.unreadChannelFilter=Gt.ALL,S.superChannelFilter=Ht.ALL,S.publicChannelFilter=xt.ALL,S.hiddenChannelFilter=Vt.UNHIDDEN,S.searchFilter={fields:[],query:null},S.userIdsFilter={userIds:[],includeMode:!0,queryType:Bt.AND},S.metadataKey=null,S.metadataValues=null,S.metadataOrderKeyFilter=null,S.metadataValueStartsWith=null,S.order=Ge.LATEST_LAST_MESSAGE,S.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,S.includeFrozen=null===(s=n.includeFrozen)||void 0===s||s,S.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,S.channelUrlsFilter=null!==(a=n.channelUrlsFilter)&&void 0!==a?a:null,S.customTypesFilter=null!==(o=n.customTypesFilter)&&void 0!==o?o:null,S.customTypeStartsWithFilter=null!==(u=n.customTypeStartsWithFilter)&&void 0!==u?u:"",S.nicknameContainsFilter=null!==(c=n.nicknameContainsFilter)&&void 0!==c?c:null,S.nicknameStartsWithFilter=null!==(l=n.nicknameStartsWithFilter)&&void 0!==l?l:null,S.nicknameExactMatchFilter=null!==(h=n.nicknameExactMatchFilter)&&void 0!==h?h:null,S.channelNameContainsFilter=null!==(d=n.channelNameContainsFilter)&&void 0!==d?d:"",S.myMemberStateFilter=null!==(p=n.myMemberStateFilter)&&void 0!==p?p:Ot.ALL,S.unreadChannelFilter=null!==(f=n.unreadChannelFilter)&&void 0!==f?f:Gt.ALL,S.superChannelFilter=null!==(_=n.superChannelFilter)&&void 0!==_?_:Ht.ALL,S.publicChannelFilter=null!==(v=n.publicChannelFilter)&&void 0!==v?v:xt.ALL,S.hiddenChannelFilter=null!==(m=n.hiddenChannelFilter)&&void 0!==m?m:Vt.UNHIDDEN,S.searchFilter=null!==(g=n.searchFilter)&&void 0!==g?g:{fields:[],query:null},S.userIdsFilter=null!==(y=n.userIdsFilter)&&void 0!==y?y:{userIds:[],includeMode:!0,queryType:Bt.AND},S.metadataKey=null!==(C=n.metadataKey)&&void 0!==C?C:null,S.metadataValues=null!==(E=n.metadataValues)&&void 0!==E?E:null,S.metadataOrderKeyFilter=null!==(b=n.metadataOrderKeyFilter)&&void 0!==b?b:null,S.metadataValueStartsWith=null!==(M=n.metadataValueStartsWith)&&void 0!==M?M:null,S.order=null!==(N=n.order)&&void 0!==N?N:Ge.LATEST_LAST_MESSAGE,S}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&b("boolean",this.includeEmpty)&&b("boolean",this.includeFrozen)&&b("boolean",this.includeMetaData)&&b("string",this.channelNameContainsFilter)&&E("string",this.channelUrlsFilter,!0)&&E("string",this.customTypesFilter,!0)&&b("string",this.customTypeStartsWithFilter)&&b("string",this.nicknameContainsFilter,!0)&&b("string",this.nicknameStartsWithFilter,!0)&&b("string",this.nicknameExactMatchFilter,!0)&&a(Ot,this.myMemberStateFilter)&&a(Ht,this.superChannelFilter)&&a(xt,this.publicChannelFilter)&&a(Gt,this.unreadChannelFilter)&&a(Vt,this.hiddenChannelFilter)&&E(Wt,this.searchFilter.fields)&&b("string",this.searchFilter.query,!0)&&E("string",this.userIdsFilter.userIds)&&b("boolean",this.userIdsFilter.includeMode)&&a(Bt,this.userIdsFilter.queryType)&&a(Ge,this.order)&&b("string",this.metadataOrderKeyFilter,!0)&&b("string",this.metadataKey,!0)&&E("string",this.metadataValues,!0)&&b("string",this.metadataValueStartsWith,!0)},n.prototype.serialize=function(){return B(this)},n.prototype.next=function(){return g(this,void 0,void 0,(function(){var e,t,n;return y(this,(function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,rr.of(this._iid).getMyGroupChannels(this._token,s(i({},this)),this.limit)]):[3,2]:[3,5];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasNext=!!n,this._isLoading=!1,[2,t];case 2:return[2,[]];case 3:throw _.queryInProgress;case 4:return[3,6];case 5:throw _.invalidParameters;case 6:return[2]}}))}))},n}(W),er=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,s=void 0===r?0:r;this.top=n,this.bottom=s}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom)},e.prototype.intersect=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,v([this.top],m(e),!1)),this.bottom=Math.max.apply(Math,v([this.bottom],m(e),!1))},e}(),tr=function(t){function n(e,n,r){var s,a=this;return(a=t.call(this,e,"SYEV",r)||this).pinnedMessageIds=[],a.latestPinnedMessage=null,a.ts=0,r.data&&(a.pinnedMessageIds=null!==(s=r.data.pinned_message_ids)&&void 0!==s?s:[],a.latestPinnedMessage=r.data.latest_pinned_message?bt(e,i({},r.data.latest_pinned_message)):null),a.ts=r.ts,a}return e(n,t),n}(q),nr={},rr=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,s=t.dispatcher,i=t.sessionManager,a=t.requestQueue,o=t.logger,u=t.disableMack,c=void 0!==u&&u,l=this;return this._leftChannels=new Map,this._disableMack=!1,this._markAsReadAllLastSentAt=0,nr[e]||(this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=a,this._dispatcher=s,this._logger=o,this._disableMack=c,this._groupChannelHandlers=new Map,this._groupChannelCache=new Yt(this._iid,{sdkState:n,cacheContext:r}),this._unsentMessageCache=new je(this._iid,{sdkState:n,cacheContext:r}),this._messageCache=new Qe(this._iid,{sdkState:n,cacheContext:r,unsentMessageCache:this._unsentMessageCache}),this._groupChannelBroadcast=new an({groupChannelCache:this._groupChannelCache,messageCache:this._messageCache,unsentMessageCache:this._unsentMessageCache,dispatcher:s}),this._messageBroadcast=new on({cacheContext:r,messageCache:this._messageCache,unsentMessageCache:this._unsentMessageCache,dispatcher:s,logger:o}),setInterval((function(){var e,t,n=function(e){e.invalidateTypingStatus()&&(l._dispatcher.dispatch(new We({channels:[e],source:ze.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),l._groupChannelHandlers.forEach((function(t){t.onTypingStatusUpdated&&t.onTypingStatusUpdated(e)})))};try{for(var r=C(l._groupChannelCache.channels),s=r.next();!s.done;s=r.next()){n(s.value)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}),1e3),this._dispatcher.on((function(e){e instanceof q?l._handleEvent(e):e instanceof Ke?g(l,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return t=e.message,[4,this.getChannel(t.channelUrl,!0)];case 1:return n=r.sent(),t instanceof Mt?n._autoResendUserMessage(t):t instanceof Nt&&n._autoResendFileMessage(t),[2]}}))})):e instanceof Ye&&l.reduceDBSize()})),nr[e]=this),nr[e]}return e.of=function(e){return nr[e]},e.clear=function(e){nr[e]&&delete nr[e]},Object.defineProperty(e.prototype,"handlers",{get:function(){return v([],m(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),e.prototype.buildGroupChannelFromSerializedData=function(e){var t=z(e);return new cs(this._iid,cs.payloadify(t))},e.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var t=z(e);return new $n(this._iid,t)},e.prototype.buildMemberFromSerializedData=function(e){var t=z(e);return new zt(this._iid,zt.payloadify(t))},e.prototype.getChannelFromCache=function(e){var t;return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},e.prototype.getChannelsFromCache=function(e,t,n,r,s){return g(this,void 0,void 0,(function(){return y(this,(function(i){switch(i.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:t,order:n,limit:r,borderlineChannelUrl:s})];case 1:return[2,i.sent()]}}))}))},e.prototype.upsertChannelsToCache=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.removeChannelsFromCache=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.clearChannelsFromCache=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}}))}))},e.prototype.reduceDBSize=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i,a,o,u,c,l,h,d,p;return y(this,(function(f){switch(f.label){case 0:return e=j.of(this._iid).cacheContext,t=e.localCacheConfig,n=e.nestdb,e.localCacheEnabled&&n&&n.state==Xe.OPENED?(r=1024*t.maxSize*1024,[4,n.estimateUsage()]):[2];case 1:if((s=f.sent())<r)return[2];i=[],a=this._groupChannelCache.channels,o={},h=0,f.label=2;case 2:return h<a.length?[4,this.getMessagesFromCache(a[h].url,0,"prev",new Je)]:[3,5];case 3:u=f.sent(),o[a[h].url]=JSON.stringify(u).length,c=new Q({channel:a[h],cachedMessageCount:u.length}),i.push(c),f.label=4;case 4:return h++,[3,2];case 5:l=i.sort(t.clearOrderComparator),h=0,f.label=6;case 6:return h<l.length?[4,this._messageCache.removeMessagesOfChannel(l[h].channel.url)]:[3,10];case 7:return f.sent(),[4,this._messageCache._getGroupChannelPreferenceSize(l[h].channel.url)];case 8:if(d=f.sent(),p=o[l[h].channel.url]+d,(s-=p)<r)return[3,10];f.label=9;case 9:return h++,[3,6];case 10:return[2]}}))}))},e.prototype._handleEvent=function(e){var t;return g(this,void 0,void 0,(function(){var n,r,s,i,a,c,l,h,d,p,f,_,v,m,E,b,M,N,A,I,D,k,P,F,R,x,O,H,G,V,q,B,W,z,Q,X,$,ee,te,ne,re,se,ie,ae,oe,ue,ce,le,he,de,pe,fe,_e,ve,me,ge,ye,De,ke,Pe,Fe,Re,xe,Oe,He,Ge,Ve,qe,je,Qe,Ke,Ye,Je,Xe,tt,nt,rt,st,it,at,ot,ut,gt,yt,Et,bt,Mt,Nt,Ut,Tt,At,It,wt,Lt,Dt,kt,Pt,Ft,xt,Ot,Ht,Gt,Vt,qt,Bt,Wt,zt,jt,Qt,Kt,Yt,Jt,Xt,Zt,$t,en,tn,nn,rn,sn,an,on,un,cn,ln,hn,dn,pn,fn,_n,vn,mn,gn,yn,Cn,En,bn,Mn,Nn=this;return y(this,(function(Sn){switch(Sn.label){case 0:switch(Sn.trys.push([0,80,,81]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,19];case"MCNT":return[3,23];case"PEDI":return[3,32];case"VOTE":return[3,35];case"SYEV":return[3,38];case"USEV":return[3,78]}return[3,79];case 1:return h=null,"MESG"===e.code?h=e.as(Le):"FILE"===e.code?h=e.as(St):"ADMM"!==e.code&&"BRDM"!=e.code||(h=e.as(mt)),h?(n=h.message,r=h.isMentioned,s=h.forceUpdateLastMessage,n.channelType!==u.GROUP?[3,3]:(this._disableMack||S((function(){return g(Nn,void 0,void 0,(function(){var e;return y(this,(function(t){return e=new Zn(n),this._requestQueue.send(e),[2]}))}))})),R=this._groupChannelCache.isCachedInMemory(n.channelUrl),_=n instanceof Ct&&n.sender.userId===this._sdkState.userId,[4,this.getChannel(n.channelUrl,!0)])):[3,3];case 2:if((i=Sn.sent()).hiddenState===rs.HIDDEN_ALLOW_AUTO_UNHIDE&&(i.hiddenState=rs.UNHIDDEN),n instanceof Ct){a=j.of(this._iid).useMemberInfoInMessage;try{for(c=C(i.members),l=c.next();!l.done;l=c.next())if((At=l.value).userId===n.sender.userId){a||(n.sender.nickname=At.nickname,n.sender.plainProfileUrl=At.plainProfileUrl,n.sender.metaData=At.metaData,n.sender.isBlockedByMe=At.isBlockedByMe);break}}catch(e){fn={error:e}}finally{try{l&&!l.done&&(_n=c.return)&&_n.call(c)}finally{if(fn)throw fn.error}}!a&&r&&(null===(t=n.mentionedUsers)||void 0===t||t.forEach((function(e){var t,n;try{for(var r=C(i.members),s=r.next();!s.done;s=r.next()){var a=s.value;if(e.userId===a.userId){e.nickname=a.nickname,e.plainProfileUrl=a.plainProfileUrl,e.metaData=a.metaData;break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))),_&&(E=this._sessionManager.currentUser)&&(E.nickname=n.sender.nickname,E.plainProfileUrl=n.sender.plainProfileUrl,E.metaData=n.sender.metaData)}n.silent&&!_||(i.isEphemeral||R)&&((!i.lastMessage||i.lastMessage.createdAt<n.createdAt)&&(i.lastMessage=n),_||i._updateUnreadCount(i.unreadMessageCount+1,i.unreadMentionCount+(r?1:0))),s&&(!i.lastMessage||i.lastMessage.createdAt<n.createdAt)&&(i.lastMessage=n),this._dispatcher.dispatch(new We({channels:[i],source:ze.EVENT_MESSAGE_RECEIVED})),n.silent&&!_||Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(a){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(i)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),this._dispatcher.dispatch(new L({messages:[n],source:J.EVENT_MESSAGE_RECEIVED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,s,a,o;return y(this,(function(u){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(s=t.value).onMessageReceived&&s.onMessageReceived(i,n),r&&s.onMentionReceived&&s.onMentionReceived(i,n)}catch(e){a={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(a)throw a.error}}return[2]}))}))})),Sn.label=3;case 3:return[3,79];case 4:return h=null,"MEDI"===e.code?h=e.as(Ie):"FEDI"===e.code?h=e.as(we):"AEDI"===e.code&&(h=e.as(vt)),h?(d=h.message,p=h.mentionCountChange,d.channelType!==u.GROUP?[3,6]:(R=this._groupChannelCache.isCachedInMemory(d.channelUrl),[4,this.getChannel(d.channelUrl,!0)])):[3,6];case 5:f=Sn.sent(),_=d instanceof Ct&&d.sender.userId===this._sdkState.userId,v=!1,_?(m=d.sender,(E=this._sessionManager.currentUser)&&(E.nickname=m.nickname,E.plainProfileUrl=m.plainProfileUrl,E.metaData=m.metaData)):f.isReadMessage(d)||0!==p&&!d.silent&&R&&(f._updateUnreadCount(f.unreadMessageCount,f.unreadMentionCount+p),v=!0),!f.lastMessage||f.lastMessage.createdAt<d.createdAt?(f.lastMessage=d,v=!0):f.lastMessage.isIdentical(d)&&(R?f.lastMessage.updatedAt<d.updatedAt&&(f.lastMessage=d,v=!0):v=!0),b=!1,f.lastPinnedMessage&&f.lastPinnedMessage.messageId===d.messageId&&(f.lastPinnedMessage=d,v=!0,b=!0),v&&(this._dispatcher.dispatch(new We({channels:[f],source:b?ze.EVENT_PINNED_MESSAGE_UPDATED:ze.EVENT_MESSAGE_UPDATED})),d.silent&&!_||Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(f)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),b&&Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPinnedMessageUpdated&&n.onPinnedMessageUpdated(f)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),this._dispatcher.dispatch(new L({messages:[d],source:J.EVENT_MESSAGE_UPDATED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageUpdated&&n.onMessageUpdated(f,d),0!==p&&n.onMentionReceived&&n.onMentionReceived(f,d)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Sn.label=6;case 6:return[3,79];case 7:return M=e.as(Ae),le=M.channelUrl,he=M.channelType,N=M.messageId,he!==u.GROUP?[3,9]:[4,this.getChannel(le,!0)];case 8:A=Sn.sent(),this._dispatcher.dispatch(new w({messageIds:[N],source:J.EVENT_MESSAGE_DELETED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageDeleted&&n.onMessageDeleted(A,N)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Sn.label=9;case 9:return[3,79];case 10:return(I=e.as(Gn).readStatus).channelType!==u.GROUP?[3,12]:(R=this._groupChannelCache.isCachedInMemory(I.channelUrl),[4,this.getChannel(I.channelUrl,!0)]);case 11:D=Sn.sent(),R&&D._updateUnreadMemberState(I.reader.userId,I.readAt),I.reader.userId===this._sdkState.userId?R?(D.unreadMessageCount>0||D.unreadMentionCount>0)&&(D._updateUnreadCount(0,0),this._dispatcher.dispatch(new We({channels:[D],source:ze.EVENT_CHANNEL_READ})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(D)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):0!==D.unreadMessageCount&&0!==D.unreadMentionCount||(this._dispatcher.dispatch(new We({channels:[D],source:ze.EVENT_CHANNEL_READ})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(D)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):(this._dispatcher.dispatch(new We({channels:[D],source:ze.EVENT_CHANNEL_READ})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUnreadMemberStatusUpdated&&n.onUnreadMemberStatusUpdated(D)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),Sn.label=12;case 12:return[3,79];case 13:return k=e.as(Bn),le=k.channelUrl,P=k.deliveredStateUpdate,F=void 0===P?{}:P,R=this._groupChannelCache.isCachedInMemory(le),[4,this.getChannel(le,!0)];case 14:if(x=Sn.sent(),R)for(O in F)x._updateUndeliveredMemberState(O,F[O]);return Object.keys(F).some((function(e){return e!==Nn._sdkState.userId}))&&(this._dispatcher.dispatch(new We({channels:[x],source:ze.EVENT_CHANNEL_DELIVERED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUndeliveredMemberStatusUpdated&&n.onUndeliveredMemberStatusUpdated(x)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 15:return H=e.as(_t),le=H.channelUrl,he=H.channelType,G=H.event,he!==u.GROUP?[3,18]:[4,this.getChannel(le,!0)];case 16:return V=Sn.sent(),[4,this.getMessageFromCache(G.messageId)];case 17:(W=Sn.sent())&&(W.applyReactionEvent(G),this._dispatcher.dispatch(new L({messages:[W],source:J.EVENT_MESSAGE_REACTION_UPDATED}))),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onReactionUpdated&&n.onReactionUpdated(V,G)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Sn.label=18;case 18:return[3,79];case 19:return(q=e.as(ft).event).channelType!==u.GROUP?[3,22]:[4,this.getChannel(q.channelUrl,!0)];case 20:return B=Sn.sent(),[4,this.getMessageFromCache(q.targetMessageId)];case 21:(W=Sn.sent())&&(W.applyThreadInfoUpdateEvent(q),this._dispatcher.dispatch(new L({messages:[W],source:J.EVENT_MESSAGE_THREADINFO_UPDATED}))),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onThreadInfoUpdated&&n.onThreadInfoUpdated(B,q)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Sn.label=22;case 22:return[3,79];case 23:z=e.as(pt).groupChannelMemberCounts,Q=[],Sn.label=24;case 24:Sn.trys.push([24,29,30,31]),X=C(z),$=X.next(),Sn.label=25;case 25:return $.done?[3,28]:(ee=$.value,le=ee.channelUrl,it=ee.memberCount,at=ee.joinedMemberCount,te=ee.updatedAt,[4,this.getChannelFromCache(le)]);case 26:(ne=Sn.sent())&&ne._setLatestMemberCount(it,at,te)&&Q.push(ne),Sn.label=27;case 27:return $=X.next(),[3,25];case 28:return[3,31];case 29:return re=Sn.sent(),vn={error:re},[3,31];case 30:try{$&&!$.done&&(mn=X.return)&&mn.call(X)}finally{if(vn)throw vn.error}return[7];case 31:return Q.length>0&&(this._dispatcher.dispatch(new We({channels:Q,source:ze.EVENT_CHANNEL_MEMBER_COUNT_UPDATED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(Q)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 32:return se=e.as(dt),ie=se.event,ae=se.status,le=se.channelUrl,he=se.channelType,le&&he===u.GROUP?[4,this.getChannel(le,!0)]:[3,34];case 33:oe=Sn.sent(),this._dispatcher.dispatch(new T({event:ie,source:J.EVENT_POLL_UPDATED})),Y(ae===Z?function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(oe,ie.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(oe,ie)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),Sn.label=34;case 34:return[3,79];case 35:return ue=e.as(Te),ce=ue.event,le=ue.channelUrl,he=ue.channelType,le&&he===u.GROUP?[4,this.getChannel(le,!0)]:[3,37];case 36:de=Sn.sent(),this._dispatcher.dispatch(new U({event:ce,source:J.EVENT_POLL_VOTED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(de,ce)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Sn.label=37;case 37:return[3,79];case 38:if(!(pe=e.as(ct).event).isGroupChannelEvent)return[3,77];switch(pe.category){case lt.CHANNEL_JOIN:return[3,39];case lt.CHANNEL_LEAVE:return[3,41];case lt.CHANNEL_OPERATOR_UPDATE:return[3,45];case lt.CHANNEL_INVITE:return[3,47];case lt.CHANNEL_DECLINE_INVITE:return[3,49];case lt.TYPING_START:case lt.TYPING_END:return[3,51];case lt.USER_CHANNEL_MUTE:case lt.USER_CHANNEL_UNMUTE:return[3,53];case lt.USER_CHANNEL_BAN:return[3,55];case lt.USER_CHANNEL_UNBAN:return[3,59];case lt.CHANNEL_FREEZE:case lt.CHANNEL_UNFREEZE:return[3,61];case lt.CHANNEL_HIDE:return[3,63];case lt.CHANNEL_UNHIDE:return[3,65];case lt.CHANNEL_DELETED:return[3,67];case lt.CHANNEL_PROP_CHANGED:return[3,69];case lt.CHANNEL_META_DATA_CHANGED:return[3,71];case lt.CHANNEL_META_COUNTERS_CHANGED:return[3,73];case lt.PINNED_MESSAGE_CHANGED:return[3,75]}return[3,77];case 39:return[4,this.getChannel(pe.channelUrl,!0)];case 40:return fe=Sn.sent(),_e=e.as(Ln),ve=_e.memberCount,me=_e.joinedMemberCount,ge=_e.members,ye=!1,ge.forEach((function(e){fe.isExclusive||fe.isSuper||fe.isBroadcast?ye=ye||fe._setLatestMemberCount(ve,me,pe.ts):(e.state=Rt.JOINED,fe.addMember(e,pe.ts),Nn._updateJoinedMemberCount(fe)),e.userId===Nn._sdkState.userId&&(fe.myMemberState=Rt.JOINED)})),this._dispatcher.dispatch(new We({channels:[fe],source:ze.EVENT_CHANNEL_JOINED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){var t,n;try{for(var r=C(ge),s=r.next();!s.done;s=r.next()){var i=s.value;e.onUserJoined&&e.onUserJoined(fe,i)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}fe.isBroadcast&&ye&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([fe])})),[2]}))}))})),[3,77];case 41:return(It=this._leftChannels.get(pe.channelUrl))?(ke=It.channel,[3,44]):[3,42];case 42:return[4,this.getChannel(pe.channelUrl,!0)];case 43:ke=Sn.sent(),Sn.label=44;case 44:return De=ke,Pe=e.as(kn),it=Pe.memberCount,at=Pe.joinedMemberCount,Fe=Pe.member,Re=!1,xe=j.of(this._iid).appInfo,De.isExclusive||De.isSuper||De.isBroadcast?Re=De._setLatestMemberCount(it,at,pe.ts):((null==xe?void 0:xe.enabledChannelMemberShipHistory)?((Oe=De.members.find((function(e){return e.userId===Oe.userId})))&&(Oe.state=Rt.LEFT),De.memberCount=it):De.removeMember(Fe),this._updateJoinedMemberCount(De)),Fe.userId===this._sdkState.userId?(De.myMemberState=Rt.NONE,De.invitedAt=0,De.joinedAt=0,De._updateUnreadCount(0,0),De.isPublic?this._dispatcher.dispatch(new We({channels:[De],source:ze.EVENT_CHANNEL_LEFT})):(this._markAsLeave(De),this._dispatcher.dispatch(new Be({channelUrls:[De.url],source:ze.EVENT_CHANNEL_LEFT})))):this._dispatcher.dispatch(new We({channels:[De],source:ze.EVENT_CHANNEL_LEFT})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserLeft&&e.onUserLeft(De,Fe),De.isBroadcast&&Re&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([De])})),[2]}))}))})),[3,77];case 45:return[4,this.getChannel(pe.channelUrl,!0)];case 46:He=Sn.sent(),Ge=e.as(ht).operators,Ve=Ge.map((function(e){return e.userId}));try{for(qe=C(He.members),je=qe.next();!je.done;je=qe.next())(At=je.value).role=Ve.includes(At.userId)?o.OPERATOR:o.NONE}catch(e){gn={error:e}}finally{try{je&&!je.done&&(yn=qe.return)&&yn.call(qe)}finally{if(gn)throw gn.error}}return He.myRole=Ve.includes(this._sdkState.userId)?o.OPERATOR:o.NONE,this._dispatcher.dispatch(new We({channels:[He],source:ze.EVENT_CHANNEL_OPERATOR_UPDATED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(He,Ge)})),[2]}))}))})),[3,77];case 47:return[4,this.getChannel(pe.channelUrl,!0)];case 48:Qe=Sn.sent(),Ke=e.as(Rn),it=Ke.memberCount,at=Ke.joinedMemberCount,Ye=Ke.inviter,(Je=Ke.invitees).forEach((function(e){return e.state=Rt.INVITED}));try{for(Xe=C(Je),tt=Xe.next();!tt.done;tt=Xe.next())nt=tt.value,Qe.isExclusive||Qe.isSuper||Qe.isBroadcast?Qe._setLatestMemberCount(it,at,pe.ts):Qe.addMember(nt,pe.ts),this._sdkState.userId===nt.userId&&(Qe.hiddenState=rs.UNHIDDEN,Qe.myMemberState!==Rt.JOINED&&(Qe.myMemberState=Rt.INVITED),Qe.invitedAt=pe.ts)}catch(e){Cn={error:e}}finally{try{tt&&!tt.done&&(En=Xe.return)&&En.call(Xe)}finally{if(Cn)throw Cn.error}}return this._dispatcher.dispatch(new We({channels:[Qe],source:ze.EVENT_CHANNEL_INVITED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserReceivedInvitation&&e.onUserReceivedInvitation(Qe,Ye,Je)})),[2]}))}))})),[3,77];case 49:return[4,this.getChannel(pe.channelUrl,!0)];case 50:return rt=Sn.sent(),st=e.as(On),it=st.memberCount,at=st.joinedMemberCount,ot=st.inviter,ut=st.invitee,rt.isExclusive||rt.isSuper||rt.isBroadcast?rt._setLatestMemberCount(it,at,pe.ts):rt.removeMember(ut),this._sdkState.userId===ut.userId?(rt.invitedAt=0,rt.myMemberState=Rt.NONE,rt.isPublic?this._dispatcher.dispatch(new We({channels:[rt],source:ze.EVENT_CHANNEL_DECLINED_INVITE})):this._dispatcher.dispatch(new Be({channelUrls:[rt.url],source:ze.EVENT_CHANNEL_DECLINED_INVITE}))):this._dispatcher.dispatch(new We({channels:[rt],source:ze.EVENT_CHANNEL_DECLINED_INVITE})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserDeclinedInvitation&&e.onUserDeclinedInvitation(rt,ot,ut)})),[2]}))}))})),[3,77];case 51:return[4,this.getChannel(pe.channelUrl,!0)];case 52:return gt=Sn.sent(),yt=pe.category===lt.TYPING_START,Et=e.as(yt?Yn:Xn).user,gt._updateTypingStatus(Et,yt?pe.ts:0),this._dispatcher.dispatch(new We({channels:[gt],source:ze.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onTypingStatusUpdated&&e.onTypingStatusUpdated(gt)})),[2]}))}))})),[3,77];case 53:return[4,this.getChannel(pe.channelUrl,!0)];case 54:bt=Sn.sent(),Mt=pe.category===lt.USER_CHANNEL_MUTE,(Nt=e.as(Mt?Se:Ue).user).userId===this._sdkState.userId&&(bt.myMutedState=Mt?ns.MUTED:ns.UNMUTED,bt._myMutedRemainingTime=Nt.restrictionInfo.remainingDuration);try{for(Ut=C(bt.members),Tt=Ut.next();!Tt.done;Tt=Ut.next())if((At=Tt.value).userId===Nt.userId){At.isMuted=Mt;break}}catch(e){bn={error:e}}finally{try{Tt&&!Tt.done&&(Mn=Ut.return)&&Mn.call(Ut)}finally{if(bn)throw bn.error}}return this._dispatcher.dispatch(new We({channels:[bt],source:Mt?ze.EVENT_CHANNEL_MUTED:ze.EVENT_CHANNEL_UNMUTED,data:Nt.userId})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Mt?e.onUserMuted&&e.onUserMuted(bt,Nt):e.onUserUnmuted&&e.onUserUnmuted(bt,Nt)})),[2]}))}))})),[3,77];case 55:return(It=this._leftChannels.get(pe.channelUrl))?(Lt=It.channel,[3,58]):[3,56];case 56:return[4,this.getChannel(pe.channelUrl,!0)];case 57:Lt=Sn.sent(),Sn.label=58;case 58:return wt=Lt,this._markAsLeave(wt),Dt=e.as(Ne).user,Dt.userId===this._sdkState.userId&&this._dispatcher.dispatch(new Be({channelUrls:[wt.url],source:ze.EVENT_CHANNEL_BANNED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserBanned&&e.onUserBanned(wt,Dt)})),[2]}))}))})),[3,77];case 59:return[4,this.getChannel(pe.channelUrl,!0)];case 60:return kt=Sn.sent(),Pt=e.as(Me).user,Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserUnbanned&&e.onUserUnbanned(kt,Pt)})),[2]}))}))})),[3,77];case 61:return[4,this.getChannel(pe.channelUrl,!0)];case 62:return Ft=Sn.sent(),xt=e.as(be).freeze,Ft.isFrozen=xt,this._dispatcher.dispatch(new We({channels:[Ft],source:xt?ze.EVENT_CHANNEL_FROZEN:ze.EVENT_CHANNEL_UNFROZEN})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){xt?e.onChannelFrozen&&e.onChannelFrozen(Ft):e.onChannelUnfrozen&&e.onChannelUnfrozen(Ft)})),[2]}))}))})),[3,77];case 63:return[4,this.getChannel(pe.channelUrl,!0)];case 64:return Ot=Sn.sent(),Ht=e.as(Qn),Gt=Ht.allowAutoUnhide,Vt=Ht.hidePreviousMessages,qt=Ht.messageOffsetTimestamp,null!==Gt&&(Ot.hiddenState=Gt?rs.HIDDEN_ALLOW_AUTO_UNHIDE:rs.HIDDEN_PREVENT_AUTO_UNHIDE),null!==Vt&&Vt&&Ot._updateUnreadCount(0,0),null!==qt&&(Ot.messageOffsetTimestamp=qt),this._dispatcher.dispatch(new We({channels:[Ot],source:ze.EVENT_CHANNEL_HIDDEN})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelHidden&&e.onChannelHidden(Ot)})),[2]}))}))})),[3,77];case 65:return[4,this.getChannel(pe.channelUrl,!0)];case 66:return(Bt=Sn.sent()).hiddenState=rs.UNHIDDEN,this._dispatcher.dispatch(new We({channels:[Bt],source:ze.EVENT_CHANNEL_UNHIDDEN})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(Bt)})),[2]}))}))})),[3,77];case 67:return[4,this.getChannel(pe.channelUrl,!0)];case 68:return Wt=Sn.sent(),this._dispatcher.dispatch(new Be({channelUrls:[pe.channelUrl],source:ze.EVENT_CHANNEL_DELETED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(Wt.url,Wt.channelType)})),[2]}))}))})),[3,77];case 69:return[4,this.getChannelWithoutCache(pe.channelUrl,!0)];case 70:return zt=Sn.sent(),this._dispatcher.dispatch(new We({channels:[zt],source:ze.EVENT_CHANNEL_UPDATED})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(zt)})),[2]}))}))})),[3,77];case 71:return[4,this.getChannel(pe.channelUrl,!0)];case 72:return jt=Sn.sent(),Qt=e.as(Ee),Kt=Qt.created,Yt=Qt.updated,Jt=Qt.deleted,Kt&&jt._upsertCachedMetaData(Kt,pe.ts),Yt&&jt._upsertCachedMetaData(Yt,pe.ts),Jt&&jt._removeFromCachedMetaData(Jt,pe.ts),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Kt&&e.onMetaDataCreated&&e.onMetaDataCreated(jt,Kt),Yt&&e.onMetaDataUpdated&&e.onMetaDataUpdated(jt,Yt),Jt&&e.onMetaDataDeleted&&e.onMetaDataDeleted(jt,Jt)})),[2]}))}))})),[3,77];case 73:return[4,this.getChannel(pe.channelUrl,!0)];case 74:return Xt=Sn.sent(),Zt=e.as(Ce),$t=Zt.created,en=Zt.updated,tn=Zt.deleted,Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){$t&&e.onMetaCounterCreated&&e.onMetaCounterCreated(Xt,$t),en&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(Xt,en),tn&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(Xt,tn)})),[2]}))}))})),[3,77];case 75:return[4,this.getChannel(pe.channelUrl,!0)];case 76:return nn=Sn.sent(),rn=e.as(tr),sn=rn.pinnedMessageIds,an=rn.latestPinnedMessage,(on=rn.ts)>nn._pinnedMessagesUpdatedAt&&(nn.pinnedMessageIds=sn,nn.lastPinnedMessage=an,nn._pinnedMessagesUpdatedAt=on,this._dispatcher.dispatch(new We({channels:[nn],source:ze.EVENT_PINNED_MESSAGE_UPDATED})),Y((function(){return g(Nn,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){try{for(e=C(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(nn)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Y((function(){return g(Nn,void 0,void 0,(function(){return y(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(nn)})),[2]}))}))}))),[3,77];case 77:return[3,79];case 78:switch((un=e.as(Ze).event).category){case $e.USER_BLOCK:cn=et.getDataAsUserBlockEvent(this._iid,un),hn=cn.blocker,dn=cn.blockee,this._groupChannelCache.block(hn.userId,dn.userId);break;case $e.USER_UNBLOCK:ln=et.getDataAsUserBlockEvent(this._iid,un),hn=ln.blocker,dn=ln.blockee,this._groupChannelCache.unblock(hn.userId,dn.userId)}return[3,79];case 79:return[3,81];case 80:if(pn=Sn.sent(),K(pn))throw pn;return[3,81];case 81:return[2]}}))}))},e.prototype._markAsLeave=function(e){var t,n=this,r=null!==(t=this._leftChannels.get(e.url))&&void 0!==t?t:{channel:e,ref:0};r.ref++,this._leftChannels.set(e.url,r),setTimeout((function(){r.ref--,0===r.ref&&n._leftChannels.delete(e.url)}),1e4)},e.prototype.addHandler=function(e,t){this._groupChannelHandlers.set(e,t)},e.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},e.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},e.prototype.subscribeGroupChannelEvent=function(e,t){this._groupChannelBroadcast.subscribe(e,t)},e.prototype.unsubscribeGroupChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},e.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t)},e.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},e.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter((function(e){return e.state===Rt.JOINED})).length},e.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),g(this,void 0,void 0,(function(){var n;return y(this,(function(r){switch(r.label){case 0:f(b("string",e)).throw(_.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,t)];case 5:return[2,r.sent()]}}))}))},e.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),g(this,void 0,void 0,(function(){var n,r,s,i,a;return y(this,(function(o){switch(o.label){case 0:return f(b("string",e)).throw(_.invalidParameters),n=new ln({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:switch(r=o.sent(),s=r.as(hn).channel,i=s.unreadMessageCount,a=s.unreadMentionCount,s.myCountPreference){case ts.UNREAD_MESSAGE_COUNT_ONLY:a=0;break;case ts.UNREAD_MENTION_COUNT_ONLY:i=0;break;case ts.OFF:i=0,a=0}return s._updateUnreadCount(i,a),[4,this.upsertChannelsToCache([s])];case 2:return[2,o.sent()[0]]}}))}))},e.prototype.refreshChannel=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=ze.REFRESH_CHANNEL),g(this,void 0,void 0,(function(){var r,s,i,a,o;return y(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),r=new ln({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(r)];case 1:return s=u.sent(),(i=s.as(hn).channel).myMemberState!==Rt.NONE?[3,2]:(this._dispatcher.dispatch(new Be({channelUrls:[i.url],source:n})),[3,4]);case 2:return[4,this.upsertChannelsToCache([i])];case 3:a=u.sent(),this._dispatcher.dispatch(new We({channels:a,source:n})),u.label=4;case 4:return[3,6];case 5:return(o=u.sent()).code!==X.NON_AUTHORIZED&&o.code!==X.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new Be({channelUrls:[e],source:n})),[3,6];case 6:return[2]}}))}))},e.prototype.getMyGroupChannels=function(e,t,n,r){return void 0===r&&(r=ze.REQUEST_CHANNEL),g(this,void 0,void 0,(function(){var s,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:return s=new pn(i(i({},t),{userId:this._sdkState.userId,token:e,limit:n})),[4,this._requestQueue.send(s)];case 1:return a=l.sent(),o=a.as(fn),u=o.channels,c=o.token,this._dispatcher.dispatch(new We({channels:u,source:r})),[2,{channels:u,token:c}]}}))}))},e.prototype.getMessageFromCache=function(e){var t;return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},e.prototype._getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return g(this,void 0,void 0,(function(){return y(this,(function(r){switch(r.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,filter:n,exactMatch:!0})];case 1:return[2,r.sent()]}}))}))},e.prototype.getMessagesFromCache=function(e,t,n,r,s,i){return void 0===s&&(s=De),void 0===i&&(i=!0),g(this,void 0,void 0,(function(){return y(this,(function(a){switch(a.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:s,filter:r,backward:"next"===n,inclusive:i})];case 1:return[2,a.sent()]}}))}))},e.prototype.getPollMessagesFromCache=function(e,t,n,r){return void 0===r&&(r=De),g(this,void 0,void 0,(function(){return y(this,(function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:r,filter:n,backward:!1,isPollOnly:!0})];case 1:return[2,s.sent()]}}))}))},e.prototype.getUnsentMessagesFromCache=function(e,t){return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.removeFailedMessageFromCache=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2]}}))}))},e.prototype.getCachedMessageCountBetween=function(e,t,n,r){return g(this,void 0,void 0,(function(){return y(this,(function(s){switch(s.label){case 0:return[4,this._messageCache.countBetween(e,t,new er({top:n,bottom:r}))];case 1:return[2,s.sent()]}}))}))},e.prototype.getMyGroupChannelChangeLogs=function(e,t,n){return void 0===n&&(n=ze.REQUEST_CHANNEL_CHANGELOGS),g(this,void 0,void 0,(function(){var r,a,o,u,c,l,h;return y(this,(function(d){switch(d.label){case 0:return r=i(i({},Zt),t),f((b("string",e)||b("number",e))&&$t(r)).throw(_.invalidParameters),a=new un(s({userId:this._sdkState.userId,ts:"number"==typeof e?e:null,token:"string"==typeof e?e:null,filter:r})),[4,this._requestQueue.send(a)];case 1:return o=d.sent(),u=o.as(cn),c=u.updatedChannels,l=u.deletedChannelUrls,h=u.hasMore,c.length>0&&this._dispatcher.dispatch(new We({channels:c,source:n})),l.length>0&&this._dispatcher.dispatch(new Be({channelUrls:l,source:n})),[2,{updatedChannels:c,deletedChannelUrls:l,hasMore:h,token:u.token}]}}))}))},e.prototype.getGroupChannelCount=function(e){return g(this,void 0,void 0,(function(){var t,n,r;return y(this,(function(s){switch(s.label){case 0:return t=i(i({},en),e),f(tn(t)).throw(_.invalidParameters),n=new _n({userId:this._sdkState.userId,filter:t}),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),[2,r.as(vn).groupChannelCount]}}))}))},e.prototype.getUnreadItemCount=function(e){return g(this,void 0,void 0,(function(){var t,n,s,a,o,u,c,l,h,d,p,v,m,g,C,b;return y(this,(function(y){switch(y.label){case 0:return t=i(i({},nn),e),f(function(e){return E(Qt,e.keys)}(t)).throw(_.invalidParameters),n=j.of(this._iid),s=n.sdkState,a=n.requestQueue,o=new mn({userId:s.userId,filter:t}),[4,a.send(o)];case 1:return u=y.sent(),c=u.as(gn),l=c.groupChannelUnreadMentionCount,h=c.groupChannelUnreadMessageCount,d=c.groupChannelInvitationCount,p=c.superGroupChannelUnreadMentionCount,v=c.superGroupChannelUnreadMessageCount,m=c.superGroupChannelInvitationCount,g=c.nonSuperGroupChannelUnreadMentionCount,C=c.nonSuperGroupChannelUnreadMessageCount,b=c.nonSuperGroupChannelInvitationCount,[2,r({groupChannelUnreadMentionCount:l,groupChannelUnreadMessageCount:h,groupChannelInvitationCount:d,superGroupChannelUnreadMentionCount:p,superGroupChannelUnreadMessageCount:v,superGroupChannelInvitationCount:m,nonSuperGroupChannelUnreadMentionCount:g,nonSuperGroupChannelUnreadMessageCount:C,nonSuperGroupChannelInvitationCount:b})]}}))}))},e.prototype.getTotalUnreadChannelCount=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){switch(i.label){case 0:return e=j.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new yn({userId:t.userId}),[4,n.send(r)];case 1:return s=i.sent(),[2,s.as(Cn).unreadCount]}}))}))},e.prototype.getTotalUnreadMessageCount=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,o,u;return y(this,(function(c){switch(c.label){case 0:return t=i(i({},rn),e),f(function(e){return E("string",e.channelCustomTypesFilter,!0)&&a(Ht,e.superChannelFilter)}(t)).throw(_.invalidParameters),n=j.of(this._iid),r=n.sdkState,s=n.requestQueue,o=new En({userId:r.userId,filter:t}),[4,s.send(o)];case 1:return u=c.sent(),[2,u.as(bn).unreadCount]}}))}))},e.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){var t,n,r,s;return y(this,(function(o){switch(o.label){case 0:return t=i(i({},sn),e),f(function(e){return b("string",e.channelUrl,!0)&&E(yt,e.scheduledStatus,!0)&&a(N,e.messageTypeFilter)}(t)).throw(_.invalidParameters),n=j.of(this._iid).requestQueue,r=new Mn(t),[4,n.send(r)];case 1:return s=o.sent(),[2,s.as(Nn).count]}}))}))},e.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=j.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},e.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,t=j.of(this._iid).subscribedUnreadMessageCount;for(var n in t.customTypes)e+=t.customTypes[n];return e},e.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var t;return null!==(t=j.of(this._iid).subscribedUnreadMessageCount.customTypes[e])&&void 0!==t?t:0},e.prototype.createChannel=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s;return y(this,(function(a){switch(a.label){case 0:return t=i(i({},Jt),e),f(Xt(t)).throw(_.invalidParameters),t.isPublic||(t.accessCode=void 0),n=new Un(i({userId:this._sdkState.userId},t)),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),s=r.as(Tn).channel,[4,this.upsertChannelsToCache([s])];case 2:return a.sent(),[2,s]}}))}))},e.prototype.markAsReadAll=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i,a,o;return y(this,(function(u){switch(u.label){case 0:return e=Date.now(),f(e-this._markAsReadAllLastSentAt>=1e3).throw(_.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,t=new An({userId:this._sdkState.userId}),[4,this._requestQueue.send(t)];case 1:u.sent(),n=this._groupChannelCache.channels;try{for(r=C(n),s=r.next();!s.done;s=r.next())(i=s.value)._updateUnreadMemberState(this._sdkState.userId,e),i._updateUnreadCount(0,0)}catch(e){a={error:e}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(a)throw a.error}}return n.length>0?[4,this.upsertChannelsToCache(n)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},e.prototype.markAsReadWithChannelUrls=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:return t=Date.now(),f(E("string",e)&&t-this._markAsReadAllLastSentAt>=1e3).throw(_.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,n=new An({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(n)];case 1:l.sent(),r=this._groupChannelCache.channels,s=[];try{for(i=C(r),a=i.next();!a.done;a=i.next())o=a.value,e.includes(o.url)&&(o._updateUnreadMemberState(this._sdkState.userId,t),o._updateUnreadCount(0,0),s.push(o))}catch(e){u={error:e}}finally{try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}}return s.length>0?[4,this.upsertChannelsToCache(s)]:[3,3];case 2:l.sent(),l.label=3;case 3:return[2]}}))}))},e.prototype.markAsDelivered=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},e}();!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(qn||(qn={}));var sr,ir=function(t){function n(e,n,r,s){var i=t.call(this)||this;return i._state=qn.IDLE,i._retryCount=0,i._retryLimit=3,i.priority=0,i._worker=n,i}return e(n,t),Object.defineProperty(n.prototype,"isIdle",{get:function(){return this._state===qn.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRunning",{get:function(){return this._state===qn.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isDone",{get:function(){return this._state===qn.END},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),n.prototype._run=function(e){return g(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:if(!this.isRunning)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return t=r.sent(),this._retryCount=0,this.dispatch("progress",t),t.hasNext?this._run(t.nextToken):this.end(),[3,4];case 3:return n=r.sent(),this.dispatch("error",n),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}}))}))},n.prototype.start=function(e){this.isIdle&&(this._state=qn.RUNNING,this._run(e))},n.prototype.stop=function(){this._state=qn.IDLE,this.dispatch("stop")},n.prototype.end=function(){this._state=qn.END,this.dispatch("end")},n}($),ar=function(e){this.source=e},or=function(e){this.source=e},ur={},cr=function(){function e(e){var t=e._iid,n=e.channel,r=e.limit,s=void 0===r?100:r,i=this;this.ref=0,this._iid=t,this._channel=n,this._limit=s,this._prevSyncLoopCount=0,this._nextSyncLoopCount=0;var a,o,u=j.of(this._iid),c=u.sdkState,l=u.dispatcher,h=u.logger;this._metadataKey=(a=c.userId,o=n.url,"sendbird:".concat(a,"@groupchannel/").concat(o,"/message/sync.meta"));var d=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/sync")}(c.userId,n.url);this._prevSync=new ir(d,(function(e){return g(i,void 0,void 0,(function(){var t,n,r,s,i,a,o,u,c,l;return y(this,(function(d){switch(d.label){case 0:return t={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata(e)];case 1:if(d.sent(),h.debug("message background prev sync from",null===(a=this._metadata)||void 0===a?void 0:a.range.top),null===(o=this._metadata)||void 0===o?void 0:o.previousComplete)return[3,9];d.label=2;case 2:return d.trys.push([2,5,,8]),[4,Ut.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(c=null===(u=this._metadata)||void 0===u?void 0:u.range)||void 0===c?void 0:c.top)?this._metadata.range.top:e,{prevResultSize:this._limit,nextResultSize:0,replyType:ne.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},J.SYNC_MESSAGE_BACKGROUND)];case 3:return(n=d.sent()).length>0&&(r=n.map((function(e){return e.createdAt})),(null===(l=this._metadata)||void 0===l?void 0:(i=l.range).intersect.apply(i,v([],m(r),!1)))?this.extendRange(n):this._metadata={range:new er({top:Math.min.apply(Math,v([],m(r),!1)),bottom:Math.max.apply(Math,v([],m(r),!1))}),previousComplete:!1}),t.hasNext=n.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.top,this._metadata.previousComplete=n.length<this._limit),h.debug("message background prev sync progress",t),[4,this.saveMetadata()];case 4:return d.sent(),[3,8];case 5:return s=d.sent(),h.debug("message background prev sync error",s),s instanceof _&&s.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:d.sent(),d.label=7;case 7:throw s;case 8:return[3,10];case 9:t.hasNext=!1,d.label=10;case 10:return[2,t]}}))}))})),this._nextSync=new ir(d,(function(e){return g(i,void 0,void 0,(function(){var t,n,r,s,i,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:return t={hasNext:!0,nextToken:0},this._nextSyncLoopCount++,[4,this.loadMetadata(e)];case 1:l.sent(),h.debug("message background next sync from",null===(a=this._metadata)||void 0===a?void 0:a.range.bottom),l.label=2;case 2:return l.trys.push([2,5,,6]),[4,Ut.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(u=null===(o=this._metadata)||void 0===o?void 0:o.range)||void 0===u?void 0:u.bottom)?this._metadata.range.bottom:e,{prevResultSize:0,nextResultSize:this._limit,replyType:ne.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},J.SYNC_MESSAGE_BACKGROUND)];case 3:return(n=l.sent()).length>0&&(r=n.map((function(e){return e.createdAt})),(null===(c=this._metadata)||void 0===c?void 0:(i=c.range).intersect.apply(i,v([],m(r),!1)))?this.extendRange(n):this._metadata={range:new er({top:Math.min.apply(Math,v([],m(r),!1)),bottom:Math.max.apply(Math,v([],m(r),!1))}),previousComplete:!1}),t.hasNext=n.length>=this._limit&&this._nextSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.bottom),h.debug("message background next sync progress",t),[4,this.saveMetadata()];case 4:return l.sent(),[3,6];case 5:throw s=l.sent(),h.debug("message background next sync error",s),s;case 6:return[2,t]}}))}))})),this._connectionEventContext=l.on((function(e){if(e instanceof ee)if(e.stateType===te.CONNECTED)i.resume();else i.pause()}))}return e.of=function(t,n){return ur[t]||(ur[t]={}),ur[t][n.url]||(ur[t][n.url]=new e({_iid:t,channel:n})),ur[t][n.url].ref++,ur[t][n.url]},e.clear=function(e,t){ur[e]&&ur[e][t]&&(ur[e][t].close(),delete ur[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new er({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(e){var t;return null===(t=this.range)||void 0===t?void 0:t.includes.apply(t,v([],m(e.map((function(e){return e.createdAt}))),!1))},e.prototype.extendRange=function(e){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,v([],m(e.map((function(e){return e.createdAt}))),!1))},e.prototype.loadMetadata=function(e){return g(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return this._metadata?[3,2]:[4,j.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:(t=n.sent())?t.range.bottom<e?this._metadata={range:new er({}),previousComplete:!1}:this._metadata={range:new er(t.range),previousComplete:t.previousComplete}:this._metadata={range:new er({}),previousComplete:!1},n.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this._metadata?[4,j.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,j.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(e){var t,n,r,s;void 0===e&&(e=Date.now());var i=j.of(this._iid),a=i.logger;i.connectionManager.isConnected&&(a.debug("message background sync resume()"),this._prevSyncLoopCount=this._nextSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start(null!==(n=null===(t=this._metadata)||void 0===t?void 0:t.range.top)&&void 0!==n?n:e),this._nextSync.start(null!==(s=null===(r=this._metadata)||void 0===r?void 0:r.range.bottom)&&void 0!==s?s:e))},e.prototype.pause=function(){j.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete ur[this._iid][this._channel.url])},e}(),lr={},hr=function(){function e(e){var t=e._iid,n=e.channel,r=this;this.ref=0,this._iid=t,this._channel=n;var s,i,a=j.of(this._iid),o=a.logger,u=a.sdkState,c=a.dispatcher;this._metadataKey=(s=u.userId,i=n.url,"sendbird:".concat(s,"@groupchannel/").concat(i,"/message/changelogs.meta"));var l=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/changelogs")}(u.userId,this._channel.url);this._sync=new ir(l,(function(){return g(r,void 0,void 0,(function(){var e,t,n,r,s,i,a,u;return y(this,(function(c){switch(c.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:c.sent(),o.debug("message changelog sync from",null===(u=this._metadata)||void 0===u?void 0:u.token),c.label=2;case 2:return c.trys.push([2,5,,8]),[4,Ut.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,{replyType:ne.ALL,includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0},J.SYNC_MESSAGE_CHANGELOGS)];case 3:return t=c.sent(),n=t.updatedMessages,r=t.deletedMessageIds,s=t.hasMore,i=t.token,e.hasNext=s,e.nextToken=i,(n.length>0||r.length>0)&&this._metadata&&(this._metadata.token=i),o.debug("message changelog sync progress",e),[4,this.saveMetadata()];case 4:return c.sent(),[3,8];case 5:return a=c.sent(),o.debug("message changelog sync error",a),a instanceof _&&a.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:c.sent(),c.label=7;case 7:throw a;case 8:return[2,e]}}))}))})),this._connectionEventContext=c.on((function(e){if(e instanceof ee)if(e.stateType===te.CONNECTED)r.resume();else r.pause()}))}return e.of=function(t,n){return lr[t]||(lr[t]={}),lr[t][n.url]||(lr[t][n.url]=new e({_iid:t,channel:n})),lr[t][n.url].ref++,lr[t][n.url]},e.clear=function(e,t){lr[e]&&lr[e][t]&&(lr[e][t].close(),delete lr[e])},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:return this._metadata?[3,2]:(e=j.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=s.sent(),this._metadata={token:r?r.token:n},s.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this._metadata?[4,j.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,j.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e=j.of(this._iid),t=e.logger;e.connectionManager.isConnected&&(t.debug("message changelog sync resume()"),this._sync.start(0))},e.prototype.pause=function(){var e=j.of(this._iid),t=e.logger;e.connectionManager,t.debug("message changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete lr[this._iid][this._channel.url])},e}(),dr={},pr=function(){function e(e){var t=e._iid,n=e.channel,r=e.hasPollMessage,s=this;this.ref=0,this._iid=t,this._channel=n;var i,a,o=j.of(this._iid),u=o.logger,c=o.sdkState,l=o.dispatcher;this._metadataKey=(i=c.userId,a=n.url,"sendbird:".concat(i,"@groupchannel/").concat(a,"/poll/changelogs.meta"));var h=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/poll/changelogs")}(c.userId,this._channel.url);this._sync=new ir(h,(function(){return g(s,void 0,void 0,(function(){var e,t,n,s,i,a,o,c;return y(this,(function(l){switch(l.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return l.sent(),u.debug("poll changelog sync from",null===(c=this._metadata)||void 0===c?void 0:c.token),(t=!this._metadata||!this._metadata.token)?[4,r()]:[3,3];case 2:t=!l.sent(),l.label=3;case 3:if(t)return[2,{hasNext:!1,nextToken:0}];this._metadata||(n=j.of(this._iid).firstConnectedAt,this._metadata={token:n}),l.label=4;case 4:return l.trys.push([4,7,,10]),[4,Ft.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return s=l.sent(),i=s.hasMore,a=s.token,e.hasNext=i,e.nextToken=a,this._metadata.token=a,u.debug("poll changelog sync progress",e),[4,this.saveMetadata()];case 6:return l.sent(),[3,10];case 7:return o=l.sent(),u.debug("poll changelog sync error",o),o instanceof _&&o.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:l.sent(),l.label=9;case 9:throw o;case 10:return[2,e]}}))}))})),this._connectionEventContext=l.on((function(e){if(e instanceof ee)if(e.stateType===te.CONNECTED)s.resume();else s.pause()}))}return e.of=function(t,n,r){return dr[t]||(dr[t]={}),dr[t][n.url]||(dr[t][n.url]=new e({_iid:t,channel:n,hasPollMessage:r})),dr[t][n.url].ref++,dr[t][n.url]},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,j.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata=e?{token:e.token}:void 0,t.label=2;case 2:return[2]}}))}))},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this._metadata?[4,j.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,j.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){j.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},e.prototype.pause=function(){j.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete dr[this._iid][this._channel.url])},e}(),fr=function(t){function n(e){var n,s,i,a,o,u,c=this;return(c=t.call(this)||this).method=D.GET,c.path="".concat(re(e.channelType),"/").concat(e.channelUrl,"/messages_gap"),c.params=r({prev_start_ts:e.prevStart,prev_end_ts:e.prevEnd,prev_cache_count:e.prevCount,next_start_ts:e.nextStart,next_end_ts:e.nextEnd,next_cache_count:e.nextCount,huge_gap_threshold:null!==(n=e.threshold)&&void 0!==n?n:null,reverse:!0,custom_types:null!==(s=e.customTypes)&&void 0!==s?s:["*"],message_type:null!==(i=e.messageType)&&void 0!==i?i:null,include_reactions:null===(a=e.includeReactions)||void 0===a||a,with_sorted_meta_array:null===(o=e.includeMetaArray)||void 0===o||o,show_subchannel_messages_only:null!==(u=e.showSubchannelMessagesOnly)&&void 0!==u&&u,include_poll_details:!0,checking_continuous_messages:e.checkingContinuousMessages}),c}return e(n,t),n}(F),_r=function(t){function n(e,n){var r,s,i,a,o,u,c=this;return(c=t.call(this,e,n)||this).isHugeGap=n.is_huge_gap,c.prevMessages=(null!==(r=n.prev_messages)&&void 0!==r?r:[]).map((function(t){return bt(e,t)})),c.prevHasMore=null!==(s=n.prev_hasmore)&&void 0!==s&&s,c.isContinuousPrevMessages=null!==(i=n.is_continuous_prev_messages)&&void 0!==i&&i,c.nextMessages=(null!==(a=n.next_messages)&&void 0!==a?a:[]).map((function(t){return bt(e,t)})),c.nextHasmore=null!==(o=n.next_hasmore)&&void 0!==o&&o,c.isContinuousNextMessages=null!==(u=n.is_continuous_next_messages)&&void 0!==u&&u,c}return e(n,t),n}(R),vr=function(e,t){return e.findIndex((function(e){return e.isIdentical(t)}))},mr=function(e,t,n){if(e.length>0){for(var r=vr(e,t),s=0,i=e.length-1,a=Math.floor((s+i)/2);s<i;){var o=gr(e[a],t,n);if(o>0)i=a,a=Math.floor((s+i)/2);else{if(!(o<0))return{place:a,oldPosition:r};s=a+1,a=Math.floor((s+i)/2)}}return{place:gr(e[a],t,n)>=0?a:a+1,oldPosition:r}}return{place:e.length,oldPosition:-1}},gr=function(e,t,n){switch(n){case Ge.LATEST_LAST_MESSAGE:return e.lastMessage&&t.lastMessage?t.lastMessage.createdAt-e.lastMessage.createdAt:e.lastMessage?-1:t.lastMessage?1:t.createdAt-e.createdAt;case Ge.CHRONOLOGICAL:return t.createdAt-e.createdAt;case Ge.CHANNEL_NAME_ALPHABETICAL:var r=e.name.localeCompare(t.name);return 0===r?e.createdAt-t.createdAt:r;default:return 0}},yr=function(e,t){return t instanceof Ct?e.findIndex((function(e){return e instanceof Ct&&t.isIdentical(e)})):e.findIndex((function(e){return e.isIdentical(t)}))},Cr=function(e,t){return e.findIndex((function(e){return e.messageId===t}))},Er=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,s=Math.floor((n+r)/2);n<r;){var i=e[s].createdAt-t.createdAt;if(i>0)r=s,s=Math.floor((n+r)/2);else{if(!(i<0))return s;n=s+1,s=Math.floor((n+r)/2)}}return e[s].createdAt>t.createdAt?s:s+1}return e.length},br=6e5;!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"}(sr||(sr={}));var Mr,Nr,Sr,Ur=function(){function e(){}return e.prototype._invokeResponse=function(e,t,n){var r=this;Y((function(){return g(r,void 0,void 0,(function(){return y(this,(function(r){switch(e){case"local":this._onCacheResult(t,n);break;case"remote":this._onApiResult(t,n)}return[2]}))}))}))},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),Tr=function(){function e(e,t){var n=t.channel,r=t.filter,s=t.startingPoint,i=t.limit,a=this;this._messages=[],this._unsentMessages=[],this._iid=e,this._key="mc-".concat(oe()),this._isDisposed=!1,this.filter=null!=r?r:new Je,this._channel=n,this._syncRange=new er({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint="number"==typeof s?s:Date.now()+br,this._limit=i||De;var o=rr.of(this._iid);o.subscribeGroupChannelEvent(this._key,{onUpdate:function(e,t,n){var r=vr(e,a._channel);if(r>=0){switch(a._channel=e[r],t){case ze.EVENT_CHANNEL_UPDATED:var s=!1;for(var i in a._messages){if(a._messages[i].createdAt>=a._channel.messageOffsetTimestamp){s=!0;var o=parseInt(i);if(o>0){var u=a._messages.splice(0,o);a._removeMessagesFromView(u.map((function(e){return e.messageId})),J.EVENT_MESSAGE_OFFSET_UPDATED)}break}}!s&&a._messages.length>0&&a._removeMessagesFromView(a._messages.map((function(e){return e.messageId})),J.EVENT_MESSAGE_OFFSET_UPDATED);break;case ze.EVENT_CHANNEL_UNMUTED:var c=n;j.of(a._iid).sdkState.userId===c&&a._clearCheckMyMutedTimer();break;case ze.EVENT_CHANNEL_MUTED:var l=n;j.of(a._iid).sdkState.userId===l&&-1!==a.channel._myMutedRemainingTime&&a._startCheckMyMutedTimer(a.channel._myMutedRemainingTime);break;case ze.EVENT_CHANNEL_LEFT:a.channel.isPublic&&a._clearCheckMyMutedTimer()}Y((function(){return g(a,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new ar(t),tt(t)&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelUpdated)&&this._handler.onChannelUpdated(e,this.channel),[2]}))}))}))}},onRemove:function(e,t){e.indexOf(a.channel.url)>=0&&(a._clearCheckMyMutedTimer(),Y((function(){return g(a,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new ar(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelDeleted)&&this._handler.onChannelDeleted(e,this.channel.url),[2]}))}))})))}}),o.subscribeMessageEvent(this._key,{onUpdate:function(e,t){var n,r,s=[],i=[];try{for(var o=C(e),u=o.next();!u.done;u=o.next()){var c=u.value;c.channelUrl===a._channel.url&&(a.filter.match(c)?s.push(c):i.push(c.messageId))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}if(se(t)){if(s.length>0)switch(t){case J.LOCAL_MESSAGE_CANCELED:case J.LOCAL_MESSAGE_RESEND_STARTED:case J.EVENT_MESSAGE_SENT_FAILED:case J.EVENT_MESSAGE_SENT_SUCCESS:case J.EVENT_MESSAGE_UPDATED:case J.EVENT_MESSAGE_THREADINFO_UPDATED:case J.EVENT_MESSAGE_REACTION_UPDATED:case J.SYNC_MESSAGE_CHANGELOGS:a._updateMessagesToView(s,t);break;case J.EVENT_MESSAGE_SENT_PENDING:a._addMessagesToView(s,t);break;case J.EVENT_MESSAGE_RECEIVED:a.hasNext||a._addMessagesToView(s,t);break;case J.SYNC_MESSAGE_FILL:a._addMessagesToView(s,t)}i.length>0&&a._removeMessagesFromView(i,t)}},onRemove:function(e,t){a._removeMessagesFromView(e,t)},onRemoveUnsent:function(e,t){a._removeUnsentMessageFromView(e,t)},onPollChangeLogUpdate:function(e,t){a._updatePollsToView(e,t)},onPollUpdate:function(e,t){a._applyPollUpdateEventToView(e,t)},onPollVote:function(e,t){a._applyPollVoteEventToView(e,t)}});var u=j.of(this._iid),c=u.cacheContext,l=u.dispatcher,h=u.logger;this._channel._updateMessageCollectionLastAccessedAt(),l.dispatch(new We({channels:[this._channel],source:ze.CHANNEL_LASTACCESSEDAT_UPDATED})),!this._channel.isSuper&&c.localCacheEnabled&&(this._backgroundSync=cr.of(this._iid,this._channel),this._backgroundSync.resume(this._startingPoint)),this._changelogSync=hr.of(this._iid,this._channel),this._changelogSync.resume(),this._pollChangelogSync=pr.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new ir(this._key,(function(e){return g(a,void 0,void 0,(function(){var t,n,r,s,i;return y(this,(function(a){switch(a.label){case 0:return[4,this._getRemoteMessages(e,{prevLimit:this._limit,source:J.SYNC_MESSAGE_FILL,checkingContinuousMessages:c.localCacheEnabled})];case 1:return t=a.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(s=Math.min.apply(Math,v([],m(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(s),r&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(s)),[2,{hasNext:n.length>=this._limit&&this.viewTop<s,nextToken:this._syncRange.top}]):[2,{hasNext:!1,nextToken:0}]}}))}))})),this._nextFill=new ir(this._key,(function(e){return g(a,void 0,void 0,(function(){var t,n,r,s,i;return y(this,(function(a){switch(a.label){case 0:return[4,this._getRemoteMessages(e,{nextLimit:this._limit,source:J.SYNC_MESSAGE_FILL,checkingContinuousMessages:c.localCacheEnabled})];case 1:return t=a.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(s=Math.max.apply(Math,v([],m(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(s),r&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(s)),[2,{hasNext:!(n.length>=this._limit&&this._hasNext)||this.viewBottom>s,nextToken:this._syncRange.bottom}]):[2,{hasNext:!1,nextToken:0}]}}))}))})),this._connectionEventContext=l.on((function(e){if(e instanceof ee)switch(e.stateType){case te.CONNECTED:a._refreshChannel(ze.SYNC_CHANNEL_CHANGELOGS),S((function(){return g(a,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))})),h.debug("check huge gap"),a._checkHugeGap();break;case te.LOGOUT:a.dispose();break;default:a._clearCheckMyMutedTimer(),a._prevFill.stop(),a._nextFill.stop()}})),j.of(this._iid).statLogCollector.put(new ie({type:ae.FEATURE_LOCALCACHE,data:{use_local_cache:c.localCacheEnabled,collection_interface:{message:!0}}}))}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return v([],m(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===ue.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===ue.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,v(v([],m(this._messages.map((function(e){return e.createdAt}))),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,v(v([],m(this._messages.map((function(e){return e.createdAt}))),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype.setMessageCollectionHandler=function(e){this._handler=e},e.prototype._filterUnderOffsetMessage=function(e){return e},e.prototype._addMessagesToView=function(e,t){var n,r,s=this,i=this._filterUnderOffsetMessage(e),a=[],o=[];try{for(var u=C(i),c=u.next();!c.done;c=u.next()){var l=c.value;if(t===J.SYNC_MESSAGE_FILL){if(l.messageId>0){if((f=yr(this._messages,l))<0){yr(this._unsentMessages,l)<0&&a.push(l);var h=Er(this._messages,l);this._messages.splice(h,0,l)}}else if(l instanceof Ct){(f=yr(this._unsentMessages,l))<0&&yr(this._messages,l)<0&&(this._unsentMessages.push(l),a.push(l))}}else if(l.messageId>0){if((f=yr(this._messages,l))<0){var d=yr(this._unsentMessages,l);d<0?a.push(l):(this._unsentMessages.splice(d,1),o.push(l));h=Er(this._messages,l);this._messages.splice(h,0,l)}else o.push(l),this._messages[f]=l;if(l.updatedAt>0){var p=this._updateChildMessagesInView(l);o.push.apply(o,v([],m(p),!1))}}else if(l instanceof Ct){var f;(f=yr(this._unsentMessages,l))<0?yr(this._messages,l)<0&&(this._unsentMessages.push(l),a.push(l)):(o.push(l),this._unsentMessages[f]=l)}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}se(t)&&Y((function(){return g(s,void 0,void 0,(function(){var e,n,r;return y(this,(function(s){return e=new or(t),a.length>0&&(null===(n=this._handler)||void 0===n||n.onMessagesAdded(e,this.channel,a)),o.length>0&&(null===(r=this._handler)||void 0===r||r.onMessagesUpdated(e,this.channel,o)),[2]}))}))}))},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n.parentMessageId===e.messageId&&n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._updatePollsToView=function(e,t){var n,r,s=this,i=[];try{for(var a=C(e),o=a.next();!o.done;o=a.next()){var u=o.value,c=Cr(this._messages,u.messageId);if(c>=0){var l=this._messages[c];l&&l.applyPoll(u),i.push(l)}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i.length>0&&se(t)&&Y((function(){return g(s,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new or(t),i.length>0&&(null===(n=this._handler)||void 0===n||n.onMessagesUpdated(e,this.channel,i)),[2]}))}))})),i},e.prototype._applyPollUpdateEventToView=function(e,t){var n=this,r=Cr(this._messages,e.messageId);if(r>=0){var s=this._messages[r];s&&s.isUserMessage()&&s.poll&&s.poll.applyPollUpdateEvent(e)&&se(t)&&Y((function(){return g(n,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new or(t),null===(n=this._handler)||void 0===n||n.onMessagesUpdated(e,this.channel,[s]),[2]}))}))}))}},e.prototype._applyPollVoteEventToView=function(e,t){var n=this,r=Cr(this._messages,e.messageId);if(r>=0){var s=this._messages[r];s&&s.isUserMessage()&&s.poll&&s.poll.applyPollVoteEvent(e)&&se(t)&&Y((function(){return g(n,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new or(t),null===(n=this._handler)||void 0===n||n.onMessagesUpdated(e,this.channel,[s]),[2]}))}))}))}},e.prototype._updateMessagesToView=function(e,t){var n,r,s=this,i=[],a=[],o=[];try{for(var u=C(e),c=u.next();!c.done;c=u.next()){var l,h=c.value;if(h.messageId>0)if((l=yr(this._messages,h))>=0)a.push(h),this._messages[l]=h;else{var d=yr(this._unsentMessages,h);if(d>=0){var p=this._unsentMessages.splice(d,1);if(this.hasNext&&p.length>0)o.push(p[0]);else{a.push(h);var f=Er(this._messages,h);this._messages.splice(f,0,h)}}else{var _=this._messages.map((function(e){return e.createdAt}));(h.createdAt<Math.min.apply(Math,v([],m(_),!1))&&!this._hasPrevious||h.createdAt>Math.max.apply(Math,v([],m(_),!1))&&!this._hasNext)&&i.push(h)}}else if(h instanceof Ct)(l=yr(this._unsentMessages,h))>=0&&(a.push(h),this._unsentMessages[l]=h)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return se(t)&&Y((function(){return g(s,void 0,void 0,(function(){var e,n,r;return y(this,(function(s){return e=new or(t),a.length>0?null===(n=this._handler)||void 0===n||n.onMessagesUpdated(e,this.channel,a):o.length>0?null===(r=this._handler)||void 0===r||r.onMessagesDeleted(e,this.channel,[],o):i.length>0&&this._addMessagesToView(i,t),[2]}))}))})),a},e.prototype._removeMessagesFromView=function(e,t){var n,r,s=this,i=[],a=[],o=function(e){var t=u._messages.findIndex((function(t){return t.messageId===e}));if(t>=0){var n=u._messages[t];i.push(n.messageId),a.push(n),u._messages.splice(t,1)}},u=this;try{for(var c=C(e),l=c.next();!l.done;l=c.next()){o(l.value)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return se(t)&&a.length>0&&Y((function(){return g(s,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new or(t),null===(n=this._handler)||void 0===n||n.onMessagesDeleted(e,this.channel,i,a),[2]}))}))})),i},e.prototype._removeUnsentMessageFromView=function(e,t){var n=this._unsentMessages.findIndex((function(t){return t.reqId===e}));n>=0&&this._unsentMessages.splice(n,1)},e.prototype._getLocalMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,s=t.nextLimit,i=void 0===s?0:s,a=t.inclusive,o=void 0===a||a;return g(this,void 0,void 0,(function(){var t,n,s,a,u,c;return y(this,(function(l){switch(l.label){case 0:return t=rr.of(this._iid),n=[],o?[4,t._getExactlyMatchingMessagesForTokenFromCache(this._channel.url,e,this.filter)]:[3,2];case 1:n=l.sent(),l.label=2;case 2:return r>0?[4,t.getMessagesFromCache(this._channel.url,e,"prev",this.filter,r,!1)]:[3,4];case 3:return a=l.sent(),[3,5];case 4:a=[],l.label=5;case 5:return s=a,i>0?[4,t.getMessagesFromCache(this._channel.url,e,"next",this.filter,i,!1)]:[3,7];case 6:return c=l.sent(),[3,8];case 7:c=[],l.label=8;case 8:return u=c,[2,v(v(v([],m(n),!1),m(s),!1),m(u),!1).sort((function(e,t){return t.createdAt-e.createdAt}))]}}))}))},e.prototype._getRemoteMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,a=t.nextLimit,o=void 0===a?0:a,u=t.source,c=void 0===u?J.REQUEST_MESSAGE:u,l=t.reverse,h=void 0!==l&&l,d=t.checkingContinuousMessages,p=void 0!==d&&d;return g(this,void 0,void 0,(function(){var t,n;return y(this,(function(a){switch(a.label){case 0:return t=Ut.of(this._iid),r>0||o>0?[4,t._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,e,s(i(i({},this.filter),{isInclusive:!0,reverse:h,prevResultSize:r,nextResultSize:o,includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0})),c,p)]:[3,2];case 1:return n=a.sent(),[3,3];case 2:n={messages:[],isContinuousMessages:!1},a.label=3;case 3:return[2,n]}}))}))},e.prototype._checkHugeGap=function(){var e;return g(this,void 0,void 0,(function(){var t,n,r,s,a,o,u,c,l,h,d,p,f,C,E,b,M,N,S,U,T=this;return y(this,(function(A){switch(A.label){case 0:return this._messages.length>0?(t=this._syncRange.top,n=this.viewTop,r=this._syncRange.bottom,s=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,(a=rr.of(this._iid)).getCachedMessageCountBetween(this._channel.url,this.filter,n,t)]):[3,4];case 1:return o=A.sent(),[4,a.getCachedMessageCountBetween(this._channel.url,this.filter,r,s)];case 2:return u=A.sent(),[4,ce((function(){return g(T,void 0,void 0,(function(){var e,a,c,l,h,d,p,f,_,C,E,b,M,N,S,U,T,A,I,w,D,k=this;return y(this,(function(P){switch(P.label){case 0:return e=j.of(this._iid),a=e.dispatcher,c=e.requestQueue,l=e.cacheContext,h=new fr(i({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:n,prevEnd:t,prevCount:o,nextStart:r,nextEnd:s,nextCount:u,checkingContinuousMessages:l.localCacheEnabled},this.filter)),[4,c.send(h)];case 1:return d=P.sent(),p=d.as(_r),f=p.isHugeGap,_=p.prevMessages,C=void 0===_?[]:_,E=p.prevHasMore,b=p.isContinuousPrevMessages,M=p.nextMessages,N=void 0===M?[]:M,S=p.nextHasmore,U=p.isContinuousNextMessages,f?Y((function(){return g(k,void 0,void 0,(function(){var e;return y(this,(function(t){return null===(e=this._handler)||void 0===e||e.onHugeGapDetected(),[2]}))}))})):(T=this.viewTop,A=this.viewBottom,I=Math.min.apply(Math,v([Number.MAX_SAFE_INTEGER,T],m(C.map((function(e){return e.createdAt}))),!1)),w=Math.max.apply(Math,v([0,A],m(N.map((function(e){return e.createdAt}))),!1)),a.dispatch(new L({messages:C,source:J.SYNC_MESSAGE_FILL})),a.dispatch(new L({messages:N,source:J.SYNC_MESSAGE_FILL})),this._syncRange.extends(I,w),(b||U)&&(null===(D=this._backgroundSync)||void 0===D||D.range.extends(I,w)),E&&this._prevFill.start(I),S&&this._nextFill.start(w)),[2]}}))}))}),1)];case 3:return A.sent(),[3,8];case 4:c=j.of(this._iid).cacheContext,l=Math.floor(this._limit/2),h=Date.now(),A.label=5;case 5:return A.trys.push([5,7,,8]),[4,this._getRemoteMessages(h,{prevLimit:l,nextLimit:l,source:J.SYNC_MESSAGE_FILL,checkingContinuousMessages:c.localCacheEnabled})];case 6:if(d=A.sent(),p=d.messages,f=d.isContinuousMessages,p.length>0){for(C=p.map((function(e){return e.createdAt})),E=0,b=0,M=0;M<C.length;M++)(N=C[M])<=h?E++:N>=h&&b++;this._hasPrevious=E>=l,this._hasNext=b>=l,(U=this._syncRange).extends.apply(U,v([],m(C),!1)),f&&(null===(e=this._backgroundSync)||void 0===e||e.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(p,J.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,8];case 7:return(S=A.sent())instanceof _&&S.code===X.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,8];case 8:return[2]}}))}))},e.prototype._loadUnsentMessages=function(){return g(this,void 0,void 0,(function(){var e,t;return y(this,(function(n){switch(n.label){case 0:return e=rr.of(this._iid),t=this,[4,e.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return t._unsentMessages=n.sent(),[2]}}))}))},e.prototype._hasPollMessage=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,rr.of(this._iid).getPollMessagesFromCache(this._channel.url,Date.now()+br,this.filter,1)];case 1:return e.sent().length>0?[2,!0]:[2,!1]}}))}))},e.prototype._refreshChannel=function(e){rr.of(this._iid).refreshChannel(this.channel.url,!0,e)},e.prototype._startCheckMyMutedTimer=function(e){var t=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout((function(){return g(t,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:this._checkMyMutedStateTimer=void 0,e=!0,s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return t=s.sent(),e=!t.isMuted,[3,5];case 3:return s.sent(),e=!0,[3,5];case 4:return e&&(this.channel.myMutedState=ns.UNMUTED,n=new ar(ze.EVENT_CHANNEL_UNMUTED),null===(r=this._handler)||void 0===r||r.onChannelUpdated(n,this.channel)),[7];case 5:return[2]}}))}))}),e+1e3)},e.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},e.prototype.initialize=function(e){var t=this,n=new Ur;this._messages=[],this._unsentMessages=[],this._syncRange=new er({}),this._hasNext=!0,this._hasPrevious=!0,this._refreshChannel(ze.REFRESH_CHANNEL),S((function(){return g(t,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))}));var r=Math.floor(this._limit/2);if(e===sr.CACHE_AND_REPLACE_BY_API)this._getLocalMessages(this._startingPoint,{prevLimit:r,nextLimit:r}).then((function(e){return g(t,void 0,void 0,(function(){var t;return y(this,(function(r){switch(r.label){case 0:return t=this._filterUnderOffsetMessage(e),this._addMessagesToView(t,J.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return r.sent(),n._invokeResponse("local",null,t),[2]}}))}))})).catch((function(e){if(K(e))throw e;n._invokeResponse("local",e,null)})).finally((function(){var e=j.of(t._iid).cacheContext;t._getRemoteMessages(t._startingPoint,{prevLimit:r,nextLimit:r,reverse:!0,checkingContinuousMessages:e.localCacheEnabled}).then((function(e){var s,i,a=e.messages,o=e.isContinuousMessages;t._messages=[];var u=t._filterUnderOffsetMessage(a);if(u.length>0){for(var c=u.map((function(e){return e.createdAt})),l=0,h=0,d=0;d<c.length;d++){var p=c[d];p<t._startingPoint?l++:p>t._startingPoint&&h++}t._hasPrevious=l>=r,t._hasNext=h>=r,(s=t._syncRange).extends.apply(s,v([],m(u.map((function(e){return e.createdAt}))),!1)),o&&(null===(i=t._backgroundSync)||void 0===i||i.range.extends(t._syncRange.top,t._syncRange.bottom)),t._addMessagesToView(u,J.REQUEST_MESSAGE)}else t._hasPrevious=!1,t._hasNext=!1;n._invokeResponse("remote",null,u)})).catch((function(e){if(K(e))throw e;n._invokeResponse("remote",e,null)}))}));var s=j.of(this._iid),i=s.cacheContext;return s.statLogCollector.put(new ie({type:ae.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{message_init_policy:e}}})),n},e.prototype.loadPrevious=function(){return g(this,void 0,void 0,(function(){var e,t,n,r=this;return y(this,(function(s){switch(s.label){case 0:if(this._isDisposed)throw new _({code:X.COLLECTION_DISPOSED,message:"Collection has been disposed."});return this._hasPrevious?(e=Math.floor(this._limit/2),t=this.viewTop,n=[],[4,S((function(){return g(r,void 0,void 0,(function(){var r;return y(this,(function(s){switch(s.label){case 0:return r=this._filterUnderOffsetMessage,[4,this._getLocalMessages(t,{prevLimit:e,inclusive:!1})];case 1:return n=r.apply(this,[s.sent()]),[2]}}))}))}))]):[2,[]];case 1:return s.sent(),n.length<e||!this._backgroundSync||!this._backgroundSync.isWrappingMessages(n)?[4,S((function(){return g(r,void 0,void 0,(function(){var r,s,i,a,o,u=this;return y(this,(function(c){switch(c.label){case 0:return r=j.of(this._iid).cacheContext,[4,this._getRemoteMessages(t,{prevLimit:e,reverse:!0,checkingContinuousMessages:r.localCacheEnabled})];case 1:return s=c.sent(),n=(n=this._filterUnderOffsetMessage(s.messages)).filter((function(e){return yr(u._messages,e)<0})),this._hasPrevious=n.length>=e,n.length>0&&((i=this._syncRange).extends.apply(i,v([],m(n.map((function(e){return e.createdAt}))),!1)),(null===(a=this._backgroundSync)||void 0===a?void 0:a.range.overlap(this._syncRange))&&s.isContinuousMessages&&(null===(o=this._backgroundSync)||void 0===o||o.range.extends(this._syncRange.top))),[2]}}))}))}))]:[3,3];case 2:return s.sent(),this._addMessagesToView(n,J.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=n.length>=e,n.length>0&&this._addMessagesToView(n,J.REQUEST_MESSAGE),s.label=4;case 4:return[2,n]}}))}))},e.prototype.loadNext=function(){var e;return g(this,void 0,void 0,(function(){var t,n,r,s=this;return y(this,(function(i){switch(i.label){case 0:if(this._isDisposed)throw new _({code:X.COLLECTION_DISPOSED,message:"Collection has been disposed."});return this._hasNext?(t=Math.floor(this._limit/2),n=this.viewBottom,r=[],[4,S((function(){return g(s,void 0,void 0,(function(){var e;return y(this,(function(s){switch(s.label){case 0:return e=this._filterUnderOffsetMessage,[4,this._getLocalMessages(n,{nextLimit:t,inclusive:!1})];case 1:return r=e.apply(this,[s.sent()]),[2]}}))}))}))]):[2,[]];case 1:return i.sent(),r.length<t||!(null===(e=this._backgroundSync)||void 0===e?void 0:e.isWrappingMessages(r))?[4,S((function(){return g(s,void 0,void 0,(function(){var e,s,i,a,o,u=this;return y(this,(function(c){switch(c.label){case 0:return e=j.of(this._iid).cacheContext,[4,this._getRemoteMessages(n,{nextLimit:t,reverse:!0,checkingContinuousMessages:e.localCacheEnabled})];case 1:return s=c.sent(),r=(r=this._filterUnderOffsetMessage(s.messages)).filter((function(e){return yr(u._messages,e)<0})),this._hasNext=r.length>=t,r.length>0&&((i=this._syncRange).extends.apply(i,v([],m(r.map((function(e){return e.createdAt}))),!1)),(null===(a=this._backgroundSync)||void 0===a?void 0:a.range.overlap(this._syncRange))&&s.isContinuousMessages&&(null===(o=this._backgroundSync)||void 0===o||o.range.extends(this._syncRange.bottom))),[2]}}))}))}))]:[3,3];case 2:return i.sent(),this._addMessagesToView(r,J.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=r.length>=t,r.length>0&&this._addMessagesToView(r,J.REQUEST_MESSAGE),i.label=4;case 4:return[2,r]}}))}))},e.prototype.removeFailedMessage=function(e){return g(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:if(this._isDisposed)throw new _({code:X.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,rr.of(this._iid).removeFailedMessageFromCache(e)];case 1:return n.sent(),(t=this._unsentMessages.findIndex((function(t){return t.reqId===e})))>-1&&this._unsentMessages.splice(t,1),[2]}}))}))},e.prototype.dispose=function(){var e,t,n;if(!this._isDisposed){this._isDisposed=!0;var r=j.of(this._iid),s=r.cacheContext,i=r.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._updateMessageCollectionLastAccessedAt(),i.dispatch(new We({channels:[this._channel],source:ze.CHANNEL_LASTACCESSEDAT_UPDATED})),s.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),null===(n=this._pollChangelogSync)||void 0===n||n.close();var a=rr.of(this._iid);a.unsubscribeGroupChannelEvent(this._key),a.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},e}(),Ar={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Ir=function(t){function n(e){var n=this,r=e.channelUrl,s=e.token,i=e.limit,a=e.order,o=e.mutedMemberFilter,u=e.memberStateFilter,c=e.nicknameStartsWithFilter,l=e.operatorFilter;return(n=t.call(this)||this).method=D.GET,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/members"),n.params={token:s,limit:i,order:a,muted_member_filter:o,member_state_filter:u,nickname_startswith:c,operator_filter:l,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},n}return e(n,t),n}(F),wr=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.members=[];var s=n.next,i=n.members;return r.token=s,i&&i.length>0&&(r.members=i.map((function(t){return new zt(e,t)}))),r}return e(n,t),n}(R);!function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted"}(Mr||(Mr={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(Nr||(Nr={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Sr||(Sr={}));var Lr=function(t){function n(e,n,r){var s,i,a,o,c=this;return(c=t.call(this,e,n,u.GROUP,r)||this).mutedMemberFilter=Mr.ALL,c.memberStateFilter=Sr.ALL,c.nicknameStartsWithFilter=null,c.operatorFilter=qt.ALL,c.order=Nr.MEMBER_NICKNAME_ALPHABETICAL,c.mutedMemberFilter=null!==(s=r.mutedMemberFilter)&&void 0!==s?s:Mr.ALL,c.memberStateFilter=null!==(i=r.memberStateFilter)&&void 0!==i?i:Sr.ALL,c.nicknameStartsWithFilter=null!==(a=r.nicknameStartsWithFilter)&&void 0!==a?a:null,c.order=null!==(o=r.order)&&void 0!==o?o:Nr.MEMBER_NICKNAME_ALPHABETICAL,c}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&a(Mr,this.mutedMemberFilter)&&a(Sr,this.memberStateFilter)&&(b("string",this.nicknameStartsWithFilter)||null===this.nicknameStartsWithFilter)&&a(qt,this.operatorFilter)&&a(Nr,this.order)},n.prototype.next=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,a,o;return y(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=j.of(this._iid).requestQueue,t=new Ir(s(i(i({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(wr),a=r.members,o=r.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,a];case 2:return[2,[]];case 3:throw _.queryInProgress;case 4:return[3,6];case 5:throw _.invalidParameters;case 6:return[2]}}))}))},n}(le),Dr=function(t){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.accessCode;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/accept"),n.params={user_id:s,access_code:i},n}return e(n,t),n}(F),kr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r.channel.myMemberState=Rt.JOINED,r}return e(n,t),n}(R),Pr=function(t){function n(e){var n=this,s=e.channelUrl,i=e.isDistinct,a=e.isPublic,o=e.isDiscoverable,u=e.coverUrl,c=e.coverImage,l=e.accessCode,h=e.name,d=e.data,p=e.customType,f=e.operatorUserIds,_=e.messageSurvivalSeconds;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(s)),n.params=r({is_distinct:i,is_public:a,is_discoverable:o,name:h,data:d,custom_type:p,cover_url:u,cover_file:c,access_code:l,operator_ids:f,message_survival_seconds:_}),n}return e(n,t),n}(F),Fr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.channel=new cs(e,n),r}return e(n,t),n}(R),Rr=function(t){function n(e){var n=this,r=e.channelUrl;return(n=t.call(this)||this).method=D.DELETE,n.path="".concat(O,"/").concat(encodeURIComponent(r)),n}return e(n,t),n}(F);!function(t){function n(e,n){return t.call(this,e,n)||this}e(n,t)}(R);var xr=function(t){function n(e){var n=this,r=e.channelUrl;return(n=t.call(this)||this).method=D.DELETE,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/hide"),n}return e(n,t),n}(F);!function(t){function n(){return null!==t&&t.apply(this,arguments)||this}e(n,t)}(R);var Or=function(t){function n(e){var n=e.userId,r=e.channelUrl,s=e.countPreference,i=t.call(this)||this;return i.method=D.PUT,i.path="".concat(k,"/").concat(encodeURIComponent(n),"/count_preference/").concat(encodeURIComponent(r)),i.params={count_preference:s},i}return e(n,t),n}(F),Hr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.countPreference=n.count_preference,r}return e(n,t),n}(R),Gr=function(t){function n(e){var n=this,r=e.channelUrl;return(n=t.call(this)||this).method=D.PUT,n.path="".concat(O,"/").concat(encodeURIComponent(r),"/reset_user_history"),n}return e(n,t),n}(F),Vr=function(t){function n(e,n){var r=t.call(this,e,n)||this,s=n.ts_message_offset;return r.messageOffsetTimestamp=s,r}return e(n,t),n}(R),qr=i(i({},ke),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),Br=i(i({},Fe),{scheduledAt:void 0}),Wr=function(t){function n(e){var n,i=this;i=t.call(this)||this;var a=[];e.mentionType===he.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map((function(e){return e.userId}))));var o=e.channelType,u=e.channelUrl,c=e.scheduledMessageId;return i.method=D.PUT,i.path="".concat(re(o),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(c)),i.params=r(s({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:de.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:e.thumbnailSizes?e.thumbnailSizes.map((function(e){return Tt.payloadify(e)})):[],custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(n=e.metaArrays)||void 0===n?void 0:n.map((function(e){return At.payloadify(e)})),apple_critical_alert_options:e.appleCriticalAlertOptions?It.payloadify(e.appleCriticalAlertOptions):null,push_option:e.pushNotificationDeliveryOption})),i}return e(n,t),n}(F),zr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.message=new Nt(e,n),r}return e(n,t),n}(R),jr=function(t){function n(e){var n,i=this;i=t.call(this)||this;var a=[];e.mentionType===he.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map((function(e){return e.userId}))));var o=e.channelType,u=e.channelUrl,c=e.scheduledMessageId;return i.method=D.PUT,i.path="".concat(re(o),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(c)),i.params=r(s({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:de.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(n=e.metaArrays)||void 0===n?void 0:n.map((function(e){return At.payloadify(e)})),apple_critical_alert_options:e.appleCriticalAlertOptions?It.payloadify(e.appleCriticalAlertOptions):null,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption})),i}return e(n,t),n}(F);!function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.message=new Mt(e,n),r}e(n,t)}(R);var Qr=function(t){function n(e){var n=t.call(this)||this,r=e.channelType,s=e.channelUrl,i=e.scheduledMessageId;return n.method=D.DELETE,n.path="".concat(re(r),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(i)),n}return e(n,t),n}(F),Kr=function(t){function n(e){var n=t.call(this)||this,r=e.channelType,s=e.channelUrl,i=e.scheduledMessageId;return n.method=D.POST,n.path="".concat(re(r),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(i),"/send_now"),n}return e(n,t),n}(F),Yr=function(t){function n(e){var n=e.userId,r=e.channelUrl,s=e.pushTriggerOption,i=t.call(this)||this;return i.method=D.PUT,i.path="".concat(k,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),i.params={push_trigger_option:s},i}return e(n,t),n}(F),Jr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return e(n,t),n}(R),Xr=function(t){function n(e){var n=e.userId,r=e.channelUrl,s=t.call(this)||this;return s.method=D.GET,s.path="".concat(k,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),s}return e(n,t),n}(F),Zr=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return e(n,t),n}(R),$r=function(t){function n(e){var n=e.channelType,r=e.channelUrl,s=e.messageId,i=t.call(this)||this;return i.method=D.POST,i.path="".concat(re(n),"/").concat(encodeURIComponent(r),"/messages/").concat(s,"/pin"),i}return e(n,t),n}(F);!function(t){function n(e,n){return t.call(this,e,n)||this}e(n,t)}(R);var es=function(t){function n(e){var n=e.channelType,r=e.channelUrl,s=e.messageId,i=t.call(this)||this;return i.method=D.DELETE,i.path="".concat(re(n),"/").concat(encodeURIComponent(r),"/messages/").concat(s,"/pin"),i}return e(n,t),n}(F);!function(t){function n(e,n){return t.call(this,e,n)||this}e(n,t)}(R);var ts,ns,rs,ss=function(t){function n(e,n){var r=t.call(this,e)||this;return r.message=bt(e,n.message),r}return e(n,t),n}(h),is=function(t){function n(e){var n=this,s=e.channelType,i=e.channelUrl,a=e.limit,o=e.token,u=e.includeReactions,c=e.includeMetaArray,l=e.includeParentMessageInfo,h=e.includeThreadInfo,d=e.includePollDetails;return(n=t.call(this)||this).method=D.GET,n.path="".concat(re(s),"/").concat(encodeURIComponent(i),"/pinned_messages"),n.params=r({limit:a,token:o,include_reactions:u,with_sorted_meta_array:c,include_thread_info:h,include_parent_message_info:l,include_poll_details:d}),n}return e(n,t),n}(F),as=function(t){function n(e,n){var r=t.call(this,e,n)||this,s=n.pinned_messages,i=n.has_more,a=n.next;return r.pinnedMessages=s.map((function(t){return new ss(e,t)})),r.hasMore=i,r.token=a,r}return e(n,t),n}(R),os=function(t){function n(e,n,r,s){var i=t.call(this,e,n,r,s)||this;return i.includeMetaArray=s.includeMetaArray,i.includeReactions=s.includeReactions,i.includeParentMessageInfo=s.includeParentMessageInfo,i.includeThreadInfo=s.includeThreadInfo,i.includePollDetails=s.includePollDetails,i}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&b("boolean",this.includeMetaArray,!0)&&b("boolean",this.includeReactions,!0)&&b("boolean",this.includeParentMessageInfo,!0)&&b("boolean",this.includeThreadInfo,!0)&&b("boolean",this.includePollDetails,!0)},n.prototype.next=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,a,o;return y(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=j.of(this._iid).requestQueue,t=new is(i(i({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(as),s=r.pinnedMessages,a=r.hasMore,o=r.token,this._token=o,this._hasNext=!!a,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw _.queryInProgress;case 4:return[3,6];case 5:throw _.invalidParameters;case 6:return[2]}}))}))},n}(le);!function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off"}(ts||(ts={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted"}(ns||(ns={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(rs||(rs={}));var us,cs=function(t){function n(e,n){var r,s,l,h,d,p,f,_,g,y,C,E,M,N,S,U,T,A,I,w=this;return(w=t.call(this,e,n)||this)._unreadMemberStateMap=new Map,w._undeliveredMemberStateMap=new Map,w._typingStatus=new Map,w._lastMemberCountUpdated=0,w._typingStarted=0,w._typingEnded=0,w.isDistinct=!1,w.isSuper=!1,w.isBroadcast=!1,w.isExclusive=!1,w.isPublic=!1,w.isDiscoverable=!0,w.isAccessCodeRequired=!1,w.isPushEnabled=!1,w.unreadMessageCount=0,w.unreadMentionCount=0,w.members=[],w.memberCount=0,w.joinedMemberCount=0,w.hiddenState=rs.UNHIDDEN,w.lastMessage=null,w.messageOffsetTimestamp=0,w.messageSurvivalSeconds=-1,w.myMemberState=Rt.NONE,w.myRole=o.NONE,w.myMutedState=ns.UNMUTED,w.myLastRead=0,w.myCountPreference=ts.ALL,w.myPushTriggerOption=fe.DEFAULT,w.inviter=null,w.invitedAt=0,w.joinedAt=0,w.pinnedMessageIds=[],w.lastPinnedMessage=null,w._pinnedMessagesUpdatedAt=0,w._myMutedRemainingTime=-1,w.channelType=u.GROUP,w.isDistinct=null!==(s=n.is_distinct)&&void 0!==s&&s,w.isSuper=null!==(l=n.is_super)&&void 0!==l&&l,w.isBroadcast=null!==(h=n.is_broadcast)&&void 0!==h&&h,w.isExclusive=null!==(d=n.is_exclusive)&&void 0!==d&&d,w.isPublic=null!==(p=n.is_public)&&void 0!==p&&p,w.isDiscoverable=null!==(f=n.is_discoverable)&&void 0!==f?f:w.isPublic,w.isAccessCodeRequired=null!==(_=n.is_access_code_required)&&void 0!==_&&_,w.isPushEnabled=null!==(g=n.is_push_enabled)&&void 0!==g&&g,Array.isArray(n.members)&&(r=w.members).push.apply(r,v([],m(n.members.map((function(e){return new zt(w._iid,e)}))),!1)),w.memberCount=null!==(y=n.member_count)&&void 0!==y?y:0,w.joinedMemberCount=null!==(C=n.joined_member_count)&&void 0!==C?C:0,w.hiddenState=a(rs,n.hidden_state)?n.hidden_state:rs.UNHIDDEN,w.messageOffsetTimestamp=null!==(E=n.ts_message_offset)&&void 0!==E?E:0,w.messageSurvivalSeconds=null!==(M=n.message_survival_seconds)&&void 0!==M?M:-1,w.lastMessage=n.last_message?bt(w._iid,i({channel_type:w.channelType},n.last_message)):null,n.read_receipt&&Object.keys(n.read_receipt).forEach((function(e){b("number",n.read_receipt[e])&&w._updateUnreadMemberState(e,n.read_receipt[e])})),n.delivery_receipt&&Object.keys(n.delivery_receipt).forEach((function(e){b("number",n.delivery_receipt[e])&&w._updateUndeliveredMemberState(e,n.delivery_receipt[e])})),w.myMemberState=a(Rt,n.member_state)?n.member_state:Rt.NONE,w.myRole=a(o,n.my_role)?n.my_role:o.NONE,a(ns,n.is_muted)?w.myMutedState=n.is_muted:b("boolean",n.is_muted)?w.myMutedState=n.is_muted?ns.MUTED:ns.UNMUTED:w.myMutedState=ns.UNMUTED,w.myCountPreference=a(ts,n.count_preference)?n.count_preference:ts.ALL,w.myPushTriggerOption=a(fe,n.push_trigger_option)?n.push_trigger_option:fe.ALL,w.myLastRead=null!==(N=n.user_last_read)&&void 0!==N?N:0,w.inviter=n.inviter?new c(w._iid,n.inviter):null,w.invitedAt=null!==(S=n.invited_at)&&void 0!==S?S:0,w.joinedAt=null!==(U=n.joined_ts)&&void 0!==U?U:0,w._updateUnreadCount(null!==(T=n.unread_message_count)&&void 0!==T?T:0,null!==(A=n.unread_mention_count)&&void 0!==A?A:0),w.pinnedMessageIds=null!==(I=n.pinned_message_ids)&&void 0!==I?I:[],w.lastPinnedMessage=n.latest_pinned_message?bt(w._iid,i({channel_type:w.channelType},n.latest_pinned_message)):null,w}return e(n,t),Object.defineProperty(n.prototype,"isHidden",{get:function(){return this.hiddenState!==rs.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedUnreadMemberState",{get:function(){var e,t,n={};try{for(var r=C(this._unreadMemberStateMap),s=r.next();!s.done;s=r.next()){var i=m(s.value,2),a=i[0],o=i[1];n[a]=o}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedUndeliveredMemberState",{get:function(){var e,t,n={};try{for(var r=C(this._undeliveredMemberStateMap),s=r.next();!s.done;s=r.next()){var i=m(s.value,2),a=i[0],o=i[1];n[a]=o}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),n.payloadify=function(e){return r(s(i(i({},t.payloadify.call(this,e)),{is_access_code_required:e.isAccessCodeRequired,is_distinct:e.isDistinct,is_super:e.isSuper,is_broadcast:e.isBroadcast,is_exclusive:e.isExclusive,is_public:e.isPublic,is_discoverable:e.isDiscoverable,is_muted:e.myMutedState,is_push_enabled:e.isPushEnabled,unread_message_count:e.unreadMessageCount,unread_mention_count:e.unreadMentionCount,push_trigger_option:e.myPushTriggerOption,count_preference:e.myCountPreference,hidden_state:e.hiddenState,member_count:e.memberCount,joined_member_count:e.joinedMemberCount,member_state:e.myMemberState,my_role:e.myRole,user_last_read:e.myLastRead,ts_message_offset:e.messageOffsetTimestamp,message_survival_seconds:e.messageSurvivalSeconds,read_receipt:e.cachedUnreadMemberState,delivery_receipt:e.cachedUndeliveredMemberState,members:e.members.map((function(e){return zt.payloadify(e)})),last_message:e.lastMessage?wt(e.lastMessage):null,inviter:e.inviter?c.payloadify(e.inviter):null,invited_at:e.invitedAt,joined_ts:e.joinedAt,pinned_message_ids:e.pinnedMessageIds,latest_pinned_message:e.lastPinnedMessage?wt(e.lastPinnedMessage):null})))},n.prototype._shouldUpdateLastMessageWith=function(e){return!(e instanceof Ct&&e.parentMessageId>0&&!e.replyToChannel)&&(!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt)},n.prototype._updateUnreadCount=function(e,t){if("number"==typeof e&&e>=0)if(this.myCountPreference===ts.ALL||this.myCountPreference===ts.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var n=j.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=n&&e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&(this.myCountPreference===ts.ALL||this.myCountPreference===ts.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=t:this.unreadMentionCount=0},n.prototype._updateUnreadMemberState=function(e,t){var n=this._unreadMemberStateMap.get(e);return(!n||n<t)&&(this._unreadMemberStateMap.set(e,t),j.of(this._iid).sdkState.userId===e&&(this.myLastRead=t),!0)},n.prototype._updateUndeliveredMemberState=function(e,t){var n=this._undeliveredMemberStateMap.get(e);return(!n||n<t)&&(this._undeliveredMemberStateMap.set(e,t),!0)},n.prototype._updateTypingStatus=function(e,t){void 0===t&&(t=(new Date).getTime()),t>0?this._typingStatus.set(e.userId,{user:e,ts:t}):this._typingStatus.delete(e.userId)},n.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},n.prototype._setLatestMemberCount=function(e,t,n){var r=!1;return n>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=n,r=e!==this.memberCount||t!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=t),r},n.prototype.isReadMessage=function(e){var t=j.of(this._iid).sdkState,n=this._unreadMemberStateMap.get(t.userId);return!!n&&n>=e.createdAt},n.prototype.serialize=function(){var e=this;return B(this,(function(t){t.cachedUnreadMemberState=e.cachedUnreadMemberState,t.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState}))},n.prototype.createMessageCollection=function(e){return void 0===e&&(e={}),new Tr(this._iid,i({channel:this},e))},n.prototype.createMemberListQuery=function(e){return void 0===e&&(e={}),new Lr(this._iid,this.url,e)},n.prototype.createPinnedMessageListQuery=function(e){return void 0===e&&(e={}),new os(this._iid,this.url,this.channelType,e)},n.prototype.addMember=function(e,t){if(void 0===t&&(t=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var n=this.members.findIndex((function(t){return t.userId===e.userId}));if(n>-1){var r=this.members[n];r.state===Rt.JOINED&&(e.state=r.state),this.members.splice(n,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,t),this._updateUndeliveredMemberState(e.userId,t)}},n.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var t=e instanceof zt?e.userId:e,n=this.members.findIndex((function(e){return e.userId===t}));if(n>-1)return this.members.splice(n,1),this.memberCount--,!0}return!1},n.prototype.getUnreadMemberCount=function(e){var t,n;if(e instanceof Ct&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=j.of(this._iid).sdkState,s=e.createdAt,i=0;try{for(var a=C(this.members),o=a.next();!o.done;o=a.next()){var u=o.value;if(r.userId!==u.userId&&u.state===Rt.JOINED&&e.sender.userId!==u.userId)(this.cachedUnreadMemberState[u.userId]||0)<s&&i++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}return 0},n.prototype.getUndeliveredMemberCount=function(e){var t,n;if(e instanceof Ct&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=j.of(this._iid).sdkState,s=e.createdAt,i=0;try{for(var a=C(this.members),o=a.next();!o.done;o=a.next()){var u=o.value;if(r.userId!==u.userId&&u.state===Rt.JOINED&&e.sender.userId!==u.userId)(this.cachedUndeliveredMemberState[u.userId]||0)<s&&i++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}return 0},n.prototype.getReadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=j.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Ct?e.sender:null,i=[];return this.members.forEach((function(a){if(t||a.userId!==r.userId&&a.userId!==(null==s?void 0:s.userId)){var o=n._unreadMemberStateMap.get(a.userId);o&&o>=e.createdAt&&i.push(a)}})),i},n.prototype.getUnreadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=j.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Ct?e.sender:null,i=[];return this.members.forEach((function(a){if(t||a.userId!==r.userId&&a.userId!==(null==s?void 0:s.userId)){var o=n._unreadMemberStateMap.get(a.userId);o&&o<e.createdAt&&i.push(a)}})),i},n.prototype.getReadStatus=function(e){var t=this;void 0===e&&(e=!1);var n=j.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(s){if(e||s.userId!==n.userId){var i=t._unreadMemberStateMap.get(s.userId);r[s.userId]=new jt(t._iid,{channel_url:t.url,channel_type:t.channelType,user:zt.payloadify(s),ts:null!=i?i:0})}})),r},n.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach((function(t){var n=t.user;e.push(n)})),e},n.prototype.invalidateTypingStatus=function(){var e=this,t=j.of(this._iid).typingIndicatorInvalidateTime,n=Date.now(),r=!1;return this._typingStatus.forEach((function(s,i){var a=s.ts;n-a>=t&&(e._typingStatus.delete(i),r=!0)})),r},n.prototype.refresh=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i;return y(this,(function(a){switch(a.label){case 0:return e=j.of(this._iid),t=e.requestQueue,n=e.dispatcher,r=new ln({channelUrl:this.url}),[4,t.send(r)];case 1:return s=a.sent(),i=s.as(hn).channel,this._update(i),n.dispatch(new We({channels:[i],source:ze.REQUEST_CHANNEL})),[2,this]}}))}))},n.prototype.freeze=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,t.prototype.freeze.call(this)];case 1:return e.sent(),j.of(this._iid).dispatcher.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_FROZEN,isWebSocketEventComing:!0})),[2]}}))}))},n.prototype.unfreeze=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,t.prototype.unfreeze.call(this)];case 1:return e.sent(),j.of(this._iid).dispatcher.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_UNFROZEN,isWebSocketEventComing:!0})),[2]}}))}))},n.prototype.updateChannel=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,a,o,u;return y(this,(function(c){switch(c.label){case 0:return t=i(i({},Ar),e),f(function(e){return b("string",e.coverUrl,!0)&&(M(e.coverImage)||b("string",e.coverImage,!0))&&b("boolean",e.isDistinct,!0)&&b("boolean",e.isPublic,!0)&&b("boolean",e.isDiscoverable,!0)&&b("string",e.accessCode,!0)&&b("string",e.name,!0)&&b("string",e.data,!0)&&b("string",e.customType,!0)&&E("string",e.operatorUserIds,!0)&&b("number",e.messageSurvivalSeconds,!0)}(t)).throw(_.invalidParameters),n=j.of(this._iid),r=n.dispatcher,s=n.requestQueue,a=new Pr(i({channelUrl:this.url},t)),[4,s.send(a)];case 1:return o=c.sent(),u=o.as(Fr).channel,this._update(u),r.dispatch(new We({channels:[u],source:ze.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.invite=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){return f(e.every((function(e){return e instanceof c}))).throw(_.invalidParameters),[2,this.inviteWithUserIds(e.map((function(e){return e.userId})))]}))}))},n.prototype.inviteWithUserIds=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a;return y(this,(function(o){switch(o.label){case 0:return f(E("string",e)).throw(_.invalidParameters),t=j.of(this._iid),n=t.dispatcher,r=t.requestQueue,s=new Pn({channelUrl:this.url,userIds:e}),[4,r.send(s)];case 1:return i=o.sent(),a=i.as(Fn).channel,this._update(a),n.dispatch(new We({channels:[a],source:ze.EVENT_CHANNEL_INVITED,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.join=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a,o;return y(this,(function(u){switch(u.label){case 0:return f(b("string",e,!0)).throw(_.invalidParameters),t=j.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i=new In({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,s.send(i)];case 1:return a=u.sent(),(o=a.as(wn).channel).myMemberState=this.myMemberState=Rt.JOINED,this._update(o),n.dispatch(new We({channels:[o],source:ze.EVENT_CHANNEL_JOINED,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.leave=function(e){return void 0===e&&(e=!1),g(this,void 0,void 0,(function(){var t,n,r,s;return y(this,(function(i){switch(i.label){case 0:return t=j.of(this._iid),n=t.sdkState,r=t.requestQueue,s=new Dn({channelUrl:this.url,userId:n.userId,shouldRemoveOperatorStatus:e}),[4,r.send(s)];case 1:return i.sent(),this.myMemberState=Rt.NONE,[2]}}))}))},n.prototype.acceptInvitation=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a,o;return y(this,(function(u){switch(u.label){case 0:return f(b("string",e,!0)).throw(_.invalidParameters),t=j.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i=new Dr({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,s.send(i)];case 1:return a=u.sent(),(o=a.as(kr).channel).myMemberState=this.myMemberState=Rt.JOINED,this._update(o),n.dispatch(new We({channels:[o],source:ze.EVENT_CHANNEL_ACCEPTED_INVITE,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.declineInvitation=function(){return g(this,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:return e=j.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new xn({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return s.sent(),this.myMemberState=Rt.NONE,[2,this]}}))}))},n.prototype.sendUserMessage=function(e){var n=this,r=new Dt,s=j.of(this._iid).dispatcher,i=nt.of(this._iid);return t.prototype.sendUserMessage.call(this,e).onPending((function(e){i.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&i.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){n.hiddenState===rs.HIDDEN_ALLOW_AUTO_UNHIDE&&(n.hiddenState=rs.UNHIDDEN),i.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),rr.of(n._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),s.dispatch(new We({channels:[n],source:ze.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},n.prototype.updateUserMessage=function(e,n){return g(this,void 0,void 0,(function(){var r,s,i,a,o=this;return y(this,(function(u){switch(u.label){case 0:return r=j.of(this._iid).dispatcher,[4,t.prototype.updateUserMessage.call(this,e,n)];case 1:return s=u.sent(),i=!1,!s.silent&&this._shouldUpdateLastMessageWith(s)&&(this.lastMessage=s,i=!0),a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===s.messageId&&(this.lastPinnedMessage=s,i=!0,a=!0),i&&(rr.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new We({channels:[this],source:a?ze.EVENT_PINNED_MESSAGE_UPDATED:ze.EVENT_MESSAGE_UPDATED}))),a&&rr.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new L({messages:[s],source:J.EVENT_MESSAGE_UPDATED})),[2,s]}}))}))},n.prototype._autoResendUserMessage=function(e){var n=this,r=new Dt,s=j.of(this._iid).dispatcher,i=nt.of(this._iid);return t.prototype._autoResendUserMessage.call(this,e).onPending((function(e){i.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){i.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=rr.of(n._iid);i.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),s.dispatch(new We({channels:[n],source:ze.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},n.prototype.sendFileMessage=function(e){var n=this,r=new Dt,s=j.of(this._iid).dispatcher,i=nt.of(this._iid);return t.prototype.sendFileMessage.call(this,e).onPending((function(e){i.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&i.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=rr.of(n._iid);i.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),s.dispatch(new We({channels:[n],source:ze.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},n.prototype.sendMultipleFilesMessage=function(e){var n=this,r=new Lt,s=j.of(this._iid).dispatcher;return t.prototype.sendMultipleFilesMessage.call(this,e).onPending((function(e){r._trigger(e)})).onFailed((function(e,t){r._triggerFailed(e,t)})).onSucceeded((function(e){var t=rr.of(n._iid);n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),s.dispatch(new We({channels:[n],source:ze.EVENT_MESSAGE_SENT})),r._trigger(e)})).onFileUploaded((function(e,t,n,s){r._triggerOnFileUploaded(e,t,n,s)})),r},n.prototype.updateFileMessage=function(e,n){return g(this,void 0,void 0,(function(){var r,s,i,a,o=this;return y(this,(function(u){switch(u.label){case 0:return r=j.of(this._iid).dispatcher,[4,t.prototype.updateFileMessage.call(this,e,n)];case 1:return s=u.sent(),i=!1,!s.silent&&this._shouldUpdateLastMessageWith(s)&&(this.lastMessage=s,i=!0),a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===s.messageId&&(this.lastPinnedMessage=s,i=!0,a=!0),i&&(rr.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new We({channels:[this],source:a?ze.EVENT_PINNED_MESSAGE_UPDATED:ze.EVENT_MESSAGE_UPDATED}))),a&&rr.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new L({messages:[s],source:J.EVENT_MESSAGE_UPDATED})),[2,s]}}))}))},n.prototype._autoResendFileMessage=function(e){var n=this,r=new Dt,s=j.of(this._iid).dispatcher,i=nt.of(this._iid);return t.prototype._autoResendFileMessage.call(this,e).onPending((function(e){i.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){i.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=rr.of(n._iid);i.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),s.dispatch(new We({channels:[n],source:ze.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},n.prototype.deleteMessage=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,t.prototype.deleteMessage.call(this,e)];case 1:return n.sent(),0===e.messageId&&e instanceof Ct&&j.of(this._iid).dispatcher.dispatch(new I({reqId:e.reqId,source:J.EVENT_MESSAGE_DELETED})),[2]}}))}))},n.prototype.hide=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:return t=i(i({},Wn),e),f(function(e){return b("boolean",e.hidePreviousMessages,!0)&&b("boolean",e.allowAutoUnhide,!0)}(t)).throw(_.invalidParameters),n=j.of(this._iid),r=n.dispatcher,s=n.sdkState,a=n.requestQueue,o=new zn(i({channelUrl:this.url,userId:s.userId},t)),[4,a.send(o)];case 1:return u=l.sent(),c=u.as(jn).messageOffsetTimestamp,this.hiddenState=t.allowAutoUnhide?rs.HIDDEN_ALLOW_AUTO_UNHIDE:rs.HIDDEN_PREVENT_AUTO_UNHIDE,t.hidePreviousMessages&&this._updateUnreadCount(0,0),c&&(this.messageOffsetTimestamp=c),r.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_HIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.unhide=function(){return g(this,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:return e=j.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new xr({channelUrl:this.url}),[4,n.send(r)];case 1:return s.sent(),this.hiddenState=rs.UNHIDDEN,t.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_UNHIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.delete=function(){return g(this,void 0,void 0,(function(){var e,t;return y(this,(function(n){switch(n.label){case 0:return e=j.of(this._iid).requestQueue,t=new Rr({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},n.prototype.markAsRead=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i,a,o=this;return y(this,(function(u){switch(u.label){case 0:return e=j.of(this._iid),t=e.sdkState,n=e.dispatcher,r=e.requestQueue,s=new Hn({channelUrl:this.url}),[4,r.send(s)];case 1:return i=u.sent(),a=i.as(Gn).readStatus,this._updateUnreadMemberState(t.userId,a.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),rr.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)}))),n.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_READ})),[2]}}))}))},n.prototype.markAsDelivered=function(){return g(this,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:return e=j.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Vn({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return s.sent(),[2]}}))}))},n.prototype.startTyping=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){return e=j.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingStarted>=n&&(this._typingStarted=r,this._typingEnded=0,s=new Kn({channelUrl:this.url,time:this._typingStarted}),t.send(s)),[2]}))}))},n.prototype.endTyping=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s;return y(this,(function(i){return e=j.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingEnded>=n&&(this._typingStarted=0,this._typingEnded=r,s=new Jn({channelUrl:this.url,time:this._typingStarted}),t.send(s)),[2]}))}))},n.prototype.createScheduledUserMessage=function(e){e=i(i({},rt),e),f(st(e)).throw(_.invalidParameters);var t=new Dt;return this._createScheduledUserMessage(e,t),t},n.prototype.updateScheduledUserMessage=function(e,t){return g(this,void 0,void 0,(function(){var n,r,s,a;return y(this,(function(o){switch(o.label){case 0:return n=i(i({},Br),t),f(function(e){return Re(e)&&b("number",e.scheduledAt,!0)}(n)).throw(_.invalidParameters),r=j.of(this._iid).requestQueue,s=new jr(i({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,r.send(s)];case 1:return a=o.sent(),[2,a.as(Oe).message]}}))}))},n.prototype.createScheduledFileMessage=function(e){var t=this;e=i(i({},it),e),f(at(e)).throw(_.invalidParameters);var n=Date.now(),r=this._generateRequestId(),s=new Dt;return pe(He).then((function(){var i=t._createPendingScheduledFileMessage(e,r,n);Y((function(){return g(t,void 0,void 0,(function(){return y(this,(function(e){return[2,s._trigger(i)]}))}))}))})),M(e.file)?this._uploadFileAndUpdateParams(e).then((function(){return t._createScheduledFileMessage(e,s,r,n)})):this._createScheduledFileMessage(e,s,r,n),s},n.prototype.updateScheduledFileMessage=function(e,t){return g(this,void 0,void 0,(function(){var n,r,s;return y(this,(function(a){switch(a.label){case 0:return n=i(i({},qr),t),f(function(e){return Pe(e)&&b("number",e.scheduledAt,!0)&&(M(e.file)||b("string",e.fileUrl))&&b("string",e.fileName,!0)&&b("string",e.mimeType,!0)&&b("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return b("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(n)).throw(_.invalidParameters),M(n.file)?[4,this._uploadFileAndUpdateParams(n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r=new Wr(i({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,j.of(this._iid).requestQueue.send(r)];case 3:return s=a.sent(),[2,s.as(zr).message]}}))}))},n.prototype.cancelScheduledMessage=function(e){return g(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return t=new Qr({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,j.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},n.prototype.sendScheduledMessageNow=function(e){return g(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return t=new Kr({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,j.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},n.prototype.getMyPushTriggerOption=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i;return y(this,(function(a){switch(a.label){case 0:return e=j.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Xr({userId:t.userId,channelUrl:this.url}),[4,n.send(r)];case 1:return s=a.sent(),i=s.as(Zr).pushTriggerOption,this.myPushTriggerOption=i,[2,i]}}))}))},n.prototype.setMyPushTriggerOption=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,o,u;return y(this,(function(c){switch(c.label){case 0:return f(a(fe,e)).throw(_.invalidParameters),t=j.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i=new Yr({userId:r.userId,channelUrl:this.url,pushTriggerOption:e}),[4,s.send(i)];case 1:return o=c.sent(),u=o.as(Jr).pushTriggerOption,this.myPushTriggerOption=u,n.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,u]}}))}))},n.prototype.setMyCountPreference=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,o,u;return y(this,(function(c){switch(c.label){case 0:return f(a(ts,e)).throw(_.invalidParameters),t=j.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i=new Or({channelUrl:this.url,userId:r.userId,countPreference:e}),[4,s.send(i)];case 1:return o=c.sent(),u=o.as(Hr).countPreference,this.myCountPreference=u,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),n.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,u]}}))}))},n.prototype.resetMyHistory=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,s,i;return y(this,(function(a){switch(a.label){case 0:return e=j.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Gr({channelUrl:this.url}),[4,n.send(r)];case 1:return s=a.sent(),i=s.as(Vr).messageOffsetTimestamp,this.messageOffsetTimestamp=i,this.lastMessage&&this.lastMessage.createdAt<i&&(this.lastMessage=null),t.dispatch(new We({channels:[this],source:ze.EVENT_CHANNEL_RESET_HISTORY,isWebSocketEventComing:!0})),[2,this]}}))}))},n.prototype.pinMessage=function(e){return g(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return f(b("number",e)&&e>0).throw(_.invalidParameters),t=j.of(this._iid).requestQueue,n=new $r({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},n.prototype.unpinMessage=function(e){return g(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return f(b("number",e)&&e>0).throw(_.invalidParameters),t=j.of(this._iid).requestQueue,n=new es({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},n.prototype._uploadFileAndUpdateParams=function(e){return g(this,void 0,void 0,(function(){var t,n,r,s,i,a,o,u,c,l,h;return y(this,(function(d){switch(d.label){case 0:return M(e.file)?(t=j.of(this._iid).requestQueue,n=new Pt({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,t.send(n)]):[3,2];case 1:r=d.sent(),s=r.as(kt),i=s.url,a=s.fileSize,o=void 0===a?e.fileSize:a,u=s.thumbnailSizes,c=void 0===u?e.thumbnailSizes:u,l=s.requireAuth,h=void 0!==l&&l,e.fileUrl=i,e.fileSize=o,e.thumbnailSizes=c,e.requireAuth=h,d.label=2;case 2:return[2]}}))}))},n}(xe),ls={},hs=function(){function e(e){var t=e._iid,n=e.limit,r=void 0===n?100:n,s=this;this.ref=0,this._iid=t,this._limit=r;var i,a=j.of(this._iid),o=a.sdkState,u=a.dispatcher,c=a.logger;this._metadataKey=(i=o.userId,"sendbird:".concat(i,"@groupchannel/sync.meta"));var l=function(e){return"sendbird:".concat(e,"@groupchannel/sync")}(o.userId);this._sync=new ir(l,(function(){return g(s,void 0,void 0,(function(){var e,t,n,r,s,i,a,o,u,l;return y(this,(function(h){switch(h.label){case 0:return e={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(h.sent(),c.debug("channel background sync from",null===(a=this._metadata)||void 0===a?void 0:a.token),null===(o=this._metadata)||void 0===o?void 0:o.completed)return[3,9];h.label=2;case 2:return h.trys.push([2,5,,8]),[4,rr.of(this._iid).getMyGroupChannels(null!==(l=null===(u=this._metadata)||void 0===u?void 0:u.token)&&void 0!==l?l:"",{includeEmpty:!0,order:Ge.CHRONOLOGICAL},this._limit,ze.SYNC_CHANNEL_BACKGROUND)];case 3:return t=h.sent(),n=t.channels,r=t.token,e.hasNext=n.length>=this._limit&&!!r,e.nextToken=r,this._metadata&&(this._metadata.token=r,(i=this._metadata.range).extends.apply(i,v([],m(n.map((function(e){return e.createdAt}))),!1)),this._metadata.completed=!e.hasNext),c.debug("channel background sync progress",e),[4,this.saveMetadata()];case 4:return h.sent(),[3,8];case 5:return s=h.sent(),c.debug("channel background sync error",s),s instanceof _&&s.isInvalidTokenError?[4,this.clearMetaData()]:[3,7];case 6:h.sent(),h.label=7;case 7:throw s;case 8:return[3,10];case 9:e.hasNext=!1,e.nextToken="",h.label=10;case 10:return[2,e]}}))}))})),this._connectionEventContext=u.on((function(e){if(e instanceof ee)if(e.stateType===te.CONNECTED)s.resume();else s.pause()}))}return e.of=function(t){return ls[t]||(ls[t]=new e({_iid:t})),ls[t].ref++,ls[t]},e.clear=function(e){ls[e]&&(ls[e].close(),delete ls[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new er({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return g(this,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,j.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={token:e?e.token:"",range:new er(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!e&&e.completed},t.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this._metadata?[4,j.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetaData=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,j.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e,t,n=j.of(this._iid),r=n.logger;n.connectionManager.isConnected&&(r.debug("channel background sync resume()"),this._sync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.token)&&void 0!==t?t:""))},e.prototype.pause=function(){j.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete ls[this._iid])},e}(),ds={},ps=function(){function e(e){var t=e._iid,n=this;this.ref=0,this._iid=t;var r,s=j.of(this._iid),i=s.logger,a=s.sdkState,o=s.dispatcher;this._metadataKey=(r=a.userId,"sendbird:".concat(r,"@groupchannel/changelogs.meta"));var u=function(e){return"sendbird:".concat(e,"@groupchannel/changelogs")}(a.userId);this._sync=new ir(u,(function(){return g(n,void 0,void 0,(function(){var e,t,n,r,s,a,o,u;return y(this,(function(c){switch(c.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:c.sent(),i.debug("channel changelog sync from",null===(a=this._metadata)||void 0===a?void 0:a.token),c.label=2;case 2:return c.trys.push([2,5,,8]),[4,rr.of(this._iid).getMyGroupChannelChangeLogs(null!==(u=null===(o=this._metadata)||void 0===o?void 0:o.token)&&void 0!==u?u:"",{includeEmpty:!0},ze.SYNC_CHANNEL_CHANGELOGS)];case 3:return t=c.sent(),n=t.hasMore,r=t.token,e.hasNext=n,e.nextToken=r,this._metadata&&(this._metadata.token=r),i.debug("channel changelog sync progress",e),[4,this.saveMetadata()];case 4:return c.sent(),[3,8];case 5:return s=c.sent(),i.debug("channel changelog sync error",s),s instanceof _&&s.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:c.sent(),c.label=7;case 7:throw s;case 8:return[2,e]}}))}))})),this._connectionEventContext=o.on((function(e){if(e instanceof ee)if(e.stateType===te.CONNECTED)n.resume();else n.pause()}))}return e.of=function(t){return ds[t]||(ds[t]=new e({_iid:t})),ds[t].ref++,ds[t]},e.clear=function(e){ds[e]&&(ds[e].close(),delete ds[e])},e.prototype.loadMetadata=function(){return g(this,void 0,void 0,(function(){var e,t,n,r;return y(this,(function(s){switch(s.label){case 0:return this._metadata?[3,2]:(e=j.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=s.sent(),this._metadata={token:r?r.token:n},s.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return this._metadata?[4,j.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,j.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){j.of(this._iid).connectionManager.isConnected&&this._sync.start(0)},e.prototype.pause=function(){this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete ds[this._iid])},e}(),fs=function(){function e(e,t){var n=t.filter,r=t.order,s=t.limit,i=this;this.channels=[],this._iid=e,this._key="gcc-".concat(oe()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this.filter=null!=n?n:new Kt,this.order=null!=r?r:Ge.LATEST_LAST_MESSAGE,this._hasMore=!0,this._token="",this._limit=null!=s?s:ye;var a=j.of(this._iid),o=a.sdkState,u=a.cacheContext,c=a.dispatcher;u.localCacheEnabled&&(this._backgroundSync=hs.of(e),this._backgroundSync.resume()),this._changelogSync=ps.of(e),this._changelogSync.resume(),rr.of(this._iid).subscribeGroupChannelEvent(this._key,{onUpdate:function(e,t){if(tt(t)){var n=e.filter((function(e){return i.filter.match(e,o.userId)})),r=e.filter((function(e){return!i.filter.match(e,o.userId)})).map((function(e){return e.url}));n.length>0&&i._addChannelsToView(n,t),r.length>0&&i._removeChannelsFromView(r,t)}},onRemove:function(e,t){i._removeChannelsFromView(e,t)}}),j.of(this._iid).statLogCollector.put(new ie({type:ae.FEATURE_LOCALCACHE,data:{use_local_cache:u.localCacheEnabled,collection_interface:{group_channel:!0}}})),c.on((function(e){e instanceof ee&&(e.stateType===te.CONNECTED?i._isGetRemoteChannelsSucceeded||g(i,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this._revokeLoadMore()];case 1:return e.sent(),[2]}}))})):e.stateType===te.LOGOUT&&i.dispose())}))}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(e){this._handler=e},e.prototype._addChannelsToView=function(e,t,n){var r,s,i,a,o=this;void 0===n&&(n=!1);var u=[],c=[],l=[];try{for(var h=C(e),d=h.next();!d.done;d=h.next()){var p=d.value,f=vr(this.channels,p);f>=0&&this.channels.splice(f,1);var _=mr(this.channels,p,this.order).place;if(f<0)_===this.channels.length?!n&&this._hasMore||(u.push(p),this.channels.push(p)):(u.push(p),this.channels.splice(_,0,p));else switch(t){case ze.EVENT_CHANNEL_UPDATED:case ze.EVENT_MESSAGE_RECEIVED:case ze.SYNC_CHANNEL_CHANGELOGS:case ze.EVENT_MESSAGE_SENT:_!==f&&this._hasMore&&_===this.channels.length?l.push(p):(this.channels.splice(_,0,p),c.push(p));break;default:this.channels.splice(_,0,p),c.push(p)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}if(l.length>0)try{for(var v=C(l),m=v.next();!m.done;m=v.next()){p=m.value;var E=vr(this.channels,p);-1!==E&&this.channels.splice(E,1)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}tt(t)&&Y((function(){return g(o,void 0,void 0,(function(){var e,n,r,s;return y(this,(function(i){return e=new ar(t),u.length>0&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelsAdded)&&this._handler.onChannelsAdded(e,u),c.length>0&&(null===(r=this._handler)||void 0===r?void 0:r.onChannelsUpdated)&&this._handler.onChannelsUpdated(e,c),l.length>0&&(null===(s=this._handler)||void 0===s?void 0:s.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,l.map((function(e){return e.url}))),[2]}))}))}))},e.prototype._removeChannelsFromView=function(e,t){var n,r,s=this,i=[],a=function(e){var t=o.channels.findIndex((function(t){return t.url===e}));t>=0&&(i.push(o.channels[t].url),o.channels.splice(t,1))},o=this;try{for(var u=C(e),c=u.next();!c.done;c=u.next()){a(c.value)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return tt(t)&&i.length>0&&Y((function(){return g(s,void 0,void 0,(function(){var e,n;return y(this,(function(r){return e=new ar(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,i),[2]}))}))})),i},e.prototype._getLocalChannels=function(){return g(this,void 0,void 0,(function(){var e,t;return y(this,(function(n){switch(n.label){case 0:return e=rr.of(this._iid),t=this.channels.length>0?function(e,t){var n,r,s,i;switch(t){case Ge.LATEST_LAST_MESSAGE:return null!==(r=null===(n=e.lastMessage)||void 0===n?void 0:n.createdAt)&&void 0!==r?r:e.createdAt;case Ge.CHRONOLOGICAL:return e.createdAt;case Ge.CHANNEL_NAME_ALPHABETICAL:return e.name;default:return null!==(i=null===(s=e.lastMessage)||void 0===s?void 0:s.createdAt)&&void 0!==i?i:e.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,e.getChannelsFromCache(t,this.filter,this.order,this._limit,t?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,n.sent()]}}))}))},e.prototype._getRemoteChannels=function(){return g(this,void 0,void 0,(function(){var e,t,n;return y(this,(function(r){switch(r.label){case 0:return[4,rr.of(this._iid).getMyGroupChannels(this._token,s(i(i({},this.filter),{order:this.order})),this._limit)];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasMore=!!n,[2,t]}}))}))},e.prototype._revokeLoadMore=function(){return g(this,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:if(this._isDisposed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return e=t.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(e,ze.REQUEST_CHANNEL,!0),[3,4];case 3:return t.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}}))}))},e.prototype.loadMore=function(){return g(this,void 0,void 0,(function(){var e,t,n=this;return y(this,(function(r){switch(r.label){case 0:if(this._isDisposed)throw new _({code:X.COLLECTION_DISPOSED,message:"Collection has been disposed."});return this._hasMore?(e=j.of(this._iid).cacheContext,t=[],e.localCacheEnabled&&this._backgroundSync.completed?[4,S((function(){return g(n,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this._getLocalChannels()];case 1:return t=e.sent(),[2]}}))}))}))]:[3,2]):[3,6];case 1:return r.sent(),this._hasMore=t.length>=this._limit,[3,5];case 2:return r.trys.push([2,4,,5]),[4,this._getRemoteChannels()];case 3:return t=r.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,5];case 4:return r.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,5];case 5:return this._addChannelsToView(t,ze.REQUEST_CHANNEL,!0),[2,t];case 6:return[2,[]]}}))}))},e.prototype.dispose=function(){var e,t;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),rr.of(this._iid).unsubscribeGroupChannelEvent(this._key))},e}(),_s=function(t){function n(e){var n=this,i=e.token,a=e.limit,o=e.order,u=e.includeEmpty,c=e.membershipFilter,l=e.channelNameContainsFilter,h=e.channelUrlsFilter,d=e.customTypesFilter,p=e.customTypeStartsWithFilter,f=e.superChannelFilter,_=e.metadataOrderKeyFilter,v=e.metadataKey,m=e.metadataValues,g=e.metadataValueStartsWith,y=e.includeFrozen,C=e.includeMetaData;return(n=t.call(this)||this).method=D.GET,n.path=O,n.params=r(s({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:u,public_mode:xt.PUBLIC,public_membership_mode:c,name_contains:l,channel_urls:h,custom_types:d,custom_type_startswith:p,super_mode:f,metadata_order_key:_,metadata_key:v,metadata_values:m,metadata_value_startswith:g,show_frozen:y,show_metadata:C})),n}return e(n,t),n}(F),vs=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.channels=[];var s=n.next,i=n.channels,a=n.ts;return r.token=s,i&&i.length>0&&(r.channels=i.map((function(t){return t.ts=a,new cs(e,t)}))),r.ts="number"==typeof a?a:0,r}return e(n,t),n}(R);!function(e){e.ALL="all",e.JOINED="joined"}(us||(us={}));var ms=function(t){function n(e,n){var r,s,i,a,o,u,c,l,h,d,p,f,_,v,m=this;return(m=t.call(this,e,n)||this).includeEmpty=!1,m.includeFrozen=!0,m.includeMetaData=!0,m.channelUrlsFilter=null,m.customTypesFilter=null,m.customTypeStartsWithFilter=null,m.channelNameContainsFilter=null,m.membershipFilter=us.ALL,m.superChannelFilter=Ht.ALL,m.metadataKey=null,m.metadataValues=null,m.metadataOrderKeyFilter=null,m.metadataValueStartsWith=null,m.order=ot.CHRONOLOGICAL,m.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,m.includeFrozen=null===(s=n.includeFrozen)||void 0===s||s,m.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,m.channelUrlsFilter=null!==(a=n.channelUrlsFilter)&&void 0!==a?a:null,m.customTypesFilter=null!==(o=n.customTypesFilter)&&void 0!==o?o:null,m.customTypeStartsWithFilter=null!==(u=n.customTypeStartsWithFilter)&&void 0!==u?u:null,m.channelNameContainsFilter=null!==(c=n.channelNameContainsFilter)&&void 0!==c?c:null,m.membershipFilter=null!==(l=n.membershipFilter)&&void 0!==l?l:us.ALL,m.superChannelFilter=null!==(h=n.superChannelFilter)&&void 0!==h?h:Ht.ALL,m.metadataKey=null!==(d=n.metadataKey)&&void 0!==d?d:null,m.metadataValues=null!==(p=n.metadataValues)&&void 0!==p?p:null,m.metadataOrderKeyFilter=null!==(f=n.metadataOrderKeyFilter)&&void 0!==f?f:null,m.metadataValueStartsWith=null!==(_=n.metadataValueStartsWith)&&void 0!==_?_:null,m.order=null!==(v=n.order)&&void 0!==v?v:ot.CHRONOLOGICAL,m}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&b("boolean",this.includeEmpty)&&b("boolean",this.includeFrozen)&&b("boolean",this.includeMetaData)&&b("string",this.channelNameContainsFilter,!0)&&E("string",this.channelUrlsFilter,!0)&&E("string",this.customTypesFilter,!0)&&b("string",this.customTypeStartsWithFilter,!0)&&a(us,this.membershipFilter)&&a(Ht,this.superChannelFilter)&&a(ot,this.order)&&b("string",this.metadataOrderKeyFilter,!0)&&b("string",this.metadataKey,!0)&&E("string",this.metadataValues,!0)&&b("string",this.metadataValueStartsWith,!0)},n.prototype.next=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,a,o,u,c;return y(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=j.of(this._iid),n=t.requestQueue,t.dispatcher,r=new _s(s(i(i({},this),{token:this._token}))),[4,n.send(r)]):[3,2]):[3,5];case 1:return a=l.sent(),o=a.as(vs),u=o.channels,c=o.token,this._token=c,this._hasNext=!!c,this._isLoading=!1,[2,u];case 2:return[2,e];case 3:throw _.queryInProgress;case 4:return[3,6];case 5:throw _.invalidParameters;case 6:return[2]}}))}))},n}(W),gs=function(t){function n(e){void 0===e&&(e={});var n=t.call(this)||this;return Object.keys(e).forEach((function(t){n.hasOwnProperty(t)&&(n[t]=e[t])})),n}return e(n,t),n}(function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.onUserJoined=_e,e.onUserLeft=_e,e.onUserReceivedInvitation=_e,e.onUserDeclinedInvitation=_e,e.onChannelHidden=_e,e.onUnreadMemberStatusUpdated=_e,e.onUndeliveredMemberStatusUpdated=_e,e.onTypingStatusUpdated=_e,e.onPollUpdated=_e,e.onPollVoted=_e,e.onPollDeleted=_e,e.onPinnedMessageUpdated=_e,e}return e(n,t),n}(gt)),ys=function(t){function n(e){var n=this,i=e.token,a=e.limit,o=e.order,u=e.reverse,c=e.channelUrl,l=e.messageTypeFilter,h=e.scheduledStatus;return(n=t.call(this)||this).method=D.GET,n.path="".concat(H),n.params=r(s({token:i,limit:a,reverse:u,channel_url:c,order:o,message_type:l,status:h})),n}return e(n,t),n}(F),Cs=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.scheduledMessages=[];var s=n.next,i=n.scheduled_messages;return r.token=s,r.scheduledMessages=i.map((function(t){return bt(e,t)})),r}return e(n,t),n}(R),Es=function(t){function n(e,n){var r,s,i,a,o,u=this;return(u=t.call(this,e,n)||this).channelUrl=null,u.order=null,u.reverse=!1,u.scheduledStatus=null,u.messageTypeFilter=N.ALL,u.channelUrl=null!==(r=n.channelUrl)&&void 0!==r?r:null,u.order=null!==(s=n.order)&&void 0!==s?s:null,u.reverse=null!==(i=n.reverse)&&void 0!==i&&i,u.scheduledStatus=null!==(a=n.scheduledStatus)&&void 0!==a?a:null,u.messageTypeFilter=null!==(o=n.messageTypeFilter)&&void 0!==o?o:N.ALL,u}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&b("string",this.channelUrl,!0)&&(a(ut,this.order)||null===this.order)&&b("boolean",this.reverse)&&(E(yt,this.scheduledStatus)||null===this.scheduledStatus)&&a(N,this.messageTypeFilter)},n.prototype.next=function(){return g(this,void 0,void 0,(function(){var e,t,n,r,a,o;return y(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=j.of(this._iid).requestQueue,t=new ys(s(i(i({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(Cs),a=r.scheduledMessages,o=r.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,a];case 2:return[2,[]];case 3:throw _.queryInProgress;case 4:return[3,6];case 5:throw _.invalidParameters;case 6:return[2]}}))}))},n}(W),bs=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="groupChannel",e}return e(n,t),n.prototype.init=function(e,n){var r=n.sdkState,s=n.dispatcher,i=n.sessionManager,a=n.requestQueue,o=n.logger,u=n.onlineDetector,c=n.cacheContext;t.prototype.init.call(this,e,{sdkState:r,dispatcher:s,sessionManager:i,requestQueue:a,logger:o,onlineDetector:u,cacheContext:c}),this._manager=new rr(e,{sdkState:r,cacheContext:c,dispatcher:s,sessionManager:i,requestQueue:a,logger:o})},n.prototype.createGroupChannelCollection=function(e){return void 0===e&&(e={}),new fs(this._iid,e)},n.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new $n(this._iid,e)},n.prototype.createPublicGroupChannelListQuery=function(e){return void 0===e&&(e={}),new ms(this._iid,e)},n.prototype.createScheduledMessageListQuery=function(e){return void 0===e&&(e={}),new Es(this._iid,e)},n.prototype.addGroupChannelHandler=function(e,t){f(b("string",e)&&t instanceof gs).throw(_.invalidParameters),this._manager.addHandler(e,t)},n.prototype.removeGroupChannelHandler=function(e){f(b("string",e)).throw(_.invalidParameters),this._manager.removeHandler(e)},n.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},n.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},n.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},n.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},n.prototype.getChannel=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){return f(b("string",e)).throw(_.invalidParameters),[2,this._manager.getChannel(e)]}))}))},n.prototype.getChannelWithoutCache=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){return f(b("string",e)).throw(_.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]}))}))},n.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return void 0===t&&(t={}),g(this,void 0,void 0,(function(){var n;return y(this,(function(r){switch(r.label){case 0:return n=i(i({},Zt),t),f(b("string",e)&&$t(n)).throw(_.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},n.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return void 0===t&&(t={}),g(this,void 0,void 0,(function(){var n;return y(this,(function(r){switch(r.label){case 0:return n=i(i({},Zt),t),f(b("number",e)&&$t(n)).throw(_.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},n.prototype.getGroupChannelCount=function(e){return g(this,void 0,void 0,(function(){var t;return y(this,(function(n){return t=i(i({},en),e),f(tn(t)).throw(_.invalidParameters),[2,this._manager.getGroupChannelCount(t)]}))}))},n.prototype.getUnreadItemCount=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,t.sent()]}}))}))},n.prototype.getTotalUnreadChannelCount=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}}))}))},n.prototype.getTotalUnreadMessageCount=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,t.sent()]}}))}))},n.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,t.sent()]}}))}))},n.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},n.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},n.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},n.prototype.createChannel=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){var t;return y(this,(function(n){return t=i(i({},Jt),e),f(Xt(t)).throw(_.invalidParameters),[2,this._manager.createChannel(t)]}))}))},n.prototype.createDistinctChannelIfNotExist=function(e){return void 0===e&&(e={}),g(this,void 0,void 0,(function(){var t;return y(this,(function(n){return t=i(i({},Jt),e),f(Xt(t)).throw(_.invalidParameters),t&&(t.isDistinct=!0),[2,this.createChannel(t)]}))}))},n.prototype.createChannelWithUserIds=function(e,t,n,r,s,a){return void 0===t&&(t=!1),void 0===s&&(s=""),void 0===a&&(a=""),g(this,void 0,void 0,(function(){var o;return y(this,(function(u){return o=i(i({},Jt),{invitedUserIds:e,isDistinct:t,name:n,data:s,customType:a}),"string"==typeof r?o.coverUrl=r:o.coverImage=r,[2,this.createChannel(o)]}))}))},n.prototype.markAsReadAll=function(){return g(this,void 0,void 0,(function(){return y(this,(function(e){return this._manager.markAsReadAll(),[2]}))}))},n.prototype.markAsReadWithChannelUrls=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){return f(E("string",e)).throw(_.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]}))}))},n.prototype.markAsDelivered=function(e){return g(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return f(b("string",e)).throw(_.invalidParameters),[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},n}(ve);export{ts as CountPreference,cs as GroupChannel,fs as GroupChannelCollection,ar as GroupChannelEventContext,Kt as GroupChannelFilter,gs as GroupChannelHandler,$n as GroupChannelListQuery,bs as GroupChannelModule,Wt as GroupChannelSearchField,Vt as HiddenChannelFilter,rs as HiddenState,zt as Member,Nr as MemberListOrder,Lr as MemberListQuery,Rt as MemberState,Sr as MemberStateFilter,us as MembershipFilter,Tr as MessageCollection,Ur as MessageCollectionInitHandler,sr as MessageCollectionInitPolicy,or as MessageEventContext,Mr as MutedMemberFilter,ns as MutedState,Ot as MyMemberStateFilter,qt as OperatorFilter,ss as PinnedMessage,os as PinnedMessageListQuery,xt as PublicChannelFilter,ms as PublicGroupChannelListQuery,Bt as QueryType,jt as ReadStatus,Es as ScheduledMessageListQuery,Ht as SuperChannelFilter,Gt as UnreadChannelFilter,Qt as UnreadItemKey};
