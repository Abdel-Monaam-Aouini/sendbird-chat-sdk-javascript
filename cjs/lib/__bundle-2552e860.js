"use strict";var e=require("./__bundle-2596e4e9.js"),t=require("./__bundle-0e2baf5f.js"),s=require("./__bundle-838cae54.js");class n extends e.User{constructor(e,s){super(e,s),this.restrictionInfo=new t.RestrictionInfo(s)}static payloadify(s){return e.deundefined(e.undefineNullProps(Object.assign(Object.assign({},super.payloadify(s)),t.RestrictionInfo.payloadify(s.restrictionInfo))))}}class a extends e.APIRequestCommand{constructor({channelUrl:t,channelType:s,token:n,limit:a}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(s)}/${encodeURIComponent(t)}/operators`,this.params={token:n,limit:a}}}class i extends e.APIResponseCommand{constructor(t,s){super(t,s),this.operators=s.operators.map((s=>new e.User(t,s))),this.token=s.next}}class r extends e.ChannelDataListQuery{constructor(e,t,s,n){super(e,t,s,n)}_validate(){return super._validate()}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;{const t=[];if(this._hasNext){this._isLoading=!0;const{requestQueue:t}=e.Vault.of(this._iid),s=new a(Object.assign(Object.assign({},this),{channelUrl:this.channelUrl,token:this._token})),n=yield t.send(s),{operators:r,token:o}=n.as(i);return this._token=o,this._hasNext=!!o,this._isLoading=!1,r}return t}}throw e.SendbirdError.invalidParameters}))}}class o extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,limit:a,token:i}=t;super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/mute`,this.params={limit:a,token:i}}}class d extends e.APIResponseCommand{constructor(e,t){super(e,t),this.mutedUsers=[];const{next:s,muted_list:a}=t;this.token=s,a&&a.length>0&&(this.mutedUsers=a.map((t=>new n(e,t))))}}class l extends e.ChannelDataListQuery{constructor(e,t,s,n){super(e,t,s,n)}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;if(this._hasNext){this._isLoading=!0;const{requestQueue:t}=e.Vault.of(this._iid),s=new o(Object.assign(Object.assign({},this),{token:this._token})),n=yield t.send(s),{mutedUsers:a,token:i}=n.as(d);return this._token=i,this._hasNext=!!i,this._isLoading=!1,a}return[]}throw e.SendbirdError.invalidParameters}))}}class u extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,limit:a,token:i}=t;super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/ban`,this.params=e.deundefined({limit:a,token:i})}}class c extends e.APIResponseCommand{constructor(e,t){super(e,t),this.bannedUsers=[];const{next:s,banned_list:a}=t;this.token=s,a&&a.length>0&&(this.bannedUsers=a.map((t=>new n(e,t.user))))}}class h extends e.ChannelDataListQuery{constructor(e,t,s,n){super(e,t,s,n)}_validate(){return super._validate()}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;if(this._hasNext){this._isLoading=!0;const{requestQueue:t}=e.Vault.of(this._iid),s=new u(Object.assign(Object.assign({},this),{token:this._token})),n=yield t.send(s),{bannedUsers:a,token:i}=n.as(c);return this._token=i,this._hasNext=!!i,this._isLoading=!1,a}return[]}throw e.SendbirdError.invalidParameters}))}}class p extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,operatorUserIds:a}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/operators`,this.params={operator_ids:a}}}class m extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,operatorUserIds:a}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/operators`,this.params={operator_ids:a}}}class g extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,userId:a}=t;super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/mute/${a}`}}class _ extends e.APIResponseCommand{constructor(e,t){super(e,t),this.isMuted=!1,this.startAt=0,this.endAt=0;const{is_muted:s,start_at:n,end_at:a,remaining_duration:i,description:r}=t;this.isMuted=s,this.startAt=n,this.endAt=a,this.remainingDuration=i,this.description=r}}class y extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,keys:a}=t;super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metadata`,this.params={keys:a,include_ts:!0}}}class v extends e.APIResponseCommand{constructor(e,t){super(e,t);const{metadata:s,ts:n}=t;this.metadata=s,this.ts=n}}class f extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,metadata:a}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metadata`,this.params={metadata:a,include_ts:!0}}}class M extends e.APIResponseCommand{constructor(e,t){var s,n;super(e,t),this.metaData=null!==(s=t.metadata)&&void 0!==s?s:{},this.ts=null!==(n=t.ts)&&void 0!==n?n:null}}class T extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,metadata:a,upsert:i}=t;super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metadata`,this.params={metadata:a,include_ts:!0,upsert:null!=i&&i}}}class I extends e.APIResponseCommand{constructor(e,t){super(e,t);const{metadata:s,ts:n}=t;this.metadata=s,this.ts=n}}class P extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),s.data&&(this.created=s.data.created,this.updated=s.data.updated,this.deleted=s.data.deleted)}}class C extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,key:a}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metadata/${a}`,this.params={include_ts:!0}}}class E extends e.APIResponseCommand{constructor(e,t){super(e,t);const{ts:s}=t;this.ts=s}}class U extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metadata`,this.params={include_ts:!0}}}class A extends e.APIResponseCommand{constructor(e,t){super(e,t);const{ts:s}=t;this.ts=s}}class S extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,keys:a}=t;super(),this.method=e.APIRequestMethod.GET,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metacounter`,this.params={keys:a}}}class w extends e.APIResponseCommand{constructor(e,t){super(e,t),this.metaCounter=t}}class b extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,metaCounter:a}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metacounter`,this.params={metacounter:a}}}class R extends e.APIResponseCommand{constructor(e,t){super(e,t),this.metaCounter=t}}class O extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,metaCounter:a,upsert:i=!1,mode:r="set"}=t;super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metacounter`,this.params={metacounter:a,upsert:i,mode:r}}}class q extends e.APIResponseCommand{constructor(e,t){super(e,t),this.metaCounter=t}}class D extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),s.data&&(this.created=s.data.created,this.updated=s.data.updated,this.deleted=s.data.deleted)}}class x extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,key:a}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metacounter/${a}`,this.params={}}}class L extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/metacounter`,this.params={}}}class F extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,userId:a,seconds:i,description:r}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/mute`,this.params={user_id:a,seconds:i,description:r}}}class k extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),this.user=new n(e,s.data)}}class V extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,userId:a}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/mute/${encodeURIComponent(a)}`}}class $ extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),this.user=new n(e,s.data)}}class N extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,userId:a,seconds:i,description:r}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/ban`,this.params=e.deundefined({user_id:a,seconds:i,description:r})}}class j extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),this.user=new n(e,s.data),s.data.member_count&&(this.memberCount=s.data.member_count),s.data.joined_member_count&&(this.joinedMemberCount=s.data.joined_member_count)}}class Q extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,userId:a}=t;super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/ban/${encodeURIComponent(a)}`}}class B extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),this.user=new n(e,s.data)}}class G extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,freezing:a}=t;super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.getChannelApiPathByType(n)}/${encodeURIComponent(s)}/freeze`,this.params={freeze:a}}}class z extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"SYEV",s),this.freeze=s.data.freeze}}class W extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,category:a,userId:i,description:r}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getReportApiPathByType(n)}/${encodeURIComponent(s)}`,this.params={report_category:a,reporting_user_id:i,report_description:r}}}class H extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,category:a,userId:i,offendingUserId:r,description:o}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_REPORT}/users/${r}`,this.params={channel_url:s,channel_type:n===e.ChannelType.OPEN?"open_channels":"group_channels",report_category:a,reporting_user_id:i,report_description:o}}}class Y extends e.APIRequestCommand{constructor(t){const{channelUrl:s,channelType:n,category:a,userId:i,offendingUserId:r,messageId:o,description:d}=t;super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getReportApiPathByType(n)}/${encodeURIComponent(s)}/messages/${o}`,this.params={report_category:a,reporting_user_id:i,report_description:d,offending_user_id:r}}}class K extends e.WebSocketRequestCommand{constructor(t){let s=[];t.mentionType===e.MentionType.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map((e=>e.userId)))),super({code:"MESG",ackRequired:!0,payload:e.deundefined(e.undefineNullProps({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:s,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==e.PushNotificationDeliveryOption.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage}))})}}class J extends e.WebSocketEventCommand{constructor(s,n,a){var i,r,o,d;super(s,"MESG",a),this.message=new t.UserMessage(s,a);const{sdkState:l}=e.Vault.of(s);this.isMentioned=e.checkIfMentioned(this.message.mentionType,null!==(o=null!==(i=this.message.mentionedUserIds)&&void 0!==i?i:null===(r=this.message.mentionedUsers)||void 0===r?void 0:r.map((e=>e.userId)))&&void 0!==o?o:[],l.userId),this.forceUpdateLastMessage=null!==(d=a.force_update_last_message)&&void 0!==d&&d}}class X extends e.WebSocketRequestCommand{constructor(s){let n=null;s.mentionType===e.MentionType.USERS&&(s.mentionedUserIds?n=s.mentionedUserIds:s.mentionedUsers&&(n=s.mentionedUsers.map((e=>e.userId)))),super({code:"MEDI",ackRequired:!0,payload:e.deundefined(e.undefineNullProps({channel_url:s.channelUrl,msg_id:s.messageId,message:s.message,data:s.data,custom_type:s.customType,metaarray:s.metaArrayParams,mention_type:s.mentionType,mentioned_user_ids:n,mentioned_message_template:s.mentionedMessageTemplate,apple_critical_alert_options:s.appleCriticalAlertOptions?t.AppleCriticalAlertOptions.payloadify(s.appleCriticalAlertOptions):null,poll_id:s.pollId}))})}}class Z extends e.WebSocketEventCommand{constructor(s,n,a){var i,r,o,d,l;super(s,"MEDI",a),this.message=new t.UserMessage(s,a);const{sdkState:u}=e.Vault.of(s);this.mentionCountChange=e.calculateMentionCountChange({mentionType:null===(i=a.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(o=null===(r=a.old_values)||void 0===r?void 0:r.mentioned_user_ids)&&void 0!==o?o:[]},e.undefineNullProps({mentionType:this.message.mentionType,mentionedUserIds:null!==(d=this.message.mentionedUserIds)&&void 0!==d?d:null===(l=this.message.mentionedUsers)||void 0===l?void 0:l.map((e=>e.userId))}),u.userId)}}class ee extends e.WebSocketRequestCommand{constructor(t){let s=null;t.mentionType===e.MentionType.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map((e=>e.userId)))),super({code:"FEDI",ackRequired:!0,payload:e.deundefined(e.undefineNullProps({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:s,apple_critical_alert_options:t.appleCriticalAlertOptions}))})}}class te extends e.WebSocketEventCommand{constructor(s,n,a){var i,r,o,d,l;super(s,"FEDI",a),this.message=new t.FileMessage(s,a);const{sdkState:u}=e.Vault.of(s);this.mentionCountChange=e.calculateMentionCountChange({mentionType:null===(i=a.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(o=null===(r=a.old_values)||void 0===r?void 0:r.mentioned_user_ids)&&void 0!==o?o:[]},e.undefineNullProps({mentionType:this.message.mentionType,mentionedUserIds:null!==(d=this.message.mentionedUserIds)&&void 0!==d?d:null===(l=this.message.mentionedUsers)||void 0===l?void 0:l.map((e=>e.userId))}),u.userId)}}class se extends e.APIRequestCommand{constructor(t){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(t.channelType)}/${t.channelUrl}/messages/${t.messageId}`}}class ne extends e.WebSocketEventCommand{constructor(e,t,s){super(e,"DELM",s),this.channelUrl=s.channel_url,this.channelType=s.channel_type,this.messageId=Number(s.msg_id)}}class ae extends e.APIRequestCommand{constructor({channelType:t,channelUrl:s,messageId:n,reactionKey:a}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(t)}/${encodeURIComponent(s)}/messages/${n}/reactions`,this.params={reaction:a}}}class ie extends e.APIResponseCommand{constructor(e,s){super(e,s),this.reactionEvent=new t.ReactionEvent(s)}}class re extends e.APIRequestCommand{constructor({channelType:t,channelUrl:s,messageId:n,reactionKey:a}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.getChannelApiPathByType(t)}/${encodeURIComponent(s)}/messages/${n}/reactions`,this.params={reaction:a}}}class oe extends e.APIResponseCommand{constructor(e,s){super(e,s),this.reactionEvent=new t.ReactionEvent(Object.assign({},s))}}class de extends e.APIRequestCommand{constructor({channelType:t,channelUrl:s,messageId:n,translationTargetLanguages:a}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(t)}/${encodeURIComponent(s)}/messages/${encodeURIComponent(n)}/translation`,this.params={target_langs:a}}}class le extends e.APIResponseCommand{constructor(e,s){super(e,s),this.message=new t.UserMessage(e,s)}}class ue extends e.APIRequestCommand{constructor(s){var n;super();let a=[];s.mentionType===e.MentionType.USERS&&(s.mentionedUserIds?a=s.mentionedUserIds:s.mentionedUsers&&(a=s.mentionedUsers.map((e=>e.userId))));const{channelType:i,channelUrl:r}=s;this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(i)}/${encodeURIComponent(r)}/scheduled_messages`,this.params=e.deundefined(e.undefineNullProps({req_id:s.reqId,scheduled_at:s.scheduledAt,message_type:e.ServerSideMessageType.USER,message:s.message,custom_type:s.customType,data:s.data,mention_type:s.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(n=s.metaArrays)||void 0===n?void 0:n.map((e=>t.MessageMetaArray.payloadify(e))),apple_critical_alert_options:s.appleCriticalAlertOptions?t.AppleCriticalAlertOptions.payloadify(s.appleCriticalAlertOptions):null,target_langs:s.translationTargetLanguages,push_option:s.pushNotificationDeliveryOption}))}}class ce extends e.APIResponseCommand{constructor(e,s){super(e,s),this.message=new t.UserMessage(e,s)}}class he extends e.APIRequestCommand{constructor(s){var n;super();let a=[];s.mentionType===e.MentionType.USERS&&(s.mentionedUserIds?a=s.mentionedUserIds:s.mentionedUsers&&(a=s.mentionedUsers.map((e=>e.userId))));const{channelType:i,channelUrl:r}=s;this.method=e.APIRequestMethod.POST,this.path=`${e.getChannelApiPathByType(i)}/${encodeURIComponent(r)}/scheduled_messages`,this.params=e.undefineNullProps({req_id:s.reqId,scheduled_at:s.scheduledAt,message_type:e.ServerSideMessageType.FILE,url:s.fileUrl,file_name:s.fileName,file_size:s.fileSize,file_type:s.mimeType,thumbnails:s.thumbnailSizes?s.thumbnailSizes.map((e=>t.Thumbnail.payloadify(e))):[],custom_type:s.customType,data:s.data,require_auth:s.requireAuth,mention_type:s.mentionType,mentioned_user_ids:a,sorted_metaarray:null===(n=s.metaArrays)||void 0===n?void 0:n.map((e=>t.MessageMetaArray.payloadify(e))),apple_critical_alert_options:s.appleCriticalAlertOptions?t.AppleCriticalAlertOptions.payloadify(s.appleCriticalAlertOptions):null,push_option:s.pushNotificationDeliveryOption})}}class pe extends e.APIResponseCommand{constructor(e,s){super(e,s),this.message=new t.FileMessage(e,s)}}class me extends e.APIRequestCommand{constructor({pollId:t,title:s,data:n,allowUserSuggestion:a,allowMultipleVotes:i,closeAt:r}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(t)}`,this.params={title:s,data:n,allow_user_suggestion:a,allow_multiple_votes:i,close_at:r}}}class ge extends e.APIResponseCommand{constructor(t,s){super(t,s),this.poll=new e.Poll(t,s)}}class _e extends e.APIRequestCommand{constructor({pollId:t}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(t)}`}}class ye extends e.APIRequestCommand{constructor({pollId:t}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(t)}/close`}}class ve extends e.APIResponseCommand{constructor(t,s){super(t,s),this.poll=new e.Poll(t,s)}}class fe extends e.APIRequestCommand{constructor({channelUrl:t,channelType:s,pollId:n,optionText:a}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(n)}/options`,this.params={channel_url:t,channel_type:s,text:a}}}class Me extends e.APIResponseCommand{constructor(t,s){super(t,s),this.poll=new e.Poll(t,s)}}class Te extends e.APIRequestCommand{constructor({pollId:t,pollOptionId:s,optionText:n}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(t)}/options/${encodeURIComponent(s)}`,this.params={text:n}}}class Ie extends e.APIResponseCommand{constructor(t,s){super(t,s),this.poll=new e.Poll(t,s)}}class Pe extends e.APIRequestCommand{constructor({pollId:t,pollOptionId:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_POLLS}/${encodeURIComponent(t)}/options/${encodeURIComponent(s)}`}}class Ce extends e.WebSocketRequestCommand{constructor({reqId:t,channelType:s,channelUrl:n,pollId:a,pollOptionIds:i}){super({code:"VOTE",ackRequired:!0,payload:e.deundefined({req_id:t,channel_type:s===e.ChannelType.OPEN?"open_channels":"group_channels",channel_url:n,poll_id:a,option_ids:i})})}}class Ee extends e.WebSocketEventCommand{constructor(e,t,n){super(e,"VOTE",n),this.event=new s.PollVoteEvent(n),this.channelUrl=n.channel_url,this.channelType=n.channel_type}}class Ue extends e.InstancedObject{get url(){return this._url}get name(){return this._name}set name(e){this._name=e}get createdAt(){return this._createdAt}toJSON(){return Object.assign(Object.assign({},this),{url:this._url,name:this._name,createdAt:this._createdAt})}constructor(t,s){var n,a,i,r,o,d;super(t),this._name="",this._createdAt=0,this.channelType=e.ChannelType.BASE,this.coverUrl="",this.customType="",this.data="",this.isFrozen=!1,this.isEphemeral=!1,this.creator=null,this._messageCollectionLastAccessedAt=0,this._url=s.channel_url,this._name=null!==(n=s.name)&&void 0!==n?n:"",this._createdAt=1e3*s.created_at,this.coverUrl=null!==(a=s.cover_url)&&void 0!==a?a:"",this.customType=null!==(i=s.custom_type)&&void 0!==i?i:"",this.data=null!==(r=s.data)&&void 0!==r?r:"",this.isFrozen=null!==(o=s.freeze)&&void 0!==o&&o,this.isEphemeral=null!==(d=s.is_ephemeral)&&void 0!==d&&d,this.creator=s.created_by?new e.User(this._iid,s.created_by):null,s.metadata&&Object.keys(s.metadata).length>0&&s.ts&&(this._cachedMetaData=new Map,Object.keys(s.metadata).forEach((e=>{this._cachedMetaData.set(e,{value:s.metadata[e],isRemoved:!1,updatedAt:s.ts})})))}static payloadify(t){return e.deundefined(e.undefineNullProps(Object.assign(Object.assign({},super.payloadify(t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?e.User.payloadify(t.creator):null,created_at:t.createdAt/1e3})))}isGroupChannel(){return this.channelType===e.ChannelType.GROUP}isOpenChannel(){return this.channelType===e.ChannelType.OPEN}isFeedChannel(){return this.channelType===e.ChannelType.FEED}get cachedMetaData(){const e={};return this._cachedMetaData?(this._cachedMetaData.forEach(((t,s)=>{t.isRemoved||(e[s]=t.value)})),e):e}get messageCollectionLastAccessedAt(){return this._messageCollectionLastAccessedAt}_updateMessageCollectionLastAccessedAt(){this._messageCollectionLastAccessedAt=Date.now()}_update(t){const s=e.deundefined(t);Object.assign(this,s)}_upsertCachedMetaData(e,t){Object.keys(e).forEach((s=>{this._cachedMetaData||(this._cachedMetaData=new Map);const n=this._cachedMetaData.get(s);(!n||n.updatedAt<=t)&&this._cachedMetaData.set(s,{value:e[s],isRemoved:!1,updatedAt:t})}))}_updateCachedMetaData(e,t){this._cachedMetaData?this._cachedMetaData.forEach(((s,n)=>{var a;s.updatedAt<=t&&this._cachedMetaData.set(n,{value:null!==(a=e[n])&&void 0!==a?a:s.value,isRemoved:!e[n],updatedAt:t})})):(this._cachedMetaData=new Map,Object.keys(e).forEach((s=>{this._cachedMetaData.set(s,{value:e[s],isRemoved:!1,updatedAt:t})})))}_removeFromCachedMetaData(e,t){this._cachedMetaData&&e.forEach((e=>{const s=this._cachedMetaData.get(e);s&&s.updatedAt<t&&(s.isRemoved=!0,s.updatedAt=t)}))}_runIfHandleableWithGroupChannel(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)}_generateRequestId(){return`rq-${e.uuid()}`}isIdentical(e){return e&&this.url===e.url}isEqual(t){return e.deepEqual(this,t)}createOperatorListQuery(e={}){return new r(this._iid,this.url,this.channelType,e)}createMutedUserListQuery(e={}){return new l(this._iid,this.url,this.channelType,e)}createBannedUserListQuery(e={}){return new h(this._iid,this.url,this.channelType,e)}createPreviousMessageListQuery(e={}){return new t.PreviousMessageListQuery(this._iid,this.url,this.channelType,e)}addOperators(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new p({channelUrl:this.url,channelType:this.channelType,operatorUserIds:t});yield s.send(n)}))}removeOperators(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new m({channelUrl:this.url,channelType:this.channelType,operatorUserIds:t});yield s.send(n)}))}getMyMutedInfo(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),n=new g({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),a=yield s.send(n),{isMuted:i,startAt:r,endAt:o,remainingDuration:d,description:l}=a.as(_);return{isMuted:i,startAt:r,endAt:o,remainingDuration:d,description:l}}))}getMetaData(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new y({channelUrl:this.url,channelType:this.channelType,keys:t}),a=yield s.send(n),{metadata:i,ts:r}=a.as(v);return this._upsertCachedMetaData(i,r),i}))}getAllMetaData(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new y({channelUrl:this.url,channelType:this.channelType,keys:[]}),n=yield t.send(s),{metadata:a,ts:i}=n.as(v);return this._updateCachedMetaData(a,i),a}))}createMetaData(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),n=new f({channelUrl:this.url,channelType:this.channelType,metadata:t}),a=yield s.send(n),{metaData:i}=a.as(M);return this._upsertCachedMetaData(i,0),i}))}updateMetaData(t,s=!1){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:n}=e.Vault.of(this._iid),a=new T({channelUrl:this.url,channelType:this.channelType,metadata:t,upsert:s}),i=yield n.send(a),{metadata:r,ts:o}=i.as(I);return this._upsertCachedMetaData(r,o),r}))}deleteMetaData(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new C({channelUrl:this.url,channelType:this.channelType,key:t}),a=yield s.send(n),{ts:i}=a.as(E);this._removeFromCachedMetaData([t],i)}))}deleteAllMetaData(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new U({channelUrl:this.url,channelType:this.channelType}),n=yield t.send(s),{ts:a}=n.as(A);this._removeFromCachedMetaData([...this._cachedMetaData.keys()],a)}))}getMetaCounters(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new S({channelUrl:this.url,channelType:this.channelType,keys:t}),a=yield s.send(n),{metaCounter:i}=a.as(w);return i}))}getAllMetaCounters(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new S({channelUrl:this.url,channelType:this.channelType,keys:[]}),n=yield t.send(s),{metaCounter:a}=n.as(w);return a}))}createMetaCounters(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),n=new b({channelUrl:this.url,channelType:this.channelType,metaCounter:t}),a=yield s.send(n),{metaCounter:i}=a.as(R);return i}))}updateMetaCounters(t,s=!1){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:n}=e.Vault.of(this._iid),a=new O({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:s}),i=yield n.send(a),{metaCounter:r}=i.as(q);return r}))}increaseMetaCounters(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),n=new O({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:!1,mode:"increase"}),a=yield s.send(n),{metaCounter:i}=a.as(q);return i}))}decreaseMetaCounters(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),n=new O({channelUrl:this.url,channelType:this.channelType,metaCounter:t,upsert:!1,mode:"decrease"}),a=yield s.send(n),{metaCounter:i}=a.as(q);return i}))}deleteMetaCounter(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new x({channelUrl:this.url,channelType:this.channelType,key:t});yield s.send(n)}))}deleteAllMetaCounters(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new L({channelUrl:this.url,channelType:this.channelType});yield t.send(s)}))}muteUser(t,s,n){return e.__awaiter(this,void 0,void 0,(function*(){return this.muteUserWithUserId(t.userId,s,n)}))}muteUserWithUserId(t,s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)&&e.isTypeOf("number",s,!0)&&e.isTypeOf("string",n,!0)).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new F({channelUrl:this.url,channelType:this.channelType,userId:t,seconds:s,description:n});yield a.send(i)}))}unmuteUser(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.unmuteUserWithUserId(t.userId)}))}unmuteUserWithUserId(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new V({channelUrl:this.url,channelType:this.channelType,userId:t});yield s.send(n)}))}banUser(t,s,n){return e.__awaiter(this,void 0,void 0,(function*(){return this.banUserWithUserId(t.userId,s,n)}))}banUserWithUserId(t,s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)&&e.isTypeOf("number",s,!0)&&e.isTypeOf("string",n,!0)).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new N({channelUrl:this.url,channelType:this.channelType,userId:t,seconds:s,description:n});yield a.send(i)}))}unbanUser(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.unbanUserWithUserId(t.userId)}))}unbanUserWithUserId(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{requestQueue:s}=e.Vault.of(this._iid),n=new Q({channelUrl:this.url,channelType:this.channelType,userId:t});yield s.send(n)}))}freeze(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new G({channelUrl:this.url,channelType:this.channelType,freezing:!0});yield t.send(s),this.isFrozen=!0}))}unfreeze(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new G({channelUrl:this.url,channelType:this.channelType,freezing:!1});yield t.send(s),this.isFrozen=!1}))}getMessagesByMessageId(s,n){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.MessageListParamsDefault),n);e.unless(e.isTypeOf("number",s)&&t.validateMessageListParams(a)).throw(e.SendbirdError.invalidParameters);const i=t.MessageManager.of(this._iid);return yield i.getMessagesByMessageId(this.url,this.channelType,s,a)}))}getMessagesByTimestamp(s,n){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.MessageListParamsDefault),n);e.unless(e.isTypeOf("number",s)&&t.validateMessageListParams(a)).throw(e.SendbirdError.invalidParameters);const i=t.MessageManager.of(this._iid);return yield i.getMessagesByTimestamp(this.url,this.channelType,s,a)}))}getMessageChangeLogsSinceTimestamp(s,n={}){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.MessageChangeLogsParamsDefault),n);e.unless(e.isTypeOf("number",s)&&t.validateMessageChangeLogsParams(a)).throw(e.SendbirdError.invalidParameters);const i=t.MessageManager.of(this._iid);return yield i.getMessageChangelogs(this.url,this.channelType,s,a)}))}getMessageChangeLogsSinceToken(s,n={}){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.MessageChangeLogsParamsDefault),n);e.unless(e.isTypeOf("string",s)&&t.validateMessageChangeLogsParams(a)).throw(e.SendbirdError.invalidParameters);const i=t.MessageManager.of(this._iid);return yield i.getMessageChangelogs(this.url,this.channelType,s,a)}))}_createPendingSendableMessagePayload(s,n,a){var i;const{sessionManager:r}=e.Vault.of(this._iid);return e.deundefined(e.undefineNullProps({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:s.parentMessageId,data:s.data,custom_type:s.customType,mention_type:s.mentionType,sorted_metaarray:s.metaArrays?s.metaArrays.map((e=>t.MessageMetaArray.payloadify(e))):null,apple_critical_alert_options:s.appleCriticalAlertOptions?t.AppleCriticalAlertOptions.payloadify(s.appleCriticalAlertOptions):null,created_at:a,user:r.currentUser?t.Sender.payloadify(r.currentUser):null,req_id:n,request_state:e.SendingStatus.PENDING,mentioned_user_ids:s.mentionedUserIds,mentioned_users:null===(i=s.mentionedUsers)||void 0===i?void 0:i.map((t=>e.User.payloadify(t)))}))}_createPendingUserMessage(s,n,a){const i={};if(s.translationTargetLanguages)for(const e of s.translationTargetLanguages)i[e]="";const r=e.deundefined(Object.assign(Object.assign({},this._createPendingSendableMessagePayload(s,n,a)),{type:e.MessageType.USER,message:s.message,translations:i})),o=new t.UserMessage(this._iid,r);return o.messageParams=s,o}_createPendingScheduledUserMessage(e,t,s){const n=this._createPendingUserMessage(e,t,s);return n.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},n}_createPendingFileMessage(s,n,a){var i,r,o,d,l,u;const c=e.deundefined(Object.assign(Object.assign({},this._createPendingSendableMessagePayload(s,n,a)),{type:e.MessageType.FILE,url:s.fileUrl,file:{name:null!==(i=s.fileName)&&void 0!==i?i:null===(r=s.file)||void 0===r?void 0:r.name,size:null!==(o=s.fileSize)&&void 0!==o?o:null===(d=s.file)||void 0===d?void 0:d.size,type:null!==(l=s.mimeType)&&void 0!==l?l:null===(u=s.file)||void 0===u?void 0:u.type,data:s.data},thumbnails:s.thumbnailSizes?s.thumbnailSizes.map((e=>({url:"",width:e.maxWidth,height:e.maxHeight}))):[]})),h=new t.FileMessage(this._iid,c);return h.messageParams=s,h}_createPendingMultipleFilesMessage(s,n,a){const i=e.deundefined(Object.assign(Object.assign({},this._createPendingSendableMessagePayload(s,n,a)),{type:e.MessageType.FILE})),r=new t.MultipleFilesMessage(this._iid,i);return r.messageParams=s,r}_createPendingScheduledFileMessage(e,t,s){const n=this._createPendingFileMessage(e,t,s);return n.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},n}_markMessageAsFailed(t,s,n=!1){t.errorCode=s.code,s.code===e.SendbirdErrorCode.REQUEST_CANCELED||s.code===e.SendbirdErrorCode.FILE_UPLOAD_CANCEL_FAILED?t.sendingStatus=e.SendingStatus.CANCELED:n||(t.sendingStatus=e.SendingStatus.FAILED)}sendUserMessage(s){const n=Object.assign(Object.assign({},t.UserMessageCreateParamsDefault),s);return e.unless(t.validateUserMessageCreateParams(n)).throw(e.SendbirdError.invalidParameters),this._sendUserMessage(n)}_sendUserMessage(s,n,a=!1){const{dispatcher:i,requestQueue:r}=e.Vault.of(this._iid);let o=null!=n?n:this._generateRequestId();const d=Date.now(),l=new t.MessageRequestHandler;return o||(o=this._generateRequestId()),e.sleep(2).then((()=>{const t=this._createPendingUserMessage(s,o,d);i.dispatch(new e.MessageUpdateEventCommand({messages:[t],source:a?e.CollectionEventSource.LOCAL_MESSAGE_RESEND_STARTED:e.CollectionEventSource.EVENT_MESSAGE_SENT_PENDING})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._trigger(t)}))));const n=new K(Object.assign(Object.assign({},s),{channelUrl:this.url,channelType:this.channelType,reqId:o}));r.send(n).then((t=>{const{message:s}=t.as(J);i.dispatch(new e.MessageUpdateEventCommand({messages:[s],source:e.CollectionEventSource.EVENT_MESSAGE_SENT_SUCCESS})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._trigger(s)}))))})).catch((t=>{if(e.isThrowingOutside(t))throw t;e.sleep(2).then((()=>{const n=this._createPendingUserMessage(s,o,d),{cacheContext:a}=e.Vault.of(this._iid),r=a.localCacheEnabled&&e.isAutoResendableError(t.code);this._markMessageAsFailed(n,t,r),i.dispatch(new e.MessageUpdateEventCommand({messages:[n],source:n.sendingStatus===e.SendingStatus.PENDING?e.CollectionEventSource.REQUEST_RESEND_MESSAGE:e.CollectionEventSource.EVENT_MESSAGE_SENT_FAILED})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._triggerFailed(t,n)}))))}))}))})),l}_autoResendUserMessage(s){return e.unless(s instanceof t.UserMessage&&!!s.messageParams).throw(e.SendbirdError.invalidParameters),this._sendUserMessage(s.messageParams,s.reqId)}resendUserMessage(s){var n;return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.UserMessage&&!s.scheduledInfo).throw(e.SendbirdError.invalidParameters);const a=new e.Deferred,i=null!==(n=s.messageParams)&&void 0!==n?n:t.createUserMessageCreateParamsFromFailedUserMessage(s);return this._sendUserMessage(i,s.reqId,!0).onFailed((e=>a.reject(e))).onSucceeded((e=>a.resolve(e))),a.promise}))}updateUserMessage(s,n){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.UserMessageUpdateParamsDefault),n);e.unless(e.isTypeOf("number",s)&&t.validateUserMessageUpdateParams(a)).throw(e.SendbirdError.invalidParameters);const{requestQueue:i}=e.Vault.of(this._iid),r=new X(Object.assign({channelType:this.channelType,channelUrl:this.url,messageId:s},a)),o=yield i.send(r),{message:d}=o.as(Z);return d}))}copyUserMessage(s,n){var a,i,r;return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof Ue&&n instanceof t.UserMessage&&n.sendingStatus===e.SendingStatus.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(e.SendbirdError.invalidParameters),e.unless(!n.poll).throw(e.SendbirdError.notSupportedError);const o=new e.Deferred,d=null!==(a=n.messageParams)&&void 0!==a?a:e.undefineNullProps(Object.assign(Object.assign({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(r=n.mentionedUsers)||void 0===r?void 0:r.map((e=>e.userId)),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:e.PushNotificationDeliveryOption.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}));return s._sendUserMessage(d).onSucceeded((e=>{o.resolve(e)})).onFailed((e=>o.reject(e))),o.promise}))}translateUserMessage(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.UserMessage&&s.messageId>0&&e.isArrayOf("string",n)).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new de({channelType:this.channelType,channelUrl:this.url,messageId:s.messageId,translationTargetLanguages:n}),r=yield a.send(i),{message:o}=r.as(le);return o}))}_createScheduledUserMessage(t,s){const{requestQueue:n}=e.Vault.of(this._iid),a=Date.now(),i=this._generateRequestId();e.sleep(2).then((()=>{const n=this._createPendingScheduledUserMessage(t,i,a);e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return s._trigger(n)}))))}));const r=new ue(Object.assign({reqId:i,channelType:this.channelType,channelUrl:this.url},t));n.send(r).then((t=>{const{message:n}=t.as(ce);e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return s._trigger(n)}))))})).catch((n=>{if(e.isThrowingOutside(n))throw n;e.sleep(2).then((()=>{const r=this._createPendingScheduledUserMessage(t,i,a);this._markMessageAsFailed(r,n),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return s._trigger(r)}))))}))}))}sendFileMessage(s){const n=Object.assign(Object.assign({},t.FileMessageCreateParamsDefault),s);return e.unless(t.validateFileMessageCreateParams(n)).throw(e.SendbirdError.invalidParameters),this._sendFileMessage(n)}sendMultipleFilesMessage(s){var n;const a=Object.assign(Object.assign({},t.MultipleFilesMessageCreateParamsDefault),s),i=e.Vault.of(this._iid);e.unless(t.validateMultipleFilesMessageCreateParams(a,null===(n=i.appInfo)||void 0===n?void 0:n.multipleFilesMessageFileCountLimit)).throw(e.SendbirdError.invalidParameters);const r=!!s.fileInfoList.find((e=>{const t=i.appInfo.uploadSizeLimit;return e.file instanceof Blob&&e.file.size>t||e.fileSize>t}));return e.unless(!r).throw(e.SendbirdError.fileSizeLimitExceededError),this._sendMultipleFilesMessage(a)}_sendFileMessage(s,n,a=!1){const{dispatcher:i}=e.Vault.of(this._iid),{fileMessageQueue:r}=t.MessageManager.of(this._iid);let o=null!=n?n:this._generateRequestId();const d=Date.now(),l=new t.MessageRequestHandler;return o||(o=this._generateRequestId()),e.sleep(2).then((()=>{const t=this._createPendingFileMessage(s,o,d);i.dispatch(new e.MessageUpdateEventCommand({messages:[t],source:a?e.CollectionEventSource.LOCAL_MESSAGE_RESEND_STARTED:e.CollectionEventSource.EVENT_MESSAGE_SENT_PENDING})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._trigger(t)})))),r.request(this,o,s).then((t=>{i.dispatch(new e.MessageUpdateEventCommand({messages:[t],source:e.CollectionEventSource.EVENT_MESSAGE_SENT_SUCCESS})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._trigger(t)}))))})).catch((t=>{if(e.isThrowingOutside(t))throw t;e.sleep(2).then((()=>{const n=this._createPendingFileMessage(s,o,d),{cacheContext:a}=e.Vault.of(this._iid),r=a.localCacheEnabled&&e.isAutoResendableError(t.code);this._markMessageAsFailed(n,t,r),i.dispatch(new e.MessageUpdateEventCommand({messages:[n],source:n.sendingStatus===e.SendingStatus.PENDING?e.CollectionEventSource.REQUEST_RESEND_MESSAGE:t.code===e.SendbirdErrorCode.FILE_UPLOAD_CANCEL_FAILED?e.CollectionEventSource.LOCAL_MESSAGE_CANCELED:e.CollectionEventSource.EVENT_MESSAGE_SENT_FAILED})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return l._triggerFailed(t,n)}))))}))}))})),l}_autoResendFileMessage(s){e.unless(s instanceof t.FileMessage&&!!s.messageParams).throw(e.SendbirdError.invalidParameters);const{logger:n}=e.Vault.of(this._iid);return n.debug("autoResendFileMessage pending",s),this._sendFileMessage(s.messageParams,s.reqId).onFailed((e=>{n.debug("autoResendFileMessage failed",e)})).onSucceeded((e=>{n.debug("autoResendFileMessage success",e)}))}_sendMultipleFilesMessage(s,n){const{dispatcher:a}=e.Vault.of(this._iid),{fileMessageQueue:i}=t.MessageManager.of(this._iid);let r=null!=n?n:this._generateRequestId();const o=Date.now(),d=new t.MultipleFilesMessageRequestHandler;return r||(r=this._generateRequestId()),e.sleep(2).then((()=>{const t=this._createPendingMultipleFilesMessage(s,r,o);a.dispatch(new e.MessageUpdateEventCommand({messages:[t],source:e.CollectionEventSource.EVENT_MESSAGE_SENT_PENDING})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return d._trigger(t)})))),i.request(this,r,s,d).then((t=>{a.dispatch(new e.MessageUpdateEventCommand({messages:[t],source:e.CollectionEventSource.EVENT_MESSAGE_SENT_SUCCESS})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return d._trigger(t)}))))})).catch((t=>{if(e.isThrowingOutside(t))throw t;e.sleep(2).then((()=>{const n=this._createPendingMultipleFilesMessage(s,r,o);this._markMessageAsFailed(n,t),a.dispatch(new e.MessageUpdateEventCommand({messages:[n],source:e.CollectionEventSource.EVENT_MESSAGE_SENT_FAILED})),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return d._triggerFailed(t,n)}))))}))}))})),d}_createScheduledFileMessage(t,s,n,a){const{requestQueue:i}=e.Vault.of(this._iid),r=new he(Object.assign(Object.assign({reqId:n,channelType:this.channelType,channelUrl:this.url},t),{fileUrl:t.fileUrl,requireAuth:t.requireAuth}));i.send(r).then((t=>{const{message:n}=t.as(pe);e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return s._trigger(n)}))))})).catch((i=>{if(e.isThrowingOutside(i))throw i;e.sleep(2).then((()=>{const r=this._createPendingScheduledFileMessage(t,n,a);this._markMessageAsFailed(r,i),e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return s._triggerFailed(i,r)}))))}))}))}sendFileMessages(s){e.unless(s.every((e=>t.validateFileMessageCreateParams(Object.assign(Object.assign({},t.FileMessageCreateParamsDefault),e))))).throw(e.SendbirdError.invalidParameters);const n=new t.MessageRequestHandler;for(const e of s)this.sendFileMessage(e).onPending((e=>n._trigger(e))).onFailed(((e,t)=>n._triggerFailed(e,t))).onSucceeded((e=>n._trigger(e)));return n}resendFileMessage(s,n){var a;return e.__awaiter(this,void 0,void 0,(function*(){const i=Boolean(s.url)||e.isFile(n)||e.isFile(null===(a=s.messageParams)||void 0===a?void 0:a.file);e.unless(s instanceof t.FileMessage&&i&&!s.scheduledInfo).throw(e.SendbirdError.invalidParameters);const r=new e.Deferred,o=t.createFileMessageCreateParamsFromFailedFileMessage(s,n);return this._sendFileMessage(o,s.reqId,!0).onFailed((e=>r.reject(e))).onSucceeded((e=>r.resolve(e))),r.promise}))}updateFileMessage(s,n){return e.__awaiter(this,void 0,void 0,(function*(){const a=Object.assign(Object.assign({},t.FileMessageUpdateParamsDefault),n);e.unless(e.isTypeOf("number",s)&&t.validateFileMessageUpdateParams(a)).throw(e.SendbirdError.invalidParameters);const{requestQueue:i}=e.Vault.of(this._iid),r=new ee(Object.assign({channelType:this.channelType,channelUrl:this.url,messageId:s},a)),o=yield i.send(r),{message:d}=o.as(te);return d}))}cancelUploadingFileMessage(s){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",s)).throw(e.SendbirdError.invalidParameters);const{fileMessageQueue:n}=t.MessageManager.of(this._iid);return n.cancel(this,s),!0}))}copyFileMessage(s,n){var a,i,r;return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof Ue&&n instanceof t.FileMessage&&n.sendingStatus===e.SendingStatus.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(e.SendbirdError.invalidParameters);const o=new e.Deferred,d=e.undefineNullProps(Object.assign(Object.assign({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(a=n.mentionedUserIds)&&void 0!==a?a:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map((e=>e.userId)),pushNotificationDeliveryOption:e.PushNotificationDeliveryOption.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(r=n.thumbnails)||void 0===r?void 0:r.map((e=>({maxWidth:e.width,maxHeight:e.height}))),requireAuth:n.requireAuth,isPinnedMessage:!1}));return s._sendFileMessage(d).onSucceeded((e=>o.resolve(e))).onFailed((e=>o.reject(e))),o.promise}))}deleteMessage(s){return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(s instanceof t.BaseMessage).throw(e.SendbirdError.invalidParameters),s.messageId>0){const{requestQueue:t}=e.Vault.of(this._iid),n=new se({channelType:this.channelType,channelUrl:this.url,messageId:s.messageId});yield t.send(n)}}))}addReaction(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.BaseMessage&&s.messageId>0&&e.isTypeOf("string",n)).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new ae({channelType:this.channelType,channelUrl:this.url,messageId:s.messageId,reactionKey:n}),r=yield a.send(i),{reactionEvent:o}=r.as(ie);return o}))}deleteReaction(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.BaseMessage&&s.messageId>0&&e.isTypeOf("string",n)).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new re({channelType:this.channelType,channelUrl:this.url,messageId:s.messageId,reactionKey:n}),r=yield a.send(i),{reactionEvent:o}=r.as(oe);return o}))}_updateUserMessageMetaArray(t,s,n,a){return e.__awaiter(this,void 0,void 0,(function*(){const{dispatcher:i,requestQueue:r}=e.Vault.of(this._iid),o=new X({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:{array:s,mode:n,upsert:a}}),d=yield r.send(o),{message:l}=d.as(Z);return i.dispatch(new e.MessageUpdateEventCommand({messages:[l],source:e.CollectionEventSource.EVENT_MESSAGE_UPDATED})),l}))}_updateFileMessageMetaArray(t,s,n,a){return e.__awaiter(this,void 0,void 0,(function*(){const{dispatcher:i,requestQueue:r}=e.Vault.of(this._iid),o=new ee({channelType:this.channelType,channelUrl:this.url,messageId:t,metaArrayParams:{array:s,mode:n,upsert:a}}),d=yield r.send(o),{message:l}=d.as(te);return i.dispatch(new e.MessageUpdateEventCommand({messages:[l],source:e.CollectionEventSource.EVENT_MESSAGE_UPDATED})),l}))}createMessageMetaArrayKeys(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.BaseMessage&&s.messageId>0&&e.isArrayOf("string",n)).throw(e.SendbirdError.invalidParameters);const a=n.map((e=>new t.MessageMetaArray({key:e})));return s instanceof t.FileMessage?this._updateFileMessageMetaArray(s.messageId,a,"add",!0):this._updateUserMessageMetaArray(s.messageId,a,"add",!0)}))}deleteMessageMetaArrayKeys(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.BaseMessage&&s.messageId>0&&e.isArrayOf("string",n)).throw(e.SendbirdError.invalidParameters);const a=n.map((e=>new t.MessageMetaArray({key:e})));return s instanceof t.FileMessage?this._updateFileMessageMetaArray(s.messageId,a,"remove",!0):this._updateUserMessageMetaArray(s.messageId,a,"remove",!0)}))}addMessageMetaArrayValues(s,n){return e.__awaiter(this,void 0,void 0,(function*(){return e.unless(s instanceof t.BaseMessage&&s.messageId>0&&n.every((e=>e instanceof t.MessageMetaArray))).throw(e.SendbirdError.invalidParameters),s instanceof t.FileMessage?this._updateFileMessageMetaArray(s.messageId,n,"add",!0):this._updateUserMessageMetaArray(s.messageId,n,"add",!0)}))}removeMessageMetaArrayValues(s,n){return e.__awaiter(this,void 0,void 0,(function*(){return e.unless(s instanceof t.BaseMessage&&s.messageId>0&&n.every((e=>e instanceof t.MessageMetaArray))).throw(e.SendbirdError.invalidParameters),s instanceof t.FileMessage?this._updateFileMessageMetaArray(s.messageId,n,"remove",!0):this._updateUserMessageMetaArray(s.messageId,n,"remove",!0)}))}report(s,n){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isEnumOf(t.ReportCategory,s)&&e.isTypeOf("string",n)).throw(e.SendbirdError.invalidParameters);const{sdkState:a,requestQueue:i}=e.Vault.of(this._iid),r=new W({channelUrl:this.url,channelType:this.channelType,userId:a.userId,category:s,description:n});yield i.send(r)}))}reportUser(s,n,a){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof e.User&&e.isEnumOf(t.ReportCategory,n)&&e.isTypeOf("string",a)).throw(e.SendbirdError.invalidParameters);const{sdkState:i,requestQueue:r}=e.Vault.of(this._iid),o=new H({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:s.userId,category:n,description:a});yield r.send(o)}))}reportMessage(s,n,a){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(s instanceof t.SendableMessage&&e.isEnumOf(t.ReportCategory,n)&&e.isTypeOf("string",a)).throw(e.SendbirdError.invalidParameters);const{sdkState:i,requestQueue:r}=e.Vault.of(this._iid),o=new Y({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:s.sender.userId,messageId:s.messageId,category:n,description:a});yield r.send(o)}))}updatePoll(t,s){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("number",t)&&(t=>e.isTypeOf("string",t.title,!0)&&e.validatePollData(t.data)&&e.isTypeOf("boolean",t.allowUserSuggestion,!0)&&e.isTypeOf("boolean",t.allowMultipleVotes,!0)&&e.isTypeOf("number",t.closeAt,!0))(s)).throw(e.SendbirdError.invalidParameters);const{requestQueue:n}=e.Vault.of(this._iid),a=new me(Object.assign({pollId:t},s)),i=yield n.send(a),{poll:r}=i.as(ge);return r}))}deletePoll(t){return e.__awaiter(this,void 0,void 0,(function*(){const s=e.isTypeOf("number",t);e.unless(s).throw(e.SendbirdError.invalidParameters);const{requestQueue:n}=e.Vault.of(this._iid),a=new _e({pollId:t});yield n.send(a)}))}closePoll(t){return e.__awaiter(this,void 0,void 0,(function*(){const s=e.isTypeOf("number",t);e.unless(s).throw(e.SendbirdError.invalidParameters);const{requestQueue:n}=e.Vault.of(this._iid),a=new ye({pollId:t}),i=yield n.send(a),{poll:r}=i.as(ve);return r}))}addPollOption(t,s){return e.__awaiter(this,void 0,void 0,(function*(){const n=e.isTypeOf("number",t)&&e.isTypeOf("string",s)&&""!==s.trim();e.unless(n).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new fe({channelUrl:this.url,channelType:this.channelType,pollId:t,optionText:s}),r=yield a.send(i),{poll:o}=r.as(Me);return o}))}updatePollOption(t,s,n){return e.__awaiter(this,void 0,void 0,(function*(){const a=e.isTypeOf("number",t)&&e.isTypeOf("number",s)&&e.isTypeOf("string",n)&&""!==n.trim();e.unless(a).throw(e.SendbirdError.invalidParameters);const{requestQueue:i}=e.Vault.of(this._iid),r=new Te({pollId:t,pollOptionId:s,optionText:n}),o=yield i.send(r),{poll:d}=o.as(Ie);return d}))}deletePollOption(t,s){return e.__awaiter(this,void 0,void 0,(function*(){const n=e.isTypeOf("number",t)&&e.isTypeOf("number",s);e.unless(n).throw(e.SendbirdError.invalidParameters);const{requestQueue:a}=e.Vault.of(this._iid),i=new Pe({pollId:t,pollOptionId:s});yield a.send(i)}))}votePoll(t,s){return e.__awaiter(this,void 0,void 0,(function*(){const n=e.isTypeOf("number",t)&&e.isArrayOf("number",s);e.unless(n).throw(e.SendbirdError.invalidParameters);const{requestQueue:a,dispatcher:i}=e.Vault.of(this._iid),r=new Ce({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:t,pollOptionIds:s}),o=yield a.send(r),{event:d}=o.as(Ee);return i.dispatch(new e.PollVoteInternalEventCommand({event:d,source:e.CollectionEventSource.EVENT_POLL_VOTED})),d}))}getPollChangeLogsSinceTimestamp(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("number",t)).throw(e.SendbirdError.invalidParameters);const n=s.PollManager.of(this._iid);return yield n.getPollChangeLogs(this.url,this.channelType,t)}))}getPollChangeLogsSinceToken(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t,!0));const n=s.PollManager.of(this._iid);return yield n.getPollChangeLogs(this.url,this.channelType,t)}))}createPollListQuery(e=t.DEFAULT_POLLS_LIMIT){return new s.PollListQuery(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})}createPollVoterListQuery(e,n,a=t.DEFAULT_POLL_VOTER_LIST_LIMIT){return new s.PollVoterListQuery(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:n,limit:a})}}exports.BanUserEventCommand=j,exports.BannedUserListQuery=h,exports.BaseChannel=Ue,exports.CreateScheduledUserMessageResponseCommand=ce,exports.DeleteMessageEventCommand=ne,exports.FreezeEventCommand=z,exports.MuteUserEventCommand=k,exports.MutedUserListQuery=l,exports.OperatorListQuery=r,exports.PENDING_MESSAGE_DELAY=2,exports.PollVoteEventCommand=Ee,exports.RestrictedUser=n,exports.UnbanUserEventCommand=B,exports.UnmuteUserEventCommand=$,exports.UpdateFileMessageEventCommand=te,exports.UpdateMetaCounterEventCommand=D,exports.UpdateMetaDataEventCommand=P,exports.UpdateUserMessageEventCommand=Z,exports.UserMessageEventCommand=J;
